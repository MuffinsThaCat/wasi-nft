/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var t,e,r={56:(t,e,r)=>{"use strict";t.exports=function(t){var e=r.nc;e&&t.setAttribute("nonce",e)}},72:t=>{"use strict";var e=[];function r(t){for(var r=-1,n=0;n<e.length;n++)if(e[n].identifier===t){r=n;break}return r}function n(t,n){for(var i={},o=[],a=0;a<t.length;a++){var c=t[a],l=n.base?c[0]+n.base:c[0],u=i[l]||0,h="".concat(l," ").concat(u);i[l]=u+1;var f=r(h),d={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==f)e[f].references++,e[f].updater(d);else{var p=s(d,n);n.byIndex=a,e.splice(a,0,{identifier:h,updater:p,references:1})}o.push(h)}return o}function s(t,e){var r=e.domAPI(e);return r.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;r.update(t=e)}else r.remove()}}t.exports=function(t,s){var i=n(t=t||[],s=s||{});return function(t){t=t||[];for(var o=0;o<i.length;o++){var a=r(i[o]);e[a].references--}for(var c=n(t,s),l=0;l<i.length;l++){var u=r(i[l]);0===e[u].references&&(e[u].updater(),e.splice(u,1))}i=c}}},113:t=>{"use strict";t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},122:()=>{},251:(t,e)=>{e.read=function(t,e,r,n,s){var i,o,a=8*s-n-1,c=(1<<a)-1,l=c>>1,u=-7,h=r?s-1:0,f=r?-1:1,d=t[e+h];for(h+=f,i=d&(1<<-u)-1,d>>=-u,u+=a;u>0;i=256*i+t[e+h],h+=f,u-=8);for(o=i&(1<<-u)-1,i>>=-u,u+=n;u>0;o=256*o+t[e+h],h+=f,u-=8);if(0===i)i=1-l;else{if(i===c)return o?NaN:1/0*(d?-1:1);o+=Math.pow(2,n),i-=l}return(d?-1:1)*o*Math.pow(2,i-n)},e.write=function(t,e,r,n,s,i){var o,a,c,l=8*i-s-1,u=(1<<l)-1,h=u>>1,f=23===s?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:i-1,p=n?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=u):(o=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-o))<1&&(o--,c*=2),(e+=o+h>=1?f/c:f*Math.pow(2,1-h))*c>=2&&(o++,c/=2),o+h>=u?(a=0,o=u):o+h>=1?(a=(e*c-1)*Math.pow(2,s),o+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,s),o=0));s>=8;t[r+d]=255&a,d+=p,a/=256,s-=8);for(o=o<<s|a,l+=s;l>0;t[r+d]=255&o,d+=p,o/=256,l-=8);t[r+d-p]|=128*g}},287:(t,e,r)=>{"use strict";const n=r(526),s=r(251),i="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;e.hp=c,e.IS=50;const o=2147483647;function a(t){if(t>o)throw new RangeError('The value "'+t+'" is invalid for option "size"');const e=new Uint8Array(t);return Object.setPrototypeOf(e,c.prototype),e}function c(t,e,r){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return h(t)}return l(t,e,r)}function l(t,e,r){if("string"==typeof t)return function(t,e){if("string"==typeof e&&""!==e||(e="utf8"),!c.isEncoding(e))throw new TypeError("Unknown encoding: "+e);const r=0|g(t,e);let n=a(r);const s=n.write(t,e);return s!==r&&(n=n.slice(0,s)),n}(t,e);if(ArrayBuffer.isView(t))return function(t){if(W(t,Uint8Array)){const e=new Uint8Array(t);return d(e.buffer,e.byteOffset,e.byteLength)}return f(t)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(W(t,ArrayBuffer)||t&&W(t.buffer,ArrayBuffer))return d(t,e,r);if("undefined"!=typeof SharedArrayBuffer&&(W(t,SharedArrayBuffer)||t&&W(t.buffer,SharedArrayBuffer)))return d(t,e,r);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');const n=t.valueOf&&t.valueOf();if(null!=n&&n!==t)return c.from(n,e,r);const s=function(t){if(c.isBuffer(t)){const e=0|p(t.length),r=a(e);return 0===r.length||t.copy(r,0,0,e),r}return void 0!==t.length?"number"!=typeof t.length||Z(t.length)?a(0):f(t):"Buffer"===t.type&&Array.isArray(t.data)?f(t.data):void 0}(t);if(s)return s;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return c.from(t[Symbol.toPrimitive]("string"),e,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function u(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function h(t){return u(t),a(t<0?0:0|p(t))}function f(t){const e=t.length<0?0:0|p(t.length),r=a(e);for(let n=0;n<e;n+=1)r[n]=255&t[n];return r}function d(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return n=void 0===e&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,e):new Uint8Array(t,e,r),Object.setPrototypeOf(n,c.prototype),n}function p(t){if(t>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return 0|t}function g(t,e){if(c.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||W(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);const r=t.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;let s=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return J(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return _(t).length;default:if(s)return n?-1:J(t).length;e=(""+e).toLowerCase(),s=!0}}function y(t,e,r){let n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return R(this,e,r);case"utf8":case"utf-8":return I(this,e,r);case"ascii":return N(this,e,r);case"latin1":case"binary":return C(this,e,r);case"base64":return B(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function m(t,e,r){const n=t[e];t[e]=t[r],t[r]=n}function w(t,e,r,n,s){if(0===t.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),Z(r=+r)&&(r=s?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(s)return-1;r=t.length-1}else if(r<0){if(!s)return-1;r=0}if("string"==typeof e&&(e=c.from(e,n)),c.isBuffer(e))return 0===e.length?-1:b(t,e,r,n,s);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?s?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):b(t,[e],r,n,s);throw new TypeError("val must be string, number or Buffer")}function b(t,e,r,n,s){let i,o=1,a=t.length,c=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;o=2,a/=2,c/=2,r/=2}function l(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(s){let n=-1;for(i=r;i<a;i++)if(l(t,i)===l(e,-1===n?0:i-n)){if(-1===n&&(n=i),i-n+1===c)return n*o}else-1!==n&&(i-=i-n),n=-1}else for(r+c>a&&(r=a-c),i=r;i>=0;i--){let r=!0;for(let n=0;n<c;n++)if(l(t,i+n)!==l(e,n)){r=!1;break}if(r)return i}return-1}function A(t,e,r,n){r=Number(r)||0;const s=t.length-r;n?(n=Number(n))>s&&(n=s):n=s;const i=e.length;let o;for(n>i/2&&(n=i/2),o=0;o<n;++o){const n=parseInt(e.substr(2*o,2),16);if(Z(n))return o;t[r+o]=n}return o}function E(t,e,r,n){return q(J(e,t.length-r),t,r,n)}function v(t,e,r,n){return q(function(t){const e=[];for(let r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}(e),t,r,n)}function k(t,e,r,n){return q(_(e),t,r,n)}function x(t,e,r,n){return q(function(t,e){let r,n,s;const i=[];for(let o=0;o<t.length&&!((e-=2)<0);++o)r=t.charCodeAt(o),n=r>>8,s=r%256,i.push(s),i.push(n);return i}(e,t.length-r),t,r,n)}function B(t,e,r){return 0===e&&r===t.length?n.fromByteArray(t):n.fromByteArray(t.slice(e,r))}function I(t,e,r){r=Math.min(t.length,r);const n=[];let s=e;for(;s<r;){const e=t[s];let i=null,o=e>239?4:e>223?3:e>191?2:1;if(s+o<=r){let r,n,a,c;switch(o){case 1:e<128&&(i=e);break;case 2:r=t[s+1],128==(192&r)&&(c=(31&e)<<6|63&r,c>127&&(i=c));break;case 3:r=t[s+1],n=t[s+2],128==(192&r)&&128==(192&n)&&(c=(15&e)<<12|(63&r)<<6|63&n,c>2047&&(c<55296||c>57343)&&(i=c));break;case 4:r=t[s+1],n=t[s+2],a=t[s+3],128==(192&r)&&128==(192&n)&&128==(192&a)&&(c=(15&e)<<18|(63&r)<<12|(63&n)<<6|63&a,c>65535&&c<1114112&&(i=c))}}null===i?(i=65533,o=1):i>65535&&(i-=65536,n.push(i>>>10&1023|55296),i=56320|1023&i),n.push(i),s+=o}return function(t){const e=t.length;if(e<=P)return String.fromCharCode.apply(String,t);let r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=P));return r}(n)}c.TYPED_ARRAY_SUPPORT=function(){try{const t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),c.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(c.prototype,"parent",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.buffer}}),Object.defineProperty(c.prototype,"offset",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.byteOffset}}),c.poolSize=8192,c.from=function(t,e,r){return l(t,e,r)},Object.setPrototypeOf(c.prototype,Uint8Array.prototype),Object.setPrototypeOf(c,Uint8Array),c.alloc=function(t,e,r){return function(t,e,r){return u(t),t<=0?a(t):void 0!==e?"string"==typeof r?a(t).fill(e,r):a(t).fill(e):a(t)}(t,e,r)},c.allocUnsafe=function(t){return h(t)},c.allocUnsafeSlow=function(t){return h(t)},c.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==c.prototype},c.compare=function(t,e){if(W(t,Uint8Array)&&(t=c.from(t,t.offset,t.byteLength)),W(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),!c.isBuffer(t)||!c.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;let r=t.length,n=e.length;for(let s=0,i=Math.min(r,n);s<i;++s)if(t[s]!==e[s]){r=t[s],n=e[s];break}return r<n?-1:n<r?1:0},c.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return c.alloc(0);let r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;const n=c.allocUnsafe(e);let s=0;for(r=0;r<t.length;++r){let e=t[r];if(W(e,Uint8Array))s+e.length>n.length?(c.isBuffer(e)||(e=c.from(e)),e.copy(n,s)):Uint8Array.prototype.set.call(n,e,s);else{if(!c.isBuffer(e))throw new TypeError('"list" argument must be an Array of Buffers');e.copy(n,s)}s+=e.length}return n},c.byteLength=g,c.prototype._isBuffer=!0,c.prototype.swap16=function(){const t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let e=0;e<t;e+=2)m(this,e,e+1);return this},c.prototype.swap32=function(){const t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let e=0;e<t;e+=4)m(this,e,e+3),m(this,e+1,e+2);return this},c.prototype.swap64=function(){const t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let e=0;e<t;e+=8)m(this,e,e+7),m(this,e+1,e+6),m(this,e+2,e+5),m(this,e+3,e+4);return this},c.prototype.toString=function(){const t=this.length;return 0===t?"":0===arguments.length?I(this,0,t):y.apply(this,arguments)},c.prototype.toLocaleString=c.prototype.toString,c.prototype.equals=function(t){if(!c.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===c.compare(this,t)},c.prototype.inspect=function(){let t="";const r=e.IS;return t=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(t+=" ... "),"<Buffer "+t+">"},i&&(c.prototype[i]=c.prototype.inspect),c.prototype.compare=function(t,e,r,n,s){if(W(t,Uint8Array)&&(t=c.from(t,t.offset,t.byteLength)),!c.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===s&&(s=this.length),e<0||r>t.length||n<0||s>this.length)throw new RangeError("out of range index");if(n>=s&&e>=r)return 0;if(n>=s)return-1;if(e>=r)return 1;if(this===t)return 0;let i=(s>>>=0)-(n>>>=0),o=(r>>>=0)-(e>>>=0);const a=Math.min(i,o),l=this.slice(n,s),u=t.slice(e,r);for(let t=0;t<a;++t)if(l[t]!==u[t]){i=l[t],o=u[t];break}return i<o?-1:o<i?1:0},c.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},c.prototype.indexOf=function(t,e,r){return w(this,t,e,r,!0)},c.prototype.lastIndexOf=function(t,e,r){return w(this,t,e,r,!1)},c.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}const s=this.length-e;if((void 0===r||r>s)&&(r=s),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let i=!1;for(;;)switch(n){case"hex":return A(this,t,e,r);case"utf8":case"utf-8":return E(this,t,e,r);case"ascii":case"latin1":case"binary":return v(this,t,e,r);case"base64":return k(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,t,e,r);default:if(i)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),i=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const P=4096;function N(t,e,r){let n="";r=Math.min(t.length,r);for(let s=e;s<r;++s)n+=String.fromCharCode(127&t[s]);return n}function C(t,e,r){let n="";r=Math.min(t.length,r);for(let s=e;s<r;++s)n+=String.fromCharCode(t[s]);return n}function R(t,e,r){const n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);let s="";for(let n=e;n<r;++n)s+=$[t[n]];return s}function O(t,e,r){const n=t.slice(e,r);let s="";for(let t=0;t<n.length-1;t+=2)s+=String.fromCharCode(n[t]+256*n[t+1]);return s}function S(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function T(t,e,r,n,s,i){if(!c.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>s||e<i)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}function U(t,e,r,n,s){j(e,n,s,t,r,7);let i=Number(e&BigInt(4294967295));t[r++]=i,i>>=8,t[r++]=i,i>>=8,t[r++]=i,i>>=8,t[r++]=i;let o=Number(e>>BigInt(32)&BigInt(4294967295));return t[r++]=o,o>>=8,t[r++]=o,o>>=8,t[r++]=o,o>>=8,t[r++]=o,r}function F(t,e,r,n,s){j(e,n,s,t,r,7);let i=Number(e&BigInt(4294967295));t[r+7]=i,i>>=8,t[r+6]=i,i>>=8,t[r+5]=i,i>>=8,t[r+4]=i;let o=Number(e>>BigInt(32)&BigInt(4294967295));return t[r+3]=o,o>>=8,t[r+2]=o,o>>=8,t[r+1]=o,o>>=8,t[r]=o,r+8}function D(t,e,r,n,s,i){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function L(t,e,r,n,i){return e=+e,r>>>=0,i||D(t,0,r,4),s.write(t,e,r,n,23,4),r+4}function M(t,e,r,n,i){return e=+e,r>>>=0,i||D(t,0,r,8),s.write(t,e,r,n,52,8),r+8}c.prototype.slice=function(t,e){const r=this.length;(t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t);const n=this.subarray(t,e);return Object.setPrototypeOf(n,c.prototype),n},c.prototype.readUintLE=c.prototype.readUIntLE=function(t,e,r){t>>>=0,e>>>=0,r||S(t,e,this.length);let n=this[t],s=1,i=0;for(;++i<e&&(s*=256);)n+=this[t+i]*s;return n},c.prototype.readUintBE=c.prototype.readUIntBE=function(t,e,r){t>>>=0,e>>>=0,r||S(t,e,this.length);let n=this[t+--e],s=1;for(;e>0&&(s*=256);)n+=this[t+--e]*s;return n},c.prototype.readUint8=c.prototype.readUInt8=function(t,e){return t>>>=0,e||S(t,1,this.length),this[t]},c.prototype.readUint16LE=c.prototype.readUInt16LE=function(t,e){return t>>>=0,e||S(t,2,this.length),this[t]|this[t+1]<<8},c.prototype.readUint16BE=c.prototype.readUInt16BE=function(t,e){return t>>>=0,e||S(t,2,this.length),this[t]<<8|this[t+1]},c.prototype.readUint32LE=c.prototype.readUInt32LE=function(t,e){return t>>>=0,e||S(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},c.prototype.readUint32BE=c.prototype.readUInt32BE=function(t,e){return t>>>=0,e||S(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},c.prototype.readBigUInt64LE=Y((function(t){z(t>>>=0,"offset");const e=this[t],r=this[t+7];void 0!==e&&void 0!==r||V(t,this.length-8);const n=e+256*this[++t]+65536*this[++t]+this[++t]*2**24,s=this[++t]+256*this[++t]+65536*this[++t]+r*2**24;return BigInt(n)+(BigInt(s)<<BigInt(32))})),c.prototype.readBigUInt64BE=Y((function(t){z(t>>>=0,"offset");const e=this[t],r=this[t+7];void 0!==e&&void 0!==r||V(t,this.length-8);const n=e*2**24+65536*this[++t]+256*this[++t]+this[++t],s=this[++t]*2**24+65536*this[++t]+256*this[++t]+r;return(BigInt(n)<<BigInt(32))+BigInt(s)})),c.prototype.readIntLE=function(t,e,r){t>>>=0,e>>>=0,r||S(t,e,this.length);let n=this[t],s=1,i=0;for(;++i<e&&(s*=256);)n+=this[t+i]*s;return s*=128,n>=s&&(n-=Math.pow(2,8*e)),n},c.prototype.readIntBE=function(t,e,r){t>>>=0,e>>>=0,r||S(t,e,this.length);let n=e,s=1,i=this[t+--n];for(;n>0&&(s*=256);)i+=this[t+--n]*s;return s*=128,i>=s&&(i-=Math.pow(2,8*e)),i},c.prototype.readInt8=function(t,e){return t>>>=0,e||S(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},c.prototype.readInt16LE=function(t,e){t>>>=0,e||S(t,2,this.length);const r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt16BE=function(t,e){t>>>=0,e||S(t,2,this.length);const r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt32LE=function(t,e){return t>>>=0,e||S(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},c.prototype.readInt32BE=function(t,e){return t>>>=0,e||S(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},c.prototype.readBigInt64LE=Y((function(t){z(t>>>=0,"offset");const e=this[t],r=this[t+7];void 0!==e&&void 0!==r||V(t,this.length-8);const n=this[t+4]+256*this[t+5]+65536*this[t+6]+(r<<24);return(BigInt(n)<<BigInt(32))+BigInt(e+256*this[++t]+65536*this[++t]+this[++t]*2**24)})),c.prototype.readBigInt64BE=Y((function(t){z(t>>>=0,"offset");const e=this[t],r=this[t+7];void 0!==e&&void 0!==r||V(t,this.length-8);const n=(e<<24)+65536*this[++t]+256*this[++t]+this[++t];return(BigInt(n)<<BigInt(32))+BigInt(this[++t]*2**24+65536*this[++t]+256*this[++t]+r)})),c.prototype.readFloatLE=function(t,e){return t>>>=0,e||S(t,4,this.length),s.read(this,t,!0,23,4)},c.prototype.readFloatBE=function(t,e){return t>>>=0,e||S(t,4,this.length),s.read(this,t,!1,23,4)},c.prototype.readDoubleLE=function(t,e){return t>>>=0,e||S(t,8,this.length),s.read(this,t,!0,52,8)},c.prototype.readDoubleBE=function(t,e){return t>>>=0,e||S(t,8,this.length),s.read(this,t,!1,52,8)},c.prototype.writeUintLE=c.prototype.writeUIntLE=function(t,e,r,n){t=+t,e>>>=0,r>>>=0,n||T(this,t,e,r,Math.pow(2,8*r)-1,0);let s=1,i=0;for(this[e]=255&t;++i<r&&(s*=256);)this[e+i]=t/s&255;return e+r},c.prototype.writeUintBE=c.prototype.writeUIntBE=function(t,e,r,n){t=+t,e>>>=0,r>>>=0,n||T(this,t,e,r,Math.pow(2,8*r)-1,0);let s=r-1,i=1;for(this[e+s]=255&t;--s>=0&&(i*=256);)this[e+s]=t/i&255;return e+r},c.prototype.writeUint8=c.prototype.writeUInt8=function(t,e,r){return t=+t,e>>>=0,r||T(this,t,e,1,255,0),this[e]=255&t,e+1},c.prototype.writeUint16LE=c.prototype.writeUInt16LE=function(t,e,r){return t=+t,e>>>=0,r||T(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},c.prototype.writeUint16BE=c.prototype.writeUInt16BE=function(t,e,r){return t=+t,e>>>=0,r||T(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},c.prototype.writeUint32LE=c.prototype.writeUInt32LE=function(t,e,r){return t=+t,e>>>=0,r||T(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},c.prototype.writeUint32BE=c.prototype.writeUInt32BE=function(t,e,r){return t=+t,e>>>=0,r||T(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},c.prototype.writeBigUInt64LE=Y((function(t,e=0){return U(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),c.prototype.writeBigUInt64BE=Y((function(t,e=0){return F(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),c.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e>>>=0,!n){const n=Math.pow(2,8*r-1);T(this,t,e,r,n-1,-n)}let s=0,i=1,o=0;for(this[e]=255&t;++s<r&&(i*=256);)t<0&&0===o&&0!==this[e+s-1]&&(o=1),this[e+s]=(t/i|0)-o&255;return e+r},c.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e>>>=0,!n){const n=Math.pow(2,8*r-1);T(this,t,e,r,n-1,-n)}let s=r-1,i=1,o=0;for(this[e+s]=255&t;--s>=0&&(i*=256);)t<0&&0===o&&0!==this[e+s+1]&&(o=1),this[e+s]=(t/i|0)-o&255;return e+r},c.prototype.writeInt8=function(t,e,r){return t=+t,e>>>=0,r||T(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},c.prototype.writeInt16LE=function(t,e,r){return t=+t,e>>>=0,r||T(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},c.prototype.writeInt16BE=function(t,e,r){return t=+t,e>>>=0,r||T(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},c.prototype.writeInt32LE=function(t,e,r){return t=+t,e>>>=0,r||T(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},c.prototype.writeInt32BE=function(t,e,r){return t=+t,e>>>=0,r||T(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},c.prototype.writeBigInt64LE=Y((function(t,e=0){return U(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),c.prototype.writeBigInt64BE=Y((function(t,e=0){return F(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),c.prototype.writeFloatLE=function(t,e,r){return L(this,t,e,!0,r)},c.prototype.writeFloatBE=function(t,e,r){return L(this,t,e,!1,r)},c.prototype.writeDoubleLE=function(t,e,r){return M(this,t,e,!0,r)},c.prototype.writeDoubleBE=function(t,e,r){return M(this,t,e,!1,r)},c.prototype.copy=function(t,e,r,n){if(!c.isBuffer(t))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);const s=n-r;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,r,n):Uint8Array.prototype.set.call(t,this.subarray(r,n),e),s},c.prototype.fill=function(t,e,r,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!c.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===t.length){const e=t.charCodeAt(0);("utf8"===n&&e<128||"latin1"===n)&&(t=e)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;let s;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(s=e;s<r;++s)this[s]=t;else{const i=c.isBuffer(t)?t:c.from(t,n),o=i.length;if(0===o)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(s=0;s<r-e;++s)this[s+e]=i[s%o]}return this};const G={};function H(t,e,r){G[t]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${t}]`,this.stack,delete this.name}get code(){return t}set code(t){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:t,writable:!0})}toString(){return`${this.name} [${t}]: ${this.message}`}}}function Q(t){let e="",r=t.length;const n="-"===t[0]?1:0;for(;r>=n+4;r-=3)e=`_${t.slice(r-3,r)}${e}`;return`${t.slice(0,r)}${e}`}function j(t,e,r,n,s,i){if(t>r||t<e){const n="bigint"==typeof e?"n":"";let s;throw s=i>3?0===e||e===BigInt(0)?`>= 0${n} and < 2${n} ** ${8*(i+1)}${n}`:`>= -(2${n} ** ${8*(i+1)-1}${n}) and < 2 ** ${8*(i+1)-1}${n}`:`>= ${e}${n} and <= ${r}${n}`,new G.ERR_OUT_OF_RANGE("value",s,t)}!function(t,e,r){z(e,"offset"),void 0!==t[e]&&void 0!==t[e+r]||V(e,t.length-(r+1))}(n,s,i)}function z(t,e){if("number"!=typeof t)throw new G.ERR_INVALID_ARG_TYPE(e,"number",t)}function V(t,e,r){if(Math.floor(t)!==t)throw z(t,r),new G.ERR_OUT_OF_RANGE(r||"offset","an integer",t);if(e<0)throw new G.ERR_BUFFER_OUT_OF_BOUNDS;throw new G.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${e}`,t)}H("ERR_BUFFER_OUT_OF_BOUNDS",(function(t){return t?`${t} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),H("ERR_INVALID_ARG_TYPE",(function(t,e){return`The "${t}" argument must be of type number. Received type ${typeof e}`}),TypeError),H("ERR_OUT_OF_RANGE",(function(t,e,r){let n=`The value of "${t}" is out of range.`,s=r;return Number.isInteger(r)&&Math.abs(r)>2**32?s=Q(String(r)):"bigint"==typeof r&&(s=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(s=Q(s)),s+="n"),n+=` It must be ${e}. Received ${s}`,n}),RangeError);const K=/[^+/0-9A-Za-z-_]/g;function J(t,e){let r;e=e||1/0;const n=t.length;let s=null;const i=[];for(let o=0;o<n;++o){if(r=t.charCodeAt(o),r>55295&&r<57344){if(!s){if(r>56319){(e-=3)>-1&&i.push(239,191,189);continue}if(o+1===n){(e-=3)>-1&&i.push(239,191,189);continue}s=r;continue}if(r<56320){(e-=3)>-1&&i.push(239,191,189),s=r;continue}r=65536+(s-55296<<10|r-56320)}else s&&(e-=3)>-1&&i.push(239,191,189);if(s=null,r<128){if((e-=1)<0)break;i.push(r)}else if(r<2048){if((e-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function _(t){return n.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(K,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function q(t,e,r,n){let s;for(s=0;s<n&&!(s+r>=e.length||s>=t.length);++s)e[s+r]=t[s];return s}function W(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function Z(t){return t!=t}const $=function(){const t="0123456789abcdef",e=new Array(256);for(let r=0;r<16;++r){const n=16*r;for(let s=0;s<16;++s)e[n+s]=t[r]+t[s]}return e}();function Y(t){return"undefined"==typeof BigInt?X:t}function X(){throw new Error("BigInt not supported")}},314:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var r="",n=void 0!==e[5];return e[4]&&(r+="@supports (".concat(e[4],") {")),e[2]&&(r+="@media ".concat(e[2]," {")),n&&(r+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),r+=t(e),n&&(r+="}"),e[2]&&(r+="}"),e[4]&&(r+="}"),r})).join("")},e.i=function(t,r,n,s,i){"string"==typeof t&&(t=[[null,t,void 0]]);var o={};if(n)for(var a=0;a<this.length;a++){var c=this[a][0];null!=c&&(o[c]=!0)}for(var l=0;l<t.length;l++){var u=[].concat(t[l]);n&&o[u[0]]||(void 0!==i&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=i),r&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=r):u[2]=r),s&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=s):u[4]="".concat(s)),e.push(u))}},e}},365:(t,e,r)=>{"use strict";r.d(e,{A:()=>a});var n=r(601),s=r.n(n),i=r(314),o=r.n(i)()(s());o.push([t.id,":root {\n  --primary-color: #3498db;\n  --secondary-color: #2ecc71;\n  --accent-color: #e74c3c;\n  --background-color: #f8f9fa;\n  --text-color: #333;\n  --border-color: #ddd;\n  --box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n}\n\n* {\n  box-sizing: border-box;\n  margin: 0;\n  padding: 0;\n}\n\nbody {\n  font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\n  line-height: 1.6;\n  color: var(--text-color);\n  background-color: var(--background-color);\n}\n\n#app {\n  max-width: 1200px;\n  margin: 0 auto;\n  padding: 2rem;\n}\n\nheader {\n  text-align: center;\n  margin-bottom: 3rem;\n  padding-bottom: 1.5rem;\n  border-bottom: 1px solid var(--border-color);\n}\n\nheader h1 {\n  font-size: 2.5rem;\n  margin-bottom: 0.5rem;\n  color: var(--primary-color);\n}\n\nsection {\n  margin-bottom: 2.5rem;\n  padding: 2rem;\n  background: white;\n  border-radius: 8px;\n  box-shadow: var(--box-shadow);\n}\n\nh2 {\n  margin-bottom: 1.5rem;\n  color: var(--primary-color);\n}\n\n.form-group {\n  margin-bottom: 1.5rem;\n}\n\nlabel {\n  display: block;\n  margin-bottom: 0.5rem;\n  font-weight: 500;\n}\n\ninput, textarea {\n  width: 100%;\n  padding: 0.75rem;\n  border: 1px solid var(--border-color);\n  border-radius: 4px;\n  font-family: inherit;\n  font-size: 1rem;\n}\n\ntextarea {\n  min-height: 100px;\n  resize: vertical;\n}\n\n.hint {\n  font-size: 0.85rem;\n  color: #666;\n  margin-top: 0.25rem;\n}\n\n.primary-btn, .secondary-btn, .text-btn {\n  cursor: pointer;\n  font-family: inherit;\n  font-size: 1rem;\n  padding: 0.75rem 1.5rem;\n  border-radius: 4px;\n  border: none;\n  font-weight: 500;\n  transition: all 0.2s ease;\n}\n\n.primary-btn {\n  background-color: var(--primary-color);\n  color: white;\n}\n\n.secondary-btn {\n  background-color: var(--secondary-color);\n  color: white;\n  margin-right: 0.5rem;\n}\n\n.text-btn {\n  background: none;\n  color: var(--primary-color);\n  padding: 0.5rem;\n  text-decoration: underline;\n}\n\n.primary-btn:hover, .secondary-btn:hover {\n  filter: brightness(1.1);\n}\n\n.text-btn:hover {\n  color: var(--accent-color);\n}\n\n.info-box {\n  background-color: #e3f2fd;\n  padding: 1rem;\n  border-radius: 4px;\n  margin-top: 1rem;\n  border-left: 4px solid var(--primary-color);\n}\n\n.gallery-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));\n  gap: 1.5rem;\n  margin-top: 1.5rem;\n}\n\n.asset-card {\n  border-radius: 8px;\n  overflow: hidden;\n  box-shadow: var(--box-shadow);\n  transition: transform 0.2s ease;\n  cursor: pointer;\n  background: white;\n}\n\n.asset-card:hover {\n  transform: translateY(-5px);\n}\n\n.asset-thumbnail {\n  width: 100%;\n  height: 180px;\n  object-fit: cover;\n  border-bottom: 1px solid var(--border-color);\n}\n\n.asset-info {\n  padding: 1rem;\n}\n\n.asset-title {\n  font-weight: 600;\n  margin-bottom: 0.5rem;\n}\n\n.asset-meta {\n  font-size: 0.85rem;\n  color: #666;\n}\n\n#asset-detail-container {\n  display: grid;\n  grid-template-columns: 1fr 1fr;\n  gap: 2rem;\n}\n\n.action-buttons {\n  margin-top: 2rem;\n  display: flex;\n  gap: 1rem;\n}\n\n.hidden {\n  display: none !important;\n}\n\n/* Loading overlay */\n#loading-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background-color: rgba(255, 255, 255, 0.9);\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  z-index: 1000;\n}\n\n.spinner {\n  border: 4px solid rgba(0, 0, 0, 0.1);\n  width: 36px;\n  height: 36px;\n  border-radius: 50%;\n  border-left-color: var(--primary-color);\n  animation: spin 1s linear infinite;\n  margin-bottom: 1rem;\n}\n\n@keyframes spin {\n  0% { transform: rotate(0deg); }\n  100% { transform: rotate(360deg); }\n}\n\nfooter {\n  text-align: center;\n  margin-top: 3rem;\n  padding-top: 1.5rem;\n  border-top: 1px solid var(--border-color);\n  color: #666;\n  font-size: 0.9rem;\n}\n",""]);const a=o},366:()=>{document.addEventListener("DOMContentLoaded",(()=>{console.log("Initializing crypto fix...");const t=t=>{const e=new Uint8Array(t);return crypto.getRandomValues(e),e},e=()=>{try{const e=t(32);return{publicKey:t(32),privateKey:e}}catch(t){throw console.error("Error generating key pair:",t),t}},r=(t,e)=>{try{const r={publicKey:btoa(String.fromCharCode.apply(null,e.publicKey)),privateKey:btoa(String.fromCharCode.apply(null,e.privateKey))};localStorage.setItem(`digital_assets_keypair_${t}`,JSON.stringify(r)),console.log("Stored key pair for user:",t)}catch(t){console.error("Error storing key pair:",t)}},n=t=>{try{const e=localStorage.getItem(`digital_assets_keypair_${t}`);if(!e)return null;const r=JSON.parse(e),n=t=>{const e=new Uint8Array(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e};return{publicKey:n(atob(r.publicKey)),privateKey:n(atob(r.privateKey))}}catch(t){return console.error("Error retrieving key pair:",t),null}};(()=>{const t=()=>{if(!window.assetManagerInstance)return!1;const t=window.assetManagerInstance.createAsset;return window.assetManagerInstance.createAsset=async function(...s){if(console.log("createAsset intercepted, initializing keys if needed"),!this.keyPair){console.log("Initializing crypto keys directly..."),this.userId||(this.userId=localStorage.getItem("digital_assets_user_id")||"user-"+Math.random().toString(36).substring(2,10),localStorage.setItem("digital_assets_user_id",this.userId));let t=n(this.userId);t||(t=e(),r(this.userId,t)),this.keyPair=t,this.signData||(this.signData=t=>(console.log("Signing data with fixed signature method"),((t,e)=>{try{const r=new Uint8Array(64),n="string"==typeof t?t:JSON.stringify(t),s=(new TextEncoder).encode(n);let i=0;for(let t=0;t<s.length;t++)i=(i<<5)-i+s[t]|0;for(let t=0;t<64;t++){const n=t<e.length?e[t%e.length]:0;r[t]=(i*(t+1)+n)%256}return r}catch(t){return console.error("Error signing data:",t),new Uint8Array(64)}})(t,this.keyPair.privateKey))),this.hashContent||(this.hashContent=t=>{console.log("Hashing content with fixed method");const e=new Uint8Array(32),r="string"==typeof t?t:String(t);for(let t=0;t<r.length;t++)e[t%32]=(e[t%32]+r.charCodeAt(t))%256;return e}),console.log("Crypto keys initialized:",{userId:this.userId,publicKey:this.keyPair.publicKey.substring(0,10)+"..."})}try{const e=s[0];!e.content&&e.file&&(console.log("Converting file to content",e.file),e.content=e.file);const r="asset-"+Date.now().toString(36)+"-"+e.title.toLowerCase().replace(/\s+/g,"-").substring(0,10);if(console.log("Creating asset with ID:",r),this.fileSystem?.rootDirectory&&"function"==typeof e.content?.arrayBuffer)return console.log("Using real implementation for asset creation"),t.apply(this,s);{console.log("Using mock implementation for asset creation");const t=e.content?.type||"application/octet-stream",n=e.content?.name||"file.bin",s={id:r,title:e.title,description:e.description||"",createdAt:Date.now(),creator:{id:this.userId||"user-1",name:e.creatorName||"User",publicKey:this.keyPair?Array.from(this.keyPair.publicKey):new Array(32).fill(0)},contentHash:Array.from(new Uint8Array(32).map((()=>Math.floor(256*Math.random())))),signatures:[{algorithm:"Ed25519",publicKey:this.keyPair?Array.from(this.keyPair.publicKey):new Array(32).fill(0),signature:this.signData?Array.from(this.signData(r+e.title)):new Array(64).fill(0),timestamp:Date.now()}],editions:{total:e.editions||1,current:1},mediaType:t,filename:n,version:"1.0"};return console.log("Created mock asset metadata:",s),s}}catch(t){throw console.error("Error in enhanced createAsset:",t),t}},window.assetManagerInstance.getCryptoKeys||(window.assetManagerInstance.getCryptoKeys=function(){return this.keyPair||null}),window.assetManagerInstance.initializeCryptoKeys||(window.assetManagerInstance.initializeCryptoKeys=async function(){return this.userId||(this.userId=localStorage.getItem("digital_assets_user_id")||"user-"+Math.random().toString(36).substring(2,10),localStorage.setItem("digital_assets_user_id",this.userId)),this.keyPair=n(this.userId)||e(),r(this.userId,this.keyPair),this.keyPair}),console.log("Crypto fix applied successfully!"),!0};if(t())return;let s=0;const i=setInterval((()=>{s++,(t()||s>60)&&(clearInterval(i),s>60&&console.warn("Failed to apply crypto fix after maximum attempts"))}),500)})()}))},526:(t,e)=>{"use strict";e.byteLength=function(t){var e=a(t),r=e[0],n=e[1];return 3*(r+n)/4-n},e.toByteArray=function(t){var e,r,i=a(t),o=i[0],c=i[1],l=new s(function(t,e,r){return 3*(e+r)/4-r}(0,o,c)),u=0,h=c>0?o-4:o;for(r=0;r<h;r+=4)e=n[t.charCodeAt(r)]<<18|n[t.charCodeAt(r+1)]<<12|n[t.charCodeAt(r+2)]<<6|n[t.charCodeAt(r+3)],l[u++]=e>>16&255,l[u++]=e>>8&255,l[u++]=255&e;return 2===c&&(e=n[t.charCodeAt(r)]<<2|n[t.charCodeAt(r+1)]>>4,l[u++]=255&e),1===c&&(e=n[t.charCodeAt(r)]<<10|n[t.charCodeAt(r+1)]<<4|n[t.charCodeAt(r+2)]>>2,l[u++]=e>>8&255,l[u++]=255&e),l},e.fromByteArray=function(t){for(var e,n=t.length,s=n%3,i=[],o=16383,a=0,l=n-s;a<l;a+=o)i.push(c(t,a,a+o>l?l:a+o));return 1===s?(e=t[n-1],i.push(r[e>>2]+r[e<<4&63]+"==")):2===s&&(e=(t[n-2]<<8)+t[n-1],i.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"=")),i.join("")};for(var r=[],n=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0;o<64;++o)r[o]=i[o],n[i.charCodeAt(o)]=o;function a(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");return-1===r&&(r=e),[r,r===e?0:4-r%4]}function c(t,e,n){for(var s,i,o=[],a=e;a<n;a+=3)s=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]),o.push(r[(i=s)>>18&63]+r[i>>12&63]+r[i>>6&63]+r[63&i]);return o.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},540:t=>{"use strict";t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},601:t=>{"use strict";t.exports=function(t){return t[1]}},659:t=>{"use strict";var e={};t.exports=function(t,r){var n=function(t){if(void 0===e[t]){var r=document.querySelector(t);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(t){r=null}e[t]=r}return e[t]}(t);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(r)}},825:t=>{"use strict";t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(r){!function(t,e,r){var n="";r.supports&&(n+="@supports (".concat(r.supports,") {")),r.media&&(n+="@media ".concat(r.media," {"));var s=void 0!==r.layer;s&&(n+="@layer".concat(r.layer.length>0?" ".concat(r.layer):""," {")),n+=r.css,s&&(n+="}"),r.media&&(n+="}"),r.supports&&(n+="}");var i=r.sourceMap;i&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleTagTransform(n,t,e.options)}(e,t,r)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}}},n={};function s(t){var e=n[t];if(void 0!==e)return e.exports;var i=n[t]={id:t,exports:{}};return r[t](i,i.exports,s),i.exports}s.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return s.d(e,{a:e}),e},e=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__,s.t=function(r,n){if(1&n&&(r=this(r)),8&n)return r;if("object"==typeof r&&r){if(4&n&&r.__esModule)return r;if(16&n&&"function"==typeof r.then)return r}var i=Object.create(null);s.r(i);var o={};t=t||[null,e({}),e([]),e(e)];for(var a=2&n&&r;"object"==typeof a&&!~t.indexOf(a);a=e(a))Object.getOwnPropertyNames(a).forEach((t=>o[t]=()=>r[t]));return o.default=()=>r,s.d(i,o),i},s.d=(t,e)=>{for(var r in e)s.o(e,r)&&!s.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),s.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.nc=void 0,(()=>{"use strict";var t={};s.r(t),s.d(t,{OG:()=>Va,My:()=>Fa,Ph:()=>Ma,lX:()=>Ga,Id:()=>za,fg:()=>_a,qj:()=>ja,aT:()=>La,lq:()=>Ha,z:()=>Qa,Q5:()=>Wa});var e=s(72),r=s.n(e),n=s(825),i=s.n(n),o=s(659),a=s.n(o),c=s(56),l=s.n(c),u=s(540),h=s.n(u),f=s(113),d=s.n(f),p=s(365),g={};g.styleTagTransform=d(),g.setAttributes=l(),g.insert=a().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=h(),r()(p.A,g),p.A&&p.A.locals&&p.A.locals;class y{constructor(){this.rootDirectory=null}async selectDirectory(){try{if(!("showDirectoryPicker"in window))throw console.error("File System Access API is not available in this browser"),alert("Your browser does not support the File System Access API. Please use Chrome, Edge, or another Chromium-based browser."),new Error("File System Access API is not supported in this browser");let t;console.log("Attempting to show directory picker dialog..."),alert("You will now be prompted to select a directory for storing your digital assets. Please select a directory with write permissions.");try{t=await window.showDirectoryPicker(),console.log("Directory selected successfully:",t);try{const e=await(t.requestPermission?.({mode:"readwrite"}))||"granted";if(console.log("Permission status:",e),"granted"!==e)throw alert("Read/write permission was denied for the selected directory. Please grant permission to continue."),new Error("Permission not granted for file access")}catch(t){throw console.error("Error requesting permission:",t),alert("Unable to get permissions for the selected directory: "+t),new Error("Failed to get directory permissions: "+t)}}catch(t){throw console.error("Error in showDirectoryPicker:",t),alert("Error selecting directory: "+t),new Error("Failed to select directory: "+t)}console.log("Directory picker succeeded:",t);try{const e=await t.getDirectoryHandle("assets",{create:!0}),r=await t.getDirectoryHandle("metadata",{create:!0});console.log("Created assets and metadata directories:",{assetsDir:e,metadataDir:r})}catch(t){console.error("Error creating subdirectories:",t)}return this.rootDirectory={name:t.name,path:t.name,handle:t},console.log("Root directory set:",this.rootDirectory),alert("Directory selected successfully: "+t.name),this.rootDirectory}catch(t){return t instanceof Error?(console.error(`Error selecting directory: ${t.name} - ${t.message}`),console.error("Error stack:",t.stack)):console.error("Unknown error selecting directory:",t),null}}ensureRootDirectory(){if(!this.rootDirectory)throw new Error("No root directory selected. Please select a directory first.")}async createDirectory(t){this.ensureRootDirectory();const e=t.split("/").filter((t=>t.length>0));let r=this.rootDirectory.handle;for(const t of e)r=await r.getDirectoryHandle(t,{create:!0});return r}async writeFile(t,e){this.ensureRootDirectory();const r=t.lastIndexOf("/"),n=r>0?t.substring(0,r):"",s=r>0?t.substring(r+1):t,i=n.length>0?await this.createDirectory(n):this.rootDirectory.handle,o=await i.getFileHandle(s,{create:!0}),a=await o.createWritable();await a.write(e),await a.close()}async readFile(t){this.ensureRootDirectory();const e=t.lastIndexOf("/"),r=e>0?t.substring(0,e):"",n=e>0?t.substring(e+1):t;let s;try{if(r.length>0){const t=r.split("/").filter((t=>t.length>0));s=this.rootDirectory.handle;for(const e of t)s=await s.getDirectoryHandle(e)}else s=this.rootDirectory.handle;const t=await s.getFileHandle(n),e=await t.getFile();return await e.arrayBuffer()}catch(e){throw console.error(`Error reading file at ${t}:`,e),new Error(`Cannot access image file at ${t}. Browser may have revoked permissions. Please select the directory again.`)}}async listFiles(t){let e;if(this.ensureRootDirectory(),t&&"/"!==t){const r=t.split("/").filter((t=>t.length>0));e=this.rootDirectory.handle;for(const t of r)e=await e.getDirectoryHandle(t)}else e=this.rootDirectory.handle;const r=[];for await(const[t,n]of e.entries())"file"===n.kind&&r.push(t);return r}async fileExists(t){try{this.ensureRootDirectory();const e=t.lastIndexOf("/"),r=e>0?t.substring(0,e):"",n=e>0?t.substring(e+1):t;let s;if(r.length>0){const t=r.split("/").filter((t=>t.length>0));s=this.rootDirectory.handle;for(const e of t)s=await s.getDirectoryHandle(e)}else s=this.rootDirectory.handle;return await s.getFileHandle(n),!0}catch(t){return!1}}}let m={};async function w(t){try{E("Loading assets...");const e=await t.getAssets();e.length>0&&(b("assets-gallery"),function(t,e){const r=m["assets-container"];r.innerHTML="",0!==e.length?e.forEach((e=>{const n=document.createElement("div");n.className="asset-card",n.setAttribute("data-asset-id",e.id);let s="";s=e.mediaType.startsWith("image/")?'<div class="asset-preview image-preview" style="background-color: #f0f0f0; height: 180px; display: flex; align-items: center; justify-content: center;">\n        <span style="font-size: 48px;">üñºÔ∏è</span>\n      </div>':e.mediaType.startsWith("video/")?'<div class="asset-preview video-preview" style="background-color: #f0f0f0; height: 180px; display: flex; align-items: center; justify-content: center;">\n        <span style="font-size: 48px;">üé¨</span>\n      </div>':e.mediaType.startsWith("audio/")?'<div class="asset-preview audio-preview" style="background-color: #f0f0f0; height: 180px; display: flex; align-items: center; justify-content: center;">\n        <span style="font-size: 48px;">üéµ</span>\n      </div>':'<div class="asset-preview generic-preview" style="background-color: #f0f0f0; height: 180px; display: flex; align-items: center; justify-content: center;">\n        <span style="font-size: 48px;">üìÑ</span>\n      </div>',n.innerHTML=`\n      ${s}\n      <div class="asset-info">\n        <h3 class="asset-title">${e.title}</h3>\n        <p class="asset-meta">Edition ${e.editions.current} of ${e.editions.total}</p>\n        <p class="asset-meta">Created ${new Date(e.createdAt).toLocaleDateString()}</p>\n      </div>\n    `,n.addEventListener("click",(()=>{!async function(t,e){try{E("Loading asset details...");const r=await t.getAsset(e),n=m["asset-detail-container"];let s="Not on blockchain";r.blockchain&&(s=`Registered on ${r.blockchain.network}<br>\n        Transaction: ${r.blockchain.transactionHash.substring(0,10)}...<br>\n        Contract: ${r.blockchain.contractAddress}`);const i=new Date(r.createdAt).toLocaleString();n.innerHTML=`\n      <div class="asset-detail-info">\n        <h3>${r.title}</h3>\n        <p class="asset-description">${r.description||"No description"}</p>\n        \n        <div class="asset-metadata">\n          <p><strong>Creator:</strong> ${r.creator.name}</p>\n          <p><strong>Created:</strong> ${i}</p>\n          <p><strong>Edition:</strong> ${r.editions.current} of ${r.editions.total}</p>\n          <p><strong>Media Type:</strong> ${r.mediaType}</p>\n          <p><strong>Blockchain Status:</strong> <span id="blockchain-status">${s}</span></p>\n        </div>\n        \n        <div class="asset-technical">\n          <p><strong>Asset ID:</strong> ${r.id}</p>\n          <p><strong>Content Hash:</strong> ${r.contentHash}</p>\n          <p><strong>File:</strong> ${r.filename}</p>\n        </div>\n      </div>\n      \n      <div class="asset-detail-preview">\n        <div class="asset-large-preview" style="background-color: #f0f0f0; height: 300px; display: flex; align-items: center; justify-content: center;">\n          <span style="font-size: 72px;">${r.mediaType.startsWith("image/")?"üñºÔ∏è":r.mediaType.startsWith("video/")?"üé¨":r.mediaType.startsWith("audio/")?"üéµ":"üìÑ"}</span>\n        </div>\n      </div>\n    `,m["verify-asset-btn"].setAttribute("data-asset-id",e),m["export-asset-btn"].setAttribute("data-asset-id",e),m["blockchain-asset-btn"].setAttribute("data-asset-id",e),r.blockchain?(m["blockchain-asset-btn"].textContent="Already on Blockchain",m["blockchain-asset-btn"].setAttribute("disabled","disabled")):(m["blockchain-asset-btn"].textContent="Move to Blockchain",m["blockchain-asset-btn"].removeAttribute("disabled")),A("assets-gallery"),b("asset-details")}catch(t){console.error("Error showing asset details:",t),alert(`Failed to load asset details: ${t instanceof Error?t.message:String(t)}`)}finally{v()}}(t,e.id)})),r.appendChild(n)})):r.innerHTML='<p class="no-assets">No digital assets yet. Create your first one!</p>'}(t,e))}catch(t){console.error("Error loading assets:",t),alert(`Failed to load assets: ${t instanceof Error?t.message:String(t)}`)}finally{v()}}function b(t){m[t]&&m[t].classList.remove("hidden")}function A(t){m[t]&&m[t].classList.add("hidden")}function E(t="Processing..."){const e=m["loading-overlay"],r=m["loading-message"];r&&(r.textContent=t),e&&e.classList.remove("hidden")}function v(){const t=m["loading-overlay"];t&&t.classList.add("hidden")}const k={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let x;const B=new Uint8Array(16);function I(){if(!x&&(x="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!x))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return x(B)}const P=[];for(let t=0;t<256;++t)P.push((t+256).toString(16).slice(1));const N=function(t,e,r){if(k.randomUUID&&!e&&!t)return k.randomUUID();const n=(t=t||{}).random||(t.rng||I)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,e){r=r||0;for(let t=0;t<16;++t)e[r+t]=n[t];return e}return function(t,e=0){return P[t[e+0]]+P[t[e+1]]+P[t[e+2]]+P[t[e+3]]+"-"+P[t[e+4]]+P[t[e+5]]+"-"+P[t[e+6]]+P[t[e+7]]+"-"+P[t[e+8]]+P[t[e+9]]+"-"+P[t[e+10]]+P[t[e+11]]+P[t[e+12]]+P[t[e+13]]+P[t[e+14]]+P[t[e+15]]}(n)};var C=s(287);function R(t,...e){if(!((r=t)instanceof Uint8Array||ArrayBuffer.isView(r)&&"Uint8Array"===r.constructor.name))throw new Error("Uint8Array expected");var r;if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function O(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function S(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function T(t,e){return t<<32-e|t>>>e}function U(t){return"string"==typeof t&&(t=function(t){if("string"!=typeof t)throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array((new TextEncoder).encode(t))}(t)),R(t),t}class F{clone(){return this._cloneInto()}}function D(t){const e=e=>t().update(U(e)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function L(t,e,r){return t&e^~t&r}function M(t,e,r){return t&e^t&r^e&r}class G extends F{constructor(t,e,r,n){super(),this.blockLen=t,this.outputLen=e,this.padOffset=r,this.isLE=n,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=S(this.buffer)}update(t){O(this);const{view:e,buffer:r,blockLen:n}=this,s=(t=U(t)).length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);if(o!==n)r.set(t.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===n&&(this.process(e,0),this.pos=0);else{const e=S(t);for(;n<=s-i;i+=n)this.process(e,i)}}return this.length+=t.length,this.roundClean(),this}digestInto(t){O(this),function(t,e){R(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}(t,this),this.finished=!0;const{buffer:e,view:r,blockLen:n,isLE:s}=this;let{pos:i}=this;e[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>n-i&&(this.process(r,0),i=0);for(let t=i;t<n;t++)e[t]=0;!function(t,e,r,n){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,r,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(r>>s&i),a=Number(r&i),c=n?4:0,l=n?0:4;t.setUint32(e+c,o,n),t.setUint32(e+l,a,n)}(r,n-8,BigInt(8*this.length),s),this.process(r,0);const o=S(t),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=a/4,l=this.get();if(c>l.length)throw new Error("_sha2: outputLen bigger than state");for(let t=0;t<c;t++)o.setUint32(4*t,l[t],s)}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const r=t.slice(0,e);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:e,buffer:r,length:n,finished:s,destroyed:i,pos:o}=this;return t.length=n,t.pos=o,t.finished=s,t.destroyed=i,n%e&&t.buffer.set(r),t}}const H=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Q=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),j=new Uint32Array(64);class z extends G{constructor(){super(64,32,8,!1),this.A=0|Q[0],this.B=0|Q[1],this.C=0|Q[2],this.D=0|Q[3],this.E=0|Q[4],this.F=0|Q[5],this.G=0|Q[6],this.H=0|Q[7]}get(){const{A:t,B:e,C:r,D:n,E:s,F:i,G:o,H:a}=this;return[t,e,r,n,s,i,o,a]}set(t,e,r,n,s,i,o,a){this.A=0|t,this.B=0|e,this.C=0|r,this.D=0|n,this.E=0|s,this.F=0|i,this.G=0|o,this.H=0|a}process(t,e){for(let r=0;r<16;r++,e+=4)j[r]=t.getUint32(e,!1);for(let t=16;t<64;t++){const e=j[t-15],r=j[t-2],n=T(e,7)^T(e,18)^e>>>3,s=T(r,17)^T(r,19)^r>>>10;j[t]=s+j[t-7]+n+j[t-16]|0}let{A:r,B:n,C:s,D:i,E:o,F:a,G:c,H:l}=this;for(let t=0;t<64;t++){const e=l+(T(o,6)^T(o,11)^T(o,25))+L(o,a,c)+H[t]+j[t]|0,u=(T(r,2)^T(r,13)^T(r,22))+M(r,n,s)|0;l=c,c=a,a=o,o=i+e|0,i=s,s=n,n=r,r=e+u|0}r=r+this.A|0,n=n+this.B|0,s=s+this.C|0,i=i+this.D|0,o=o+this.E|0,a=a+this.F|0,c=c+this.G|0,l=l+this.H|0,this.set(r,n,s,i,o,a,c,l)}roundClean(){j.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const V=D((()=>new z));var K=s(122),J=s.t(K,2);const _=BigInt(0),q=BigInt(1),W=BigInt(2),Z=BigInt(8),$=BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),Y=Object.freeze({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),P:BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),l:$,n:$,h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960")}),X=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000"),tt=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),et=(BigInt("6853475219497561581579357271197624642482790079785650197046958215289687604742"),BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235")),rt=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),nt=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),st=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");class it{constructor(t,e,r,n){this.x=t,this.y=e,this.z=r,this.t=n}static fromAffine(t){if(!(t instanceof ft))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return t.equals(ft.ZERO)?it.ZERO:new it(t.x,t.y,q,xt(t.x*t.y))}static toAffineBatch(t){const e=function(t,e=Y.P){const r=new Array(t.length),n=Bt(t.reduce(((t,n,s)=>n===_?t:(r[s]=t,xt(t*n,e))),q),e);return t.reduceRight(((t,n,s)=>n===_?t:(r[s]=xt(t*r[s],e),xt(t*n,e))),n),r}(t.map((t=>t.z)));return t.map(((t,r)=>t.toAffine(e[r])))}static normalizeZ(t){return this.toAffineBatch(t).map(this.fromAffine)}equals(t){at(t);const{x:e,y:r,z:n}=this,{x:s,y:i,z:o}=t,a=xt(e*o),c=xt(s*n),l=xt(r*o),u=xt(i*n);return a===c&&l===u}negate(){return new it(xt(-this.x),this.y,this.z,xt(-this.t))}double(){const{x:t,y:e,z:r}=this,{a:n}=Y,s=xt(t*t),i=xt(e*e),o=xt(W*xt(r*r)),a=xt(n*s),c=t+e,l=xt(xt(c*c)-s-i),u=a+i,h=u-o,f=a-i,d=xt(l*h),p=xt(u*f),g=xt(l*f),y=xt(h*u);return new it(d,p,y,g)}add(t){at(t);const{x:e,y:r,z:n,t:s}=this,{x:i,y:o,z:a,t:c}=t,l=xt((r-e)*(o+i)),u=xt((r+e)*(o-i)),h=xt(u-l);if(h===_)return this.double();const f=xt(n*W*c),d=xt(s*W*a),p=d+f,g=u+l,y=d-f,m=xt(p*h),w=xt(g*y),b=xt(p*y),A=xt(h*g);return new it(m,w,A,b)}subtract(t){return this.add(t.negate())}precomputeWindow(t){const e=1+256/t,r=[];let n=this,s=n;for(let i=0;i<e;i++){s=n,r.push(s);for(let e=1;e<2**(t-1);e++)s=s.add(n),r.push(s);n=s.double()}return r}wNAF(t,e){!e&&this.equals(it.BASE)&&(e=ft.BASE);const r=e&&e._WINDOW_SIZE||1;if(256%r)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let n=e&&ht.get(e);n||(n=this.precomputeWindow(r),e&&1!==r&&(n=it.normalizeZ(n),ht.set(e,n)));let s=it.ZERO,i=it.BASE;const o=1+256/r,a=2**(r-1),c=BigInt(2**r-1),l=2**r,u=BigInt(r);for(let e=0;e<o;e++){const r=e*a;let o=Number(t&c);t>>=u,o>a&&(o-=l,t+=q);const h=r,f=r+Math.abs(o)-1,d=e%2!=0,p=o<0;0===o?i=i.add(ot(d,n[h])):s=s.add(ot(p,n[f]))}return it.normalizeZ([s,i])[0]}multiply(t,e){return this.wNAF(Ot(t,Y.l),e)}multiplyUnsafe(t){let e=Ot(t,Y.l,!1);const r=it.BASE,n=it.ZERO;if(e===_)return n;if(this.equals(n)||e===q)return this;if(this.equals(r))return this.wNAF(e);let s=n,i=this;for(;e>_;)e&q&&(s=s.add(i)),i=i.double(),e>>=q;return s}isSmallOrder(){return this.multiplyUnsafe(Y.h).equals(it.ZERO)}isTorsionFree(){let t=this.multiplyUnsafe(Y.l/W).double();return Y.l%W&&(t=t.add(this)),t.equals(it.ZERO)}toAffine(t){const{x:e,y:r,z:n}=this,s=this.equals(it.ZERO);null==t&&(t=s?Z:Bt(n));const i=xt(e*t),o=xt(r*t),a=xt(n*t);if(s)return ft.ZERO;if(a!==q)throw new Error("invZ was invalid");return new ft(i,o)}fromRistrettoBytes(){lt()}toRistrettoBytes(){lt()}fromRistrettoHash(){lt()}}function ot(t,e){const r=e.negate();return t?r:e}function at(t){if(!(t instanceof it))throw new TypeError("ExtendedPoint expected")}function ct(t){if(!(t instanceof ut))throw new TypeError("RistrettoPoint expected")}function lt(){throw new Error("Legacy method: switch to RistrettoPoint")}it.BASE=new it(Y.Gx,Y.Gy,q,xt(Y.Gx*Y.Gy)),it.ZERO=new it(_,q,q,_);class ut{constructor(t){this.ep=t}static calcElligatorRistrettoMap(t){const{d:e}=Y,r=xt(tt*t*t),n=xt((r+q)*nt);let s=BigInt(-1);const i=xt((s-e*r)*xt(r+e));let{isValid:o,value:a}=Pt(n,i),c=xt(a*t);At(c)||(c=xt(-c)),o||(a=c),o||(s=r);const l=xt(s*(r-q)*st-i),u=a*a,h=xt((a+a)*i),f=xt(l*et),d=xt(q-u),p=xt(q+u);return new it(xt(h*p),xt(d*f),xt(f*p),xt(h*d))}static hashToCurve(t){const e=kt((t=Rt(t,64)).slice(0,32)),r=this.calcElligatorRistrettoMap(e),n=kt(t.slice(32,64)),s=this.calcElligatorRistrettoMap(n);return new ut(r.add(s))}static fromHex(t){t=Rt(t,32);const{a:e,d:r}=Y,n="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",s=kt(t);if(!function(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}(bt(s),t)||At(s))throw new Error(n);const i=xt(s*s),o=xt(q+e*i),a=xt(q-e*i),c=xt(o*o),l=xt(a*a),u=xt(e*r*c-l),{isValid:h,value:f}=Nt(xt(u*l)),d=xt(f*a),p=xt(f*d*u);let g=xt((s+s)*d);At(g)&&(g=xt(-g));const y=xt(o*p),m=xt(g*y);if(!h||At(m)||y===_)throw new Error(n);return new ut(new it(g,y,q,m))}toRawBytes(){let{x:t,y:e,z:r,t:n}=this.ep;const s=xt(xt(r+e)*xt(r-e)),i=xt(t*e),o=xt(i*i),{value:a}=Nt(xt(s*o)),c=xt(a*s),l=xt(a*i),u=xt(c*l*n);let h;if(At(n*u)){let r=xt(e*tt),n=xt(t*tt);t=r,e=n,h=xt(c*rt)}else h=l;At(t*u)&&(e=xt(-e));let f=xt((r-e)*h);return At(f)&&(f=xt(-f)),bt(f)}toHex(){return yt(this.toRawBytes())}toString(){return this.toHex()}equals(t){ct(t);const e=this.ep,r=t.ep,n=xt(e.x*r.y)===xt(e.y*r.x),s=xt(e.y*r.y)===xt(e.x*r.x);return n||s}add(t){return ct(t),new ut(this.ep.add(t.ep))}subtract(t){return ct(t),new ut(this.ep.subtract(t.ep))}multiply(t){return new ut(this.ep.multiply(t))}multiplyUnsafe(t){return new ut(this.ep.multiplyUnsafe(t))}}ut.BASE=new ut(it.BASE),ut.ZERO=new ut(it.ZERO);const ht=new WeakMap;class ft{constructor(t,e){this.x=t,this.y=e}_setWindowSize(t){this._WINDOW_SIZE=t,ht.delete(this)}static fromHex(t,e=!0){const{d:r,P:n}=Y,s=(t=Rt(t,32)).slice();s[31]=-129&t[31];const i=Et(s);if(e&&i>=n)throw new Error("Expected 0 < hex < P");if(!e&&i>=X)throw new Error("Expected 0 < hex < 2**256");const o=xt(i*i),a=xt(o-q),c=xt(r*o+q);let{isValid:l,value:u}=Pt(a,c);if(!l)throw new Error("Point.fromHex: invalid y coordinate");const h=(u&q)===q;return!!(128&t[31])!==h&&(u=xt(-u)),new ft(u,i)}static async fromPrivateKey(t){return(await Tt(t)).point}toRawBytes(){const t=bt(this.y);return t[31]|=this.x&q?128:0,t}toHex(){return yt(this.toRawBytes())}toX25519(){const{y:t}=this;return bt(xt((q+t)*Bt(q-t)))}isTorsionFree(){return it.fromAffine(this).isTorsionFree()}equals(t){return this.x===t.x&&this.y===t.y}negate(){return new ft(xt(-this.x),this.y)}add(t){return it.fromAffine(this).add(it.fromAffine(t)).toAffine()}subtract(t){return this.add(t.negate())}multiply(t){return it.fromAffine(this).multiply(t,this).toAffine()}}ft.BASE=new ft(Y.Gx,Y.Gy),ft.ZERO=new ft(_,q);class dt{constructor(t,e){this.r=t,this.s=e,this.assertValidity()}static fromHex(t){const e=Rt(t,64),r=ft.fromHex(e.slice(0,32),!1),n=Et(e.slice(32,64));return new dt(r,n)}assertValidity(){const{r:t,s:e}=this;if(!(t instanceof ft))throw new Error("Expected Point instance");return Ot(e,Y.l,!1),this}toRawBytes(){const t=new Uint8Array(64);return t.set(this.r.toRawBytes()),t.set(bt(this.s),32),t}toHex(){return yt(this.toRawBytes())}}function pt(...t){if(!t.every((t=>t instanceof Uint8Array)))throw new Error("Expected Uint8Array list");if(1===t.length)return t[0];const e=t.reduce(((t,e)=>t+e.length),0),r=new Uint8Array(e);for(let e=0,n=0;e<t.length;e++){const s=t[e];r.set(s,n),n+=s.length}return r}const gt=Array.from({length:256},((t,e)=>e.toString(16).padStart(2,"0")));function yt(t){if(!(t instanceof Uint8Array))throw new Error("Uint8Array expected");let e="";for(let r=0;r<t.length;r++)e+=gt[t[r]];return e}function mt(t){if("string"!=typeof t)throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const e=new Uint8Array(t.length/2);for(let r=0;r<e.length;r++){const n=2*r,s=t.slice(n,n+2),i=Number.parseInt(s,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");e[r]=i}return e}function wt(t){return mt(t.toString(16).padStart(64,"0"))}function bt(t){return wt(t).reverse()}function At(t){return(xt(t)&q)===q}function Et(t){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");return BigInt("0x"+yt(Uint8Array.from(t).reverse()))}const vt=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function kt(t){return xt(Et(t)&vt)}function xt(t,e=Y.P){const r=t%e;return r>=_?r:e+r}function Bt(t,e=Y.P){if(t===_||e<=_)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=xt(t,e),n=e,s=_,i=q,o=q,a=_;for(;r!==_;){const t=n/r,e=n%r,c=s-o*t,l=i-a*t;n=r,r=e,s=o,i=a,o=c,a=l}if(n!==q)throw new Error("invert: does not exist");return xt(s,e)}function It(t,e){const{P:r}=Y;let n=t;for(;e-- >_;)n*=n,n%=r;return n}function Pt(t,e){const r=xt(e*e*e),n=xt(r*r*e);let s=xt(t*r*function(t){const{P:e}=Y,r=BigInt(5),n=BigInt(10),s=BigInt(20),i=BigInt(40),o=BigInt(80),a=t*t%e*t%e,c=It(a,W)*a%e,l=It(c,q)*t%e,u=It(l,r)*l%e,h=It(u,n)*u%e,f=It(h,s)*h%e,d=It(f,i)*f%e,p=It(d,o)*d%e,g=It(p,o)*d%e,y=It(g,n)*u%e;return{pow_p_5_8:It(y,W)*t%e,b2:a}}(t*n).pow_p_5_8);const i=xt(e*s*s),o=s,a=xt(s*tt),c=i===t,l=i===xt(-t),u=i===xt(-t*tt);return c&&(s=o),(l||u)&&(s=a),At(s)&&(s=xt(-s)),{isValid:c||l,value:s}}function Nt(t){return Pt(q,t)}function Ct(t){return xt(Et(t),Y.l)}function Rt(t,e){const r=t instanceof Uint8Array?Uint8Array.from(t):mt(t);if("number"==typeof e&&r.length!==e)throw new Error(`Expected ${e} bytes`);return r}function Ot(t,e,r=!0){if(!e)throw new TypeError("Specify max value");if("number"==typeof t&&Number.isSafeInteger(t)&&(t=BigInt(t)),"bigint"==typeof t&&t<e)if(r){if(_<t)return t}else if(_<=t)return t;throw new TypeError("Expected valid scalar: 0 < scalar < max")}let St;async function Tt(t){return function(t){const e=function(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}(t.slice(0,32)),r=t.slice(32,64),n=Ct(e),s=ft.BASE.multiply(n),i=s.toRawBytes();return{head:e,prefix:r,scalar:n,point:s,pointBytes:i}}(await Ft.sha512(function(t){if(32!==(t="bigint"==typeof t||"number"==typeof t?wt(Ot(t,X)):Rt(t)).length)throw new Error("Expected 32 bytes");return t}(t)))}ft.BASE._setWindowSize(8);const Ut={node:J,web:"object"==typeof self&&"crypto"in self?self.crypto:void 0},Ft={bytesToHex:yt,hexToBytes:mt,concatBytes:pt,getExtendedPublicKey:Tt,mod:xt,invert:Bt,TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],hashToPrivateScalar:t=>{if((t=Rt(t)).length<40||t.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");return xt(Et(t),Y.l-q)+q},randomBytes:(t=32)=>{if(Ut.web)return Ut.web.getRandomValues(new Uint8Array(t));if(Ut.node){const{randomBytes:e}=Ut.node;return new Uint8Array(e(t).buffer)}throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>Ft.randomBytes(32),sha512:async(...t)=>{const e=pt(...t);if(Ut.web){const t=await Ut.web.subtle.digest("SHA-512",e.buffer);return new Uint8Array(t)}if(Ut.node)return Uint8Array.from(Ut.node.createHash("sha512").update(e).digest());throw new Error("The environment doesn't have sha512 function")},precompute(t=8,e=ft.BASE){const r=e.equals(ft.BASE)?e:new ft(e.x,e.y);return r._setWindowSize(t),r.multiply(W),r},sha512Sync:void 0};function Dt(t){return V(new Uint8Array(t))}async function Lt(t,e){return await async function(t,e){t=Rt(t);const{prefix:r,scalar:n,pointBytes:s}=await Tt(e),i=Ct(await Ft.sha512(r,t)),o=ft.BASE.multiply(i),a=xt(i+Ct(await Ft.sha512(o.toRawBytes(),s,t))*n,Y.l);return new dt(o,a).toRawBytes()}(t,e)}async function Mt(t,e,r){try{return await async function(t,e,r){const{r:n,SB:s,msg:i,pub:o}=function(t,e,r){e=Rt(e),r instanceof ft||(r=ft.fromHex(r,!1));const{r:n,s}=t instanceof dt?t.assertValidity():dt.fromHex(t);return{r:n,s,SB:it.BASE.multiplyUnsafe(s),pub:r,msg:e}}(t,e,r),a=await Ft.sha512(n.toRawBytes(),o.toRawBytes(),i);return function(t,e,r,n){const s=Ct(n),i=it.fromAffine(t).multiplyUnsafe(s);return it.fromAffine(e).add(i).subtract(r).multiplyUnsafe(Y.h).equals(it.ZERO)}(o,n,s,a)}(e,t,r)}catch(t){return console.error("Signature verification error:",t),!1}}function Gt(t,e,r){const n=e.split("|").map((t=>t.trim()));for(let r=0;r<n.length;r++)switch(e){case"any":return;case"bigint":case"boolean":case"number":case"string":if(typeof t===e)return}const s=new Error(`invalid value for type ${e}`);throw s.code="INVALID_ARGUMENT",s.argument=`value.${r}`,s.value=t,s}async function Ht(t){const e=Object.keys(t);return(await Promise.all(e.map((e=>Promise.resolve(t[e]))))).reduce(((t,r,n)=>(t[e[n]]=r,t)),{})}function Qt(t,e,r){for(let n in e){let s=e[n];const i=r?r[n]:null;i&&Gt(s,i,n),Object.defineProperty(t,n,{enumerable:!0,value:s,writable:!1})}}function jt(t){if(null==t)return"null";if(Array.isArray(t))return"[ "+t.map(jt).join(", ")+" ]";if(t instanceof Uint8Array){const e="0123456789abcdef";let r="0x";for(let n=0;n<t.length;n++)r+=e[t[n]>>4],r+=e[15&t[n]];return r}if("object"==typeof t&&"function"==typeof t.toJSON)return jt(t.toJSON());switch(typeof t){case"boolean":case"symbol":case"number":return t.toString();case"bigint":return BigInt(t).toString();case"string":return JSON.stringify(t);case"object":{const e=Object.keys(t);return e.sort(),"{ "+e.map((e=>`${jt(e)}: ${jt(t[e])}`)).join(", ")+" }"}}return"[ COULD NOT SERIALIZE ]"}function zt(t,e){return t&&t.code===e}function Vt(t){return zt(t,"CALL_EXCEPTION")}function Kt(t,e,r){let n,s=t;{const n=[];if(r){if("message"in r||"code"in r||"name"in r)throw new Error(`value will overwrite populated values: ${jt(r)}`);for(const t in r){if("shortMessage"===t)continue;const e=r[t];n.push(t+"="+jt(e))}}n.push(`code=${e}`),n.push("version=6.13.5"),n.length&&(t+=" ("+n.join(", ")+")")}switch(e){case"INVALID_ARGUMENT":n=new TypeError(t);break;case"NUMERIC_FAULT":case"BUFFER_OVERRUN":n=new RangeError(t);break;default:n=new Error(t)}return Qt(n,{code:e}),r&&Object.assign(n,r),null==n.shortMessage&&Qt(n,{shortMessage:s}),n}function Jt(t,e,r,n){if(!t)throw Kt(e,r,n)}function _t(t,e,r,n){Jt(t,e,"INVALID_ARGUMENT",{argument:r,value:n})}function qt(t,e,r){null==r&&(r=""),r&&(r=": "+r),Jt(t>=e,"missing argument"+r,"MISSING_ARGUMENT",{count:t,expectedCount:e}),Jt(t<=e,"too many arguments"+r,"UNEXPECTED_ARGUMENT",{count:t,expectedCount:e})}Object.defineProperties(Ft,{sha512Sync:{configurable:!1,get:()=>St,set(t){St||(St=t)}}});const Wt=["NFD","NFC","NFKD","NFKC"].reduce(((t,e)=>{try{if("test"!=="test".normalize(e))throw new Error("bad");if("NFD"===e){if(String.fromCharCode(233).normalize("NFD")!==String.fromCharCode(101,769))throw new Error("broken")}t.push(e)}catch(t){}return t}),[]);function Zt(t,e,r){if(null==r&&(r=""),t!==e){let t=r,e="new";r&&(t+=".",e+=" "+r),Jt(!1,`private constructor; use ${t}from* methods`,"UNSUPPORTED_OPERATION",{operation:e})}}function $t(t,e,r){if(t instanceof Uint8Array)return r?new Uint8Array(t):t;if("string"==typeof t&&t.match(/^0x(?:[0-9a-f][0-9a-f])*$/i)){const e=new Uint8Array((t.length-2)/2);let r=2;for(let n=0;n<e.length;n++)e[n]=parseInt(t.substring(r,r+2),16),r+=2;return e}_t(!1,"invalid BytesLike value",e||"value",t)}function Yt(t,e){return $t(t,e,!1)}function Xt(t,e){return $t(t,e,!0)}function te(t,e){return!("string"!=typeof t||!t.match(/^0x[0-9A-Fa-f]*$/)||"number"==typeof e&&t.length!==2+2*e||!0===e&&t.length%2!=0)}function ee(t){return te(t,!0)||t instanceof Uint8Array}const re="0123456789abcdef";function ne(t){const e=Yt(t);let r="0x";for(let t=0;t<e.length;t++){const n=e[t];r+=re[(240&n)>>4]+re[15&n]}return r}function se(t){return"0x"+t.map((t=>ne(t).substring(2))).join("")}function ie(t){return te(t,!0)?(t.length-2)/2:Yt(t).length}function oe(t,e,r){const n=Yt(t);return null!=r&&r>n.length&&Jt(!1,"cannot slice beyond data bounds","BUFFER_OVERRUN",{buffer:n,length:n.length,offset:r}),ne(n.slice(null==e?0:e,null==r?n.length:r))}function ae(t,e,r){const n=Yt(t);Jt(e>=n.length,"padding exceeds data length","BUFFER_OVERRUN",{buffer:new Uint8Array(n),length:e,offset:e+1});const s=new Uint8Array(e);return s.fill(0),r?s.set(n,e-n.length):s.set(n,0),ne(s)}function ce(t,e){return ae(t,e,!0)}const le=BigInt(0),ue=BigInt(1),he=9007199254740991;function fe(t,e){const r=ye(t,"value"),n=BigInt(be(e,"width"));return Jt(r>>n===le,"overflow","NUMERIC_FAULT",{operation:"fromTwos",fault:"overflow",value:t}),r>>n-ue?-((~r&(ue<<n)-ue)+ue):r}function de(t,e){let r=ge(t,"value");const n=BigInt(be(e,"width")),s=ue<<n-ue;return r<le?(r=-r,Jt(r<=s,"too low","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:t}),(~r&(ue<<n)-ue)+ue):(Jt(r<s,"too high","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:t}),r)}function pe(t,e){const r=ye(t,"value"),n=BigInt(be(e,"bits"));return r&(ue<<n)-ue}function ge(t,e){switch(typeof t){case"bigint":return t;case"number":return _t(Number.isInteger(t),"underflow",e||"value",t),_t(t>=-he&&t<=he,"overflow",e||"value",t),BigInt(t);case"string":try{if(""===t)throw new Error("empty string");return"-"===t[0]&&"-"!==t[1]?-BigInt(t.substring(1)):BigInt(t)}catch(r){_t(!1,`invalid BigNumberish string: ${r.message}`,e||"value",t)}}_t(!1,"invalid BigNumberish value",e||"value",t)}function ye(t,e){const r=ge(t,e);return Jt(r>=le,"unsigned value cannot be negative","NUMERIC_FAULT",{fault:"overflow",operation:"getUint",value:t}),r}const me="0123456789abcdef";function we(t){if(t instanceof Uint8Array){let e="0x0";for(const r of t)e+=me[r>>4],e+=me[15&r];return BigInt(e)}return ge(t)}function be(t,e){switch(typeof t){case"bigint":return _t(t>=-he&&t<=he,"overflow",e||"value",t),Number(t);case"number":return _t(Number.isInteger(t),"underflow",e||"value",t),_t(t>=-he&&t<=he,"overflow",e||"value",t),t;case"string":try{if(""===t)throw new Error("empty string");return be(BigInt(t),e)}catch(r){_t(!1,`invalid numeric string: ${r.message}`,e||"value",t)}}_t(!1,"invalid numeric value",e||"value",t)}function Ae(t,e){let r=ye(t,"value").toString(16);if(null==e)r.length%2&&(r="0"+r);else{const n=be(e,"width");for(Jt(2*n>=r.length,`value exceeds width (${n} bytes)`,"NUMERIC_FAULT",{operation:"toBeHex",fault:"overflow",value:t});r.length<2*n;)r="0"+r}return"0x"+r}function Ee(t){const e=ye(t,"value");if(e===le)return new Uint8Array([]);let r=e.toString(16);r.length%2&&(r="0"+r);const n=new Uint8Array(r.length/2);for(let t=0;t<n.length;t++){const e=2*t;n[t]=parseInt(r.substring(e,e+2),16)}return n}function ve(t){let e=ne(ee(t)?t:Ee(t)).substring(2);for(;e.startsWith("0");)e=e.substring(1);return""===e&&(e="0"),"0x"+e}const ke=32,xe=new Uint8Array(ke),Be=["then"],Ie={},Pe=new WeakMap;function Ne(t){return Pe.get(t)}function Ce(t,e){Pe.set(t,e)}function Re(t,e){const r=new Error(`deferred error during ABI decoding triggered accessing ${t}`);throw r.error=e,r}function Oe(t,e,r){return t.indexOf(null)>=0?e.map(((t,e)=>t instanceof Se?Oe(Ne(t),t,r):t)):t.reduce(((t,n,s)=>{let i=e.getValue(n);return n in t||(r&&i instanceof Se&&(i=Oe(Ne(i),i,r)),t[n]=i),t}),{})}class Se extends Array{#t;constructor(...t){const e=t[0];let r=t[1],n=(t[2]||[]).slice(),s=!0;e!==Ie&&(r=t,n=[],s=!1),super(r.length),r.forEach(((t,e)=>{this[e]=t}));const i=n.reduce(((t,e)=>("string"==typeof e&&t.set(e,(t.get(e)||0)+1),t)),new Map);if(Ce(this,Object.freeze(r.map(((t,e)=>{const r=n[e];return null!=r&&1===i.get(r)?r:null})))),this.#t=[],null==this.#t&&this.#t,!s)return;Object.freeze(this);const o=new Proxy(this,{get:(t,e,r)=>{if("string"==typeof e){if(e.match(/^[0-9]+$/)){const r=be(e,"%index");if(r<0||r>=this.length)throw new RangeError("out of result range");const n=t[r];return n instanceof Error&&Re(`index ${r}`,n),n}if(Be.indexOf(e)>=0)return Reflect.get(t,e,r);const n=t[e];if(n instanceof Function)return function(...e){return n.apply(this===r?t:this,e)};if(!(e in t))return t.getValue.apply(this===r?t:this,[e])}return Reflect.get(t,e,r)}});return Ce(o,Ne(this)),o}toArray(t){const e=[];return this.forEach(((r,n)=>{r instanceof Error&&Re(`index ${n}`,r),t&&r instanceof Se&&(r=r.toArray(t)),e.push(r)})),e}toObject(t){const e=Ne(this);return e.reduce(((r,n,s)=>(Jt(null!=n,`value at index ${s} unnamed`,"UNSUPPORTED_OPERATION",{operation:"toObject()"}),Oe(e,this,t))),{})}slice(t,e){null==t&&(t=0),t<0&&(t+=this.length)<0&&(t=0),null==e&&(e=this.length),e<0&&(e+=this.length)<0&&(e=0),e>this.length&&(e=this.length);const r=Ne(this),n=[],s=[];for(let i=t;i<e;i++)n.push(this[i]),s.push(r[i]);return new Se(Ie,n,s)}filter(t,e){const r=Ne(this),n=[],s=[];for(let i=0;i<this.length;i++){const o=this[i];o instanceof Error&&Re(`index ${i}`,o),t.call(e,o,i,this)&&(n.push(o),s.push(r[i]))}return new Se(Ie,n,s)}map(t,e){const r=[];for(let n=0;n<this.length;n++){const s=this[n];s instanceof Error&&Re(`index ${n}`,s),r.push(t.call(e,s,n,this))}return r}getValue(t){const e=Ne(this).indexOf(t);if(-1===e)return;const r=this[e];return r instanceof Error&&Re(`property ${JSON.stringify(t)}`,r.error),r}static fromItems(t,e){return new Se(Ie,t,e)}}function Te(t){let e=Ee(t);return Jt(e.length<=ke,"value out-of-bounds","BUFFER_OVERRUN",{buffer:e,length:ke,offset:e.length}),e.length!==ke&&(e=Xt(se([xe.slice(e.length%ke),e]))),e}class Ue{name;type;localName;dynamic;constructor(t,e,r,n){Qt(this,{name:t,type:e,localName:r,dynamic:n},{name:"string",type:"string",localName:"string",dynamic:"boolean"})}_throwError(t,e){_t(!1,t,this.localName,e)}}class Fe{#e;#r;constructor(){this.#e=[],this.#r=0}get data(){return se(this.#e)}get length(){return this.#r}#n(t){return this.#e.push(t),this.#r+=t.length,t.length}appendWriter(t){return this.#n(Xt(t.data))}writeBytes(t){let e=Xt(t);const r=e.length%ke;return r&&(e=Xt(se([e,xe.slice(r)]))),this.#n(e)}writeValue(t){return this.#n(Te(t))}writeUpdatableValue(){const t=this.#e.length;return this.#e.push(xe),this.#r+=ke,e=>{this.#e[t]=Te(e)}}}class De{allowLoose;#e;#s;#i;#o;#a;constructor(t,e,r){Qt(this,{allowLoose:!!e}),this.#e=Xt(t),this.#i=0,this.#o=null,this.#a=null!=r?r:1024,this.#s=0}get data(){return ne(this.#e)}get dataLength(){return this.#e.length}get consumed(){return this.#s}get bytes(){return new Uint8Array(this.#e)}#c(t){if(this.#o)return this.#o.#c(t);this.#i+=t,Jt(this.#a<1||this.#i<=this.#a*this.dataLength,`compressed ABI data exceeds inflation ratio of ${this.#a} ( see: https://github.com/ethers-io/ethers.js/issues/4537 )`,"BUFFER_OVERRUN",{buffer:Xt(this.#e),offset:this.#s,length:t,info:{bytesRead:this.#i,dataLength:this.dataLength}})}#l(t,e,r){let n=Math.ceil(e/ke)*ke;return this.#s+n>this.#e.length&&(this.allowLoose&&r&&this.#s+e<=this.#e.length?n=e:Jt(!1,"data out-of-bounds","BUFFER_OVERRUN",{buffer:Xt(this.#e),length:this.#e.length,offset:this.#s+n})),this.#e.slice(this.#s,this.#s+n)}subReader(t){const e=new De(this.#e.slice(this.#s+t),this.allowLoose,this.#a);return e.#o=this,e}readBytes(t,e){let r=this.#l(0,t,!!e);return this.#c(t),this.#s+=r.length,r.slice(0,t)}readValue(){return we(this.readBytes(ke))}readIndex(){return be(we(this.readBytes(ke)))}}function Le(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function Me(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function Ge(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function He(t,e){Me(t);const r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}const Qe=BigInt(2**32-1),je=BigInt(32);function ze(t,e=!1){return e?{h:Number(t&Qe),l:Number(t>>je&Qe)}:{h:0|Number(t>>je&Qe),l:0|Number(t&Qe)}}function Ve(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let s=0;s<t.length;s++){const{h:i,l:o}=ze(t[s],e);[r[s],n[s]]=[i,o]}return[r,n]}const Ke=(t,e,r)=>t<<r|e>>>32-r,Je=(t,e,r)=>e<<r|t>>>32-r,_e=(t,e,r)=>e<<r-32|t>>>64-r,qe=(t,e,r)=>t<<r-32|e>>>64-r,We={fromBig:ze,split:Ve,toBig:(t,e)=>BigInt(t>>>0)<<je|BigInt(e>>>0),shrSH:(t,e,r)=>t>>>r,shrSL:(t,e,r)=>t<<32-r|e>>>r,rotrSH:(t,e,r)=>t>>>r|e<<32-r,rotrSL:(t,e,r)=>t<<32-r|e>>>r,rotrBH:(t,e,r)=>t<<64-r|e>>>r-32,rotrBL:(t,e,r)=>t>>>r-32|e<<64-r,rotr32H:(t,e)=>e,rotr32L:(t,e)=>t,rotlSH:Ke,rotlSL:Je,rotlBH:_e,rotlBL:qe,add:function(t,e,r,n){const s=(e>>>0)+(n>>>0);return{h:t+r+(s/2**32|0)|0,l:0|s}},add3L:(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),add3H:(t,e,r,n)=>e+r+n+(t/2**32|0)|0,add4L:(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0),add4H:(t,e,r,n,s)=>e+r+n+s+(t/2**32|0)|0,add5H:(t,e,r,n,s,i)=>e+r+n+s+i+(t/2**32|0)|0,add5L:(t,e,r,n,s)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(s>>>0)},Ze=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),$e=(t,e)=>t<<32-e|t>>>e;if(68!==new Uint8Array(new Uint32Array([287454020]).buffer)[0])throw new Error("Non little-endian hardware is not supported");function Ye(t){if("string"==typeof t&&(t=function(t){if("string"!=typeof t)throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array((new TextEncoder).encode(t))}(t)),!(t instanceof Uint8Array))throw new Error("expected Uint8Array, got "+typeof t);return t}class Xe{clone(){return this._cloneInto()}}function tr(t){const e=e=>t().update(Ye(e)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}const[er,rr,nr]=[[],[],[]],sr=BigInt(0),ir=BigInt(1),or=BigInt(2),ar=BigInt(7),cr=BigInt(256),lr=BigInt(113);for(let t=0,e=ir,r=1,n=0;t<24;t++){[r,n]=[n,(2*r+3*n)%5],er.push(2*(5*n+r)),rr.push((t+1)*(t+2)/2%64);let s=sr;for(let t=0;t<7;t++)e=(e<<ir^(e>>ar)*lr)%cr,e&or&&(s^=ir<<(ir<<BigInt(t))-ir);nr.push(s)}const[ur,hr]=Ve(nr,!0),fr=(t,e,r)=>r>32?_e(t,e,r):Ke(t,e,r),dr=(t,e,r)=>r>32?qe(t,e,r):Je(t,e,r);class pr extends Xe{constructor(t,e,r,n=!1,s=24){if(super(),this.blockLen=t,this.suffix=e,this.outputLen=r,this.enableXOF=n,this.rounds=s,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,Le(r),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");var i;this.state=new Uint8Array(200),this.state32=(i=this.state,new Uint32Array(i.buffer,i.byteOffset,Math.floor(i.byteLength/4)))}keccak(){!function(t,e=24){const r=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let e=0;e<10;e++)r[e]=t[e]^t[e+10]^t[e+20]^t[e+30]^t[e+40];for(let e=0;e<10;e+=2){const n=(e+8)%10,s=(e+2)%10,i=r[s],o=r[s+1],a=fr(i,o,1)^r[n],c=dr(i,o,1)^r[n+1];for(let r=0;r<50;r+=10)t[e+r]^=a,t[e+r+1]^=c}let e=t[2],s=t[3];for(let r=0;r<24;r++){const n=rr[r],i=fr(e,s,n),o=dr(e,s,n),a=er[r];e=t[a],s=t[a+1],t[a]=i,t[a+1]=o}for(let e=0;e<50;e+=10){for(let n=0;n<10;n++)r[n]=t[e+n];for(let n=0;n<10;n++)t[e+n]^=~r[(n+2)%10]&r[(n+4)%10]}t[0]^=ur[n],t[1]^=hr[n]}r.fill(0)}(this.state32,this.rounds),this.posOut=0,this.pos=0}update(t){Ge(this);const{blockLen:e,state:r}=this,n=(t=Ye(t)).length;for(let s=0;s<n;){const i=Math.min(e-this.pos,n-s);for(let e=0;e<i;e++)r[this.pos++]^=t[s++];this.pos===e&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:t,suffix:e,pos:r,blockLen:n}=this;t[r]^=e,128&e&&r===n-1&&this.keccak(),t[n-1]^=128,this.keccak()}writeInto(t){Ge(this,!1),Me(t),this.finish();const e=this.state,{blockLen:r}=this;for(let n=0,s=t.length;n<s;){this.posOut>=r&&this.keccak();const i=Math.min(r-this.posOut,s-n);t.set(e.subarray(this.posOut,this.posOut+i),n),this.posOut+=i,n+=i}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return Le(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(He(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(t){const{blockLen:e,suffix:r,outputLen:n,rounds:s,enableXOF:i}=this;return t||(t=new pr(e,r,n,i,s)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=s,t.suffix=r,t.outputLen=n,t.enableXOF=i,t.destroyed=this.destroyed,t}}const gr=((t,e,r)=>tr((()=>new pr(e,t,r))))(1,136,32);let yr=!1;const mr=function(t){return gr(t)};let wr=mr;function br(t){const e=Yt(t,"data");return ne(wr(e))}br._=mr,br.lock=function(){yr=!0},br.register=function(t){if(yr)throw new TypeError("keccak256 is locked");wr=t},Object.freeze(br);const Ar=BigInt(0),Er=BigInt(36);function vr(t){const e=(t=t.toLowerCase()).substring(2).split(""),r=new Uint8Array(40);for(let t=0;t<40;t++)r[t]=e[t].charCodeAt(0);const n=Yt(br(r));for(let t=0;t<40;t+=2)n[t>>1]>>4>=8&&(e[t]=e[t].toUpperCase()),(15&n[t>>1])>=8&&(e[t+1]=e[t+1].toUpperCase());return"0x"+e.join("")}const kr={};for(let t=0;t<10;t++)kr[String(t)]=String(t);for(let t=0;t<26;t++)kr[String.fromCharCode(65+t)]=String(10+t);const xr=function(){const t={};for(let e=0;e<36;e++)t["0123456789abcdefghijklmnopqrstuvwxyz"[e]]=BigInt(e);return t}();function Br(t){if(_t("string"==typeof t,"invalid address","address",t),t.match(/^(0x)?[0-9a-fA-F]{40}$/)){t.startsWith("0x")||(t="0x"+t);const e=vr(t);return _t(!t.match(/([A-F].*[a-f])|([a-f].*[A-F])/)||e===t,"bad address checksum","address",t),e}if(t.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){_t(t.substring(2,4)===function(t){let e=(t=(t=t.toUpperCase()).substring(4)+t.substring(0,2)+"00").split("").map((t=>kr[t])).join("");for(;e.length>=15;){let t=e.substring(0,15);e=parseInt(t,10)%97+e.substring(t.length)}let r=String(98-parseInt(e,10)%97);for(;r.length<2;)r="0"+r;return r}(t),"bad icap checksum","address",t);let e=function(t){t=t.toLowerCase();let e=Ar;for(let r=0;r<t.length;r++)e=e*Er+xr[t[r]];return e}(t.substring(4)).toString(16);for(;e.length<40;)e="0"+e;return vr("0x"+e)}_t(!1,"invalid address","address",t)}const Ir={};function Pr(t,e){let r=!1;return e<0&&(r=!0,e*=-1),new Rr(Ir,`${r?"":"u"}int${e}`,t,{signed:r,width:e})}function Nr(t,e){return new Rr(Ir,`bytes${e||""}`,t,{size:e})}const Cr=Symbol.for("_ethers_typed");class Rr{type;value;#u;_typedSymbol;constructor(t,e,r,n){null==n&&(n=null),Zt(Ir,t,"Typed"),Qt(this,{_typedSymbol:Cr,type:e,value:r}),this.#u=n,this.format()}format(){if("array"===this.type)throw new Error("");if("dynamicArray"===this.type)throw new Error("");return"tuple"===this.type?`tuple(${this.value.map((t=>t.format())).join(",")})`:this.type}defaultValue(){return 0}minValue(){return 0}maxValue(){return 0}isBigInt(){return!!this.type.match(/^u?int[0-9]+$/)}isData(){return this.type.startsWith("bytes")}isString(){return"string"===this.type}get tupleName(){if("tuple"!==this.type)throw TypeError("not a tuple");return this.#u}get arrayLength(){if("array"!==this.type)throw TypeError("not an array");return!0===this.#u?-1:!1===this.#u?this.value.length:null}static from(t,e){return new Rr(Ir,t,e)}static uint8(t){return Pr(t,8)}static uint16(t){return Pr(t,16)}static uint24(t){return Pr(t,24)}static uint32(t){return Pr(t,32)}static uint40(t){return Pr(t,40)}static uint48(t){return Pr(t,48)}static uint56(t){return Pr(t,56)}static uint64(t){return Pr(t,64)}static uint72(t){return Pr(t,72)}static uint80(t){return Pr(t,80)}static uint88(t){return Pr(t,88)}static uint96(t){return Pr(t,96)}static uint104(t){return Pr(t,104)}static uint112(t){return Pr(t,112)}static uint120(t){return Pr(t,120)}static uint128(t){return Pr(t,128)}static uint136(t){return Pr(t,136)}static uint144(t){return Pr(t,144)}static uint152(t){return Pr(t,152)}static uint160(t){return Pr(t,160)}static uint168(t){return Pr(t,168)}static uint176(t){return Pr(t,176)}static uint184(t){return Pr(t,184)}static uint192(t){return Pr(t,192)}static uint200(t){return Pr(t,200)}static uint208(t){return Pr(t,208)}static uint216(t){return Pr(t,216)}static uint224(t){return Pr(t,224)}static uint232(t){return Pr(t,232)}static uint240(t){return Pr(t,240)}static uint248(t){return Pr(t,248)}static uint256(t){return Pr(t,256)}static uint(t){return Pr(t,256)}static int8(t){return Pr(t,-8)}static int16(t){return Pr(t,-16)}static int24(t){return Pr(t,-24)}static int32(t){return Pr(t,-32)}static int40(t){return Pr(t,-40)}static int48(t){return Pr(t,-48)}static int56(t){return Pr(t,-56)}static int64(t){return Pr(t,-64)}static int72(t){return Pr(t,-72)}static int80(t){return Pr(t,-80)}static int88(t){return Pr(t,-88)}static int96(t){return Pr(t,-96)}static int104(t){return Pr(t,-104)}static int112(t){return Pr(t,-112)}static int120(t){return Pr(t,-120)}static int128(t){return Pr(t,-128)}static int136(t){return Pr(t,-136)}static int144(t){return Pr(t,-144)}static int152(t){return Pr(t,-152)}static int160(t){return Pr(t,-160)}static int168(t){return Pr(t,-168)}static int176(t){return Pr(t,-176)}static int184(t){return Pr(t,-184)}static int192(t){return Pr(t,-192)}static int200(t){return Pr(t,-200)}static int208(t){return Pr(t,-208)}static int216(t){return Pr(t,-216)}static int224(t){return Pr(t,-224)}static int232(t){return Pr(t,-232)}static int240(t){return Pr(t,-240)}static int248(t){return Pr(t,-248)}static int256(t){return Pr(t,-256)}static int(t){return Pr(t,-256)}static bytes1(t){return Nr(t,1)}static bytes2(t){return Nr(t,2)}static bytes3(t){return Nr(t,3)}static bytes4(t){return Nr(t,4)}static bytes5(t){return Nr(t,5)}static bytes6(t){return Nr(t,6)}static bytes7(t){return Nr(t,7)}static bytes8(t){return Nr(t,8)}static bytes9(t){return Nr(t,9)}static bytes10(t){return Nr(t,10)}static bytes11(t){return Nr(t,11)}static bytes12(t){return Nr(t,12)}static bytes13(t){return Nr(t,13)}static bytes14(t){return Nr(t,14)}static bytes15(t){return Nr(t,15)}static bytes16(t){return Nr(t,16)}static bytes17(t){return Nr(t,17)}static bytes18(t){return Nr(t,18)}static bytes19(t){return Nr(t,19)}static bytes20(t){return Nr(t,20)}static bytes21(t){return Nr(t,21)}static bytes22(t){return Nr(t,22)}static bytes23(t){return Nr(t,23)}static bytes24(t){return Nr(t,24)}static bytes25(t){return Nr(t,25)}static bytes26(t){return Nr(t,26)}static bytes27(t){return Nr(t,27)}static bytes28(t){return Nr(t,28)}static bytes29(t){return Nr(t,29)}static bytes30(t){return Nr(t,30)}static bytes31(t){return Nr(t,31)}static bytes32(t){return Nr(t,32)}static address(t){return new Rr(Ir,"address",t)}static bool(t){return new Rr(Ir,"bool",!!t)}static bytes(t){return new Rr(Ir,"bytes",t)}static string(t){return new Rr(Ir,"string",t)}static array(t,e){throw new Error("not implemented yet")}static tuple(t,e){throw new Error("not implemented yet")}static overrides(t){return new Rr(Ir,"overrides",Object.assign({},t))}static isTyped(t){return t&&"object"==typeof t&&"_typedSymbol"in t&&t._typedSymbol===Cr}static dereference(t,e){if(Rr.isTyped(t)){if(t.type!==e)throw new Error(`invalid type: expecetd ${e}, got ${t.type}`);return t.value}return t}}class Or extends Ue{constructor(t){super("address","address",t,!1)}defaultValue(){return"0x0000000000000000000000000000000000000000"}encode(t,e){let r=Rr.dereference(e,"string");try{r=Br(r)}catch(t){return this._throwError(t.message,e)}return t.writeValue(r)}decode(t){return Br(Ae(t.readValue(),20))}}class Sr extends Ue{coder;constructor(t){super(t.name,t.type,"_",t.dynamic),this.coder=t}defaultValue(){return this.coder.defaultValue()}encode(t,e){return this.coder.encode(t,e)}decode(t){return this.coder.decode(t)}}function Tr(t,e,r){let n=[];if(Array.isArray(r))n=r;else if(r&&"object"==typeof r){let t={};n=e.map((e=>{const n=e.localName;return Jt(n,"cannot encode object for signature with missing names","INVALID_ARGUMENT",{argument:"values",info:{coder:e},value:r}),Jt(!t[n],"cannot encode object for signature with duplicate names","INVALID_ARGUMENT",{argument:"values",info:{coder:e},value:r}),t[n]=!0,r[n]}))}else _t(!1,"invalid tuple value","tuple",r);_t(e.length===n.length,"types/value length mismatch","tuple",r);let s=new Fe,i=new Fe,o=[];e.forEach(((t,e)=>{let r=n[e];if(t.dynamic){let e=i.length;t.encode(i,r);let n=s.writeUpdatableValue();o.push((t=>{n(t+e)}))}else t.encode(s,r)})),o.forEach((t=>{t(s.length)}));let a=t.appendWriter(s);return a+=t.appendWriter(i),a}function Ur(t,e){let r=[],n=[],s=t.subReader(0);return e.forEach((e=>{let i=null;if(e.dynamic){let r=t.readIndex(),n=s.subReader(r);try{i=e.decode(n)}catch(t){if(zt(t,"BUFFER_OVERRUN"))throw t;i=t,i.baseType=e.name,i.name=e.localName,i.type=e.type}}else try{i=e.decode(t)}catch(t){if(zt(t,"BUFFER_OVERRUN"))throw t;i=t,i.baseType=e.name,i.name=e.localName,i.type=e.type}if(null==i)throw new Error("investigate");r.push(i),n.push(e.localName||null)})),Se.fromItems(r,n)}class Fr extends Ue{coder;length;constructor(t,e,r){super("array",t.type+"["+(e>=0?e:"")+"]",r,-1===e||t.dynamic),Qt(this,{coder:t,length:e})}defaultValue(){const t=this.coder.defaultValue(),e=[];for(let r=0;r<this.length;r++)e.push(t);return e}encode(t,e){const r=Rr.dereference(e,"array");Array.isArray(r)||this._throwError("expected array value",r);let n=this.length;-1===n&&(n=r.length,t.writeValue(r.length)),qt(r.length,n,"coder array"+(this.localName?" "+this.localName:""));let s=[];for(let t=0;t<r.length;t++)s.push(this.coder);return Tr(t,s,r)}decode(t){let e=this.length;-1===e&&(e=t.readIndex(),Jt(e*ke<=t.dataLength,"insufficient data length","BUFFER_OVERRUN",{buffer:t.bytes,offset:e*ke,length:t.dataLength}));let r=[];for(let t=0;t<e;t++)r.push(new Sr(this.coder));return Ur(t,r)}}class Dr extends Ue{constructor(t){super("bool","bool",t,!1)}defaultValue(){return!1}encode(t,e){const r=Rr.dereference(e,"bool");return t.writeValue(r?1:0)}decode(t){return!!t.readValue()}}class Lr extends Ue{constructor(t,e){super(t,t,e,!0)}defaultValue(){return"0x"}encode(t,e){e=Xt(e);let r=t.writeValue(e.length);return r+=t.writeBytes(e),r}decode(t){return t.readBytes(t.readIndex(),!0)}}class Mr extends Lr{constructor(t){super("bytes",t)}decode(t){return ne(super.decode(t))}}class Gr extends Ue{size;constructor(t,e){let r="bytes"+String(t);super(r,r,e,!1),Qt(this,{size:t},{size:"number"})}defaultValue(){return"0x0000000000000000000000000000000000000000000000000000000000000000".substring(0,2+2*this.size)}encode(t,e){let r=Xt(Rr.dereference(e,this.type));return r.length!==this.size&&this._throwError("incorrect data length",e),t.writeBytes(r)}decode(t){return ne(t.readBytes(this.size))}}const Hr=new Uint8Array([]);class Qr extends Ue{constructor(t){super("null","",t,!1)}defaultValue(){return null}encode(t,e){return null!=e&&this._throwError("not null",e),t.writeBytes(Hr)}decode(t){return t.readBytes(0),null}}const jr=BigInt(0),zr=BigInt(1),Vr=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");class Kr extends Ue{size;signed;constructor(t,e,r){const n=(e?"int":"uint")+8*t;super(n,n,r,!1),Qt(this,{size:t,signed:e},{size:"number",signed:"boolean"})}defaultValue(){return 0}encode(t,e){let r=ge(Rr.dereference(e,this.type)),n=pe(Vr,256);if(this.signed){let t=pe(n,8*this.size-1);(r>t||r<-(t+zr))&&this._throwError("value out-of-bounds",e),r=de(r,256)}else(r<jr||r>pe(n,8*this.size))&&this._throwError("value out-of-bounds",e);return t.writeValue(r)}decode(t){let e=pe(t.readValue(),8*this.size);return this.signed&&(e=fe(e,8*this.size)),e}}function Jr(t,e,r,n,s){if("BAD_PREFIX"===t||"UNEXPECTED_CONTINUE"===t){let t=0;for(let n=e+1;n<r.length&&r[n]>>6==2;n++)t++;return t}return"OVERRUN"===t?r.length-e-1:0}const _r=Object.freeze({error:function(t,e,r,n,s){_t(!1,`invalid codepoint at offset ${e}; ${t}`,"bytes",r)},ignore:Jr,replace:function(t,e,r,n,s){return"OVERLONG"===t?(_t("number"==typeof s,"invalid bad code point for replacement","badCodepoint",s),n.push(s),0):(n.push(65533),Jr(t,e,r))}});function qr(t,e){_t("string"==typeof t,"invalid string value","str",t),null!=e&&(function(t){Jt(Wt.indexOf(t)>=0,"platform missing String.prototype.normalize","UNSUPPORTED_OPERATION",{operation:"String.prototype.normalize",info:{form:t}})}(e),t=t.normalize(e));let r=[];for(let e=0;e<t.length;e++){const n=t.charCodeAt(e);if(n<128)r.push(n);else if(n<2048)r.push(n>>6|192),r.push(63&n|128);else if(55296==(64512&n)){e++;const s=t.charCodeAt(e);_t(e<t.length&&56320==(64512&s),"invalid surrogate pair","str",t);const i=65536+((1023&n)<<10)+(1023&s);r.push(i>>18|240),r.push(i>>12&63|128),r.push(i>>6&63|128),r.push(63&i|128)}else r.push(n>>12|224),r.push(n>>6&63|128),r.push(63&n|128)}return new Uint8Array(r)}function Wr(t,e){return function(t,e){null==e&&(e=_r.error);const r=Yt(t,"bytes"),n=[];let s=0;for(;s<r.length;){const t=r[s++];if(!(t>>7)){n.push(t);continue}let i=null,o=null;if(192==(224&t))i=1,o=127;else if(224==(240&t))i=2,o=2047;else{if(240!=(248&t)){s+=e(128==(192&t)?"UNEXPECTED_CONTINUE":"BAD_PREFIX",s-1,r,n);continue}i=3,o=65535}if(s-1+i>=r.length){s+=e("OVERRUN",s-1,r,n);continue}let a=t&(1<<8-i-1)-1;for(let t=0;t<i;t++){let t=r[s];if(128!=(192&t)){s+=e("MISSING_CONTINUE",s,r,n),a=null;break}a=a<<6|63&t,s++}null!==a&&(a>1114111?s+=e("OUT_OF_RANGE",s-1-i,r,n,a):a>=55296&&a<=57343?s+=e("UTF16_SURROGATE",s-1-i,r,n,a):a<=o?s+=e("OVERLONG",s-1-i,r,n,a):n.push(a))}return n}(t,e).map((t=>t<=65535?String.fromCharCode(t):(t-=65536,String.fromCharCode(55296+(t>>10&1023),56320+(1023&t))))).join("")}class Zr extends Lr{constructor(t){super("string",t)}defaultValue(){return""}encode(t,e){return super.encode(t,qr(Rr.dereference(e,"string")))}decode(t){return Wr(super.decode(t))}}class $r extends Ue{coders;constructor(t,e){let r=!1;const n=[];t.forEach((t=>{t.dynamic&&(r=!0),n.push(t.type)})),super("tuple","tuple("+n.join(",")+")",e,r),Qt(this,{coders:Object.freeze(t.slice())})}defaultValue(){const t=[];this.coders.forEach((e=>{t.push(e.defaultValue())}));const e=this.coders.reduce(((t,e)=>{const r=e.localName;return r&&(t[r]||(t[r]=0),t[r]++),t}),{});return this.coders.forEach(((r,n)=>{let s=r.localName;s&&1===e[s]&&("length"===s&&(s="_length"),null==t[s]&&(t[s]=t[n]))})),Object.freeze(t)}encode(t,e){const r=Rr.dereference(e,"tuple");return Tr(t,this.coders,r)}decode(t){return Ur(t,this.coders)}}function Yr(t){return br(qr(t))}function Xr(t){const e=new Set;return t.forEach((t=>e.add(t))),Object.freeze(e)}const tn=Xr("external public payable override".split(" ")),en="constant external internal payable private public pure view override",rn=Xr(en.split(" ")),nn="constructor error event fallback function receive struct",sn=Xr(nn.split(" ")),on="calldata memory storage payable indexed",an=Xr(on.split(" ")),cn=Xr([nn,on,"tuple returns",en].join(" ").split(" ")),ln={"(":"OPEN_PAREN",")":"CLOSE_PAREN","[":"OPEN_BRACKET","]":"CLOSE_BRACKET",",":"COMMA","@":"AT"},un=new RegExp("^(\\s*)"),hn=new RegExp("^([0-9]+)"),fn=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)"),dn=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)$"),pn=new RegExp("^(address|bool|bytes([0-9]*)|string|u?int([0-9]*))$");class gn{#s;#h;get offset(){return this.#s}get length(){return this.#h.length-this.#s}constructor(t){this.#s=0,this.#h=t.slice()}clone(){return new gn(this.#h)}reset(){this.#s=0}#f(t=0,e=0){return new gn(this.#h.slice(t,e).map((e=>Object.freeze(Object.assign({},e,{match:e.match-t,linkBack:e.linkBack-t,linkNext:e.linkNext-t})))))}popKeyword(t){const e=this.peek();if("KEYWORD"!==e.type||!t.has(e.text))throw new Error(`expected keyword ${e.text}`);return this.pop().text}popType(t){if(this.peek().type!==t){const e=this.peek();throw new Error(`expected ${t}; got ${e.type} ${JSON.stringify(e.text)}`)}return this.pop().text}popParen(){const t=this.peek();if("OPEN_PAREN"!==t.type)throw new Error("bad start");const e=this.#f(this.#s+1,t.match+1);return this.#s=t.match+1,e}popParams(){const t=this.peek();if("OPEN_PAREN"!==t.type)throw new Error("bad start");const e=[];for(;this.#s<t.match-1;){const t=this.peek().linkNext;e.push(this.#f(this.#s+1,t)),this.#s=t}return this.#s=t.match+1,e}peek(){if(this.#s>=this.#h.length)throw new Error("out-of-bounds");return this.#h[this.#s]}peekKeyword(t){const e=this.peekType("KEYWORD");return null!=e&&t.has(e)?e:null}peekType(t){if(0===this.length)return null;const e=this.peek();return e.type===t?e.text:null}pop(){const t=this.peek();return this.#s++,t}toString(){const t=[];for(let e=this.#s;e<this.#h.length;e++){const r=this.#h[e];t.push(`${r.type}:${r.text}`)}return`<TokenString ${t.join(" ")}>`}}function yn(t){const e=[],r=e=>{const r=i<t.length?JSON.stringify(t[i]):"$EOI";throw new Error(`invalid token ${r} at ${i}: ${e}`)};let n=[],s=[],i=0;for(;i<t.length;){let o=t.substring(i),a=o.match(un);a&&(i+=a[1].length,o=t.substring(i));const c={depth:n.length,linkBack:-1,linkNext:-1,match:-1,type:"",text:"",offset:i,value:-1};e.push(c);let l=ln[o[0]]||"";if(l){if(c.type=l,c.text=o[0],i++,"OPEN_PAREN"===l)n.push(e.length-1),s.push(e.length-1);else if("CLOSE_PAREN"==l)0===n.length&&r("no matching open bracket"),c.match=n.pop(),e[c.match].match=e.length-1,c.depth--,c.linkBack=s.pop(),e[c.linkBack].linkNext=e.length-1;else if("COMMA"===l)c.linkBack=s.pop(),e[c.linkBack].linkNext=e.length-1,s.push(e.length-1);else if("OPEN_BRACKET"===l)c.type="BRACKET";else if("CLOSE_BRACKET"===l){let t=e.pop().text;if(e.length>0&&"NUMBER"===e[e.length-1].type){const r=e.pop().text;t=r+t,e[e.length-1].value=be(r)}if(0===e.length||"BRACKET"!==e[e.length-1].type)throw new Error("missing opening bracket");e[e.length-1].text+=t}}else if(a=o.match(fn),a){if(c.text=a[1],i+=c.text.length,cn.has(c.text)){c.type="KEYWORD";continue}if(c.text.match(pn)){c.type="TYPE";continue}c.type="ID"}else{if(a=o.match(hn),!a)throw new Error(`unexpected token ${JSON.stringify(o[0])} at position ${i}`);c.text=a[1],c.type="NUMBER",i+=c.text.length}}return new gn(e.map((t=>Object.freeze(t))))}function mn(t,e){let r=[];for(const n in e.keys())t.has(n)&&r.push(n);if(r.length>1)throw new Error(`conflicting types: ${r.join(", ")}`)}function wn(t,e){if(e.peekKeyword(sn)){const r=e.pop().text;if(r!==t)throw new Error(`expected ${t}, got ${r}`)}return e.popType("ID")}function bn(t,e){const r=new Set;for(;;){const n=t.peekType("KEYWORD");if(null==n||e&&!e.has(n))break;if(t.pop(),r.has(n))throw new Error(`duplicate keywords: ${JSON.stringify(n)}`);r.add(n)}return Object.freeze(r)}function An(t){let e=bn(t,rn);return mn(e,Xr("constant payable nonpayable".split(" "))),mn(e,Xr("pure view payable nonpayable".split(" "))),e.has("view")?"view":e.has("pure")?"pure":e.has("payable")?"payable":e.has("nonpayable")?"nonpayable":e.has("constant")?"view":"nonpayable"}function En(t,e){return t.popParams().map((t=>Fn.from(t,e)))}function vn(t){if(t.peekType("AT")){if(t.pop(),t.peekType("NUMBER"))return ge(t.pop().text);throw new Error("invalid gas")}return null}function kn(t){if(t.length)throw new Error(`unexpected tokens at offset ${t.offset}: ${t.toString()}`)}const xn=new RegExp(/^(.*)\[([0-9]*)\]$/);function Bn(t){const e=t.match(pn);if(_t(e,"invalid type","type",t),"uint"===t)return"uint256";if("int"===t)return"int256";if(e[2]){const r=parseInt(e[2]);_t(0!==r&&r<=32,"invalid bytes length","type",t)}else if(e[3]){const r=parseInt(e[3]);_t(0!==r&&r<=256&&r%8==0,"invalid numeric width","type",t)}return t}const In={},Pn=Symbol.for("_ethers_internal"),Nn="_ParamTypeInternal",Cn="_ErrorInternal",Rn="_EventInternal",On="_ConstructorInternal",Sn="_FallbackInternal",Tn="_FunctionInternal",Un="_StructInternal";class Fn{name;type;baseType;indexed;components;arrayLength;arrayChildren;constructor(t,e,r,n,s,i,o,a){if(Zt(t,In,"ParamType"),Object.defineProperty(this,Pn,{value:Nn}),i&&(i=Object.freeze(i.slice())),"array"===n){if(null==o||null==a)throw new Error("")}else if(null!=o||null!=a)throw new Error("");if("tuple"===n){if(null==i)throw new Error("")}else if(null!=i)throw new Error("");Qt(this,{name:e,type:r,baseType:n,indexed:s,components:i,arrayLength:o,arrayChildren:a})}format(t){if(null==t&&(t="sighash"),"json"===t){const e=this.name||"";if(this.isArray()){const t=JSON.parse(this.arrayChildren.format("json"));return t.name=e,t.type+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`,JSON.stringify(t)}const r={type:"tuple"===this.baseType?"tuple":this.type,name:e};return"boolean"==typeof this.indexed&&(r.indexed=this.indexed),this.isTuple()&&(r.components=this.components.map((e=>JSON.parse(e.format(t))))),JSON.stringify(r)}let e="";return this.isArray()?(e+=this.arrayChildren.format(t),e+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`):this.isTuple()?e+="("+this.components.map((e=>e.format(t))).join("full"===t?", ":",")+")":e+=this.type,"sighash"!==t&&(!0===this.indexed&&(e+=" indexed"),"full"===t&&this.name&&(e+=" "+this.name)),e}isArray(){return"array"===this.baseType}isTuple(){return"tuple"===this.baseType}isIndexable(){return null!=this.indexed}walk(t,e){if(this.isArray()){if(!Array.isArray(t))throw new Error("invalid array value");if(-1!==this.arrayLength&&t.length!==this.arrayLength)throw new Error("array is wrong length");const r=this;return t.map((t=>r.arrayChildren.walk(t,e)))}if(this.isTuple()){if(!Array.isArray(t))throw new Error("invalid tuple value");if(t.length!==this.components.length)throw new Error("array is wrong length");const r=this;return t.map(((t,n)=>r.components[n].walk(t,e)))}return e(this.type,t)}#d(t,e,r,n){if(this.isArray()){if(!Array.isArray(e))throw new Error("invalid array value");if(-1!==this.arrayLength&&e.length!==this.arrayLength)throw new Error("array is wrong length");const s=this.arrayChildren,i=e.slice();return i.forEach(((e,n)=>{s.#d(t,e,r,(t=>{i[n]=t}))})),void n(i)}if(this.isTuple()){const s=this.components;let i;if(Array.isArray(e))i=e.slice();else{if(null==e||"object"!=typeof e)throw new Error("invalid tuple value");i=s.map((t=>{if(!t.name)throw new Error("cannot use object value with unnamed components");if(!(t.name in e))throw new Error(`missing value for component ${t.name}`);return e[t.name]}))}if(i.length!==this.components.length)throw new Error("array is wrong length");return i.forEach(((e,n)=>{s[n].#d(t,e,r,(t=>{i[n]=t}))})),void n(i)}const s=r(this.type,e);s.then?t.push(async function(){n(await s)}()):n(s)}async walkAsync(t,e){const r=[],n=[t];return this.#d(r,t,e,(t=>{n[0]=t})),r.length&&await Promise.all(r),n[0]}static from(t,e){if(Fn.isParamType(t))return t;if("string"==typeof t)try{return Fn.from(yn(t),e)}catch(e){_t(!1,"invalid param type","obj",t)}else if(t instanceof gn){let r="",n="",s=null;bn(t,Xr(["tuple"])).has("tuple")||t.peekType("OPEN_PAREN")?(n="tuple",s=t.popParams().map((t=>Fn.from(t))),r=`tuple(${s.map((t=>t.format())).join(",")})`):(r=Bn(t.popType("TYPE")),n=r);let i=null,o=null;for(;t.length&&t.peekType("BRACKET");){const e=t.pop();i=new Fn(In,"",r,n,null,s,o,i),o=e.value,r+=e.text,n="array",s=null}let a=null;if(bn(t,an).has("indexed")){if(!e)throw new Error("");a=!0}const c=t.peekType("ID")?t.pop().text:"";if(t.length)throw new Error("leftover tokens");return new Fn(In,c,r,n,a,s,o,i)}const r=t.name;_t(!r||"string"==typeof r&&r.match(dn),"invalid name","obj.name",r);let n=t.indexed;null!=n&&(_t(e,"parameter cannot be indexed","obj.indexed",t.indexed),n=!!n);let s=t.type,i=s.match(xn);if(i){const e=parseInt(i[2]||"-1"),o=Fn.from({type:i[1],components:t.components});return new Fn(In,r||"",s,"array",n,null,e,o)}if("tuple"===s||s.startsWith("tuple(")||s.startsWith("(")){const e=null!=t.components?t.components.map((t=>Fn.from(t))):null;return new Fn(In,r||"",s,"tuple",n,e,null,null)}return s=Bn(t.type),new Fn(In,r||"",s,s,n,null,null,null)}static isParamType(t){return t&&t[Pn]===Nn}}class Dn{type;inputs;constructor(t,e,r){Zt(t,In,"Fragment"),Qt(this,{type:e,inputs:r=Object.freeze(r.slice())})}static from(t){if("string"==typeof t){try{Dn.from(JSON.parse(t))}catch(t){}return Dn.from(yn(t))}if(t instanceof gn)switch(t.peekKeyword(sn)){case"constructor":return Qn.from(t);case"error":return Gn.from(t);case"event":return Hn.from(t);case"fallback":case"receive":return jn.from(t);case"function":return zn.from(t);case"struct":return Vn.from(t)}else if("object"==typeof t){switch(t.type){case"constructor":return Qn.from(t);case"error":return Gn.from(t);case"event":return Hn.from(t);case"fallback":case"receive":return jn.from(t);case"function":return zn.from(t);case"struct":return Vn.from(t)}Jt(!1,`unsupported type: ${t.type}`,"UNSUPPORTED_OPERATION",{operation:"Fragment.from"})}_t(!1,"unsupported frgament object","obj",t)}static isConstructor(t){return Qn.isFragment(t)}static isError(t){return Gn.isFragment(t)}static isEvent(t){return Hn.isFragment(t)}static isFunction(t){return zn.isFragment(t)}static isStruct(t){return Vn.isFragment(t)}}class Ln extends Dn{name;constructor(t,e,r,n){super(t,e,n),_t("string"==typeof r&&r.match(dn),"invalid identifier","name",r),n=Object.freeze(n.slice()),Qt(this,{name:r})}}function Mn(t,e){return"("+e.map((e=>e.format(t))).join("full"===t?", ":",")+")"}class Gn extends Ln{constructor(t,e,r){super(t,"error",e,r),Object.defineProperty(this,Pn,{value:Cn})}get selector(){return Yr(this.format("sighash")).substring(0,10)}format(t){if(null==t&&(t="sighash"),"json"===t)return JSON.stringify({type:"error",name:this.name,inputs:this.inputs.map((e=>JSON.parse(e.format(t))))});const e=[];return"sighash"!==t&&e.push("error"),e.push(this.name+Mn(t,this.inputs)),e.join(" ")}static from(t){if(Gn.isFragment(t))return t;if("string"==typeof t)return Gn.from(yn(t));if(t instanceof gn){const e=wn("error",t),r=En(t);return kn(t),new Gn(In,e,r)}return new Gn(In,t.name,t.inputs?t.inputs.map(Fn.from):[])}static isFragment(t){return t&&t[Pn]===Cn}}class Hn extends Ln{anonymous;constructor(t,e,r,n){super(t,"event",e,r),Object.defineProperty(this,Pn,{value:Rn}),Qt(this,{anonymous:n})}get topicHash(){return Yr(this.format("sighash"))}format(t){if(null==t&&(t="sighash"),"json"===t)return JSON.stringify({type:"event",anonymous:this.anonymous,name:this.name,inputs:this.inputs.map((e=>JSON.parse(e.format(t))))});const e=[];return"sighash"!==t&&e.push("event"),e.push(this.name+Mn(t,this.inputs)),"sighash"!==t&&this.anonymous&&e.push("anonymous"),e.join(" ")}static getTopicHash(t,e){return e=(e||[]).map((t=>Fn.from(t))),new Hn(In,t,e,!1).topicHash}static from(t){if(Hn.isFragment(t))return t;if("string"==typeof t)try{return Hn.from(yn(t))}catch(e){_t(!1,"invalid event fragment","obj",t)}else if(t instanceof gn){const e=wn("event",t),r=En(t,!0),n=!!bn(t,Xr(["anonymous"])).has("anonymous");return kn(t),new Hn(In,e,r,n)}return new Hn(In,t.name,t.inputs?t.inputs.map((t=>Fn.from(t,!0))):[],!!t.anonymous)}static isFragment(t){return t&&t[Pn]===Rn}}class Qn extends Dn{payable;gas;constructor(t,e,r,n,s){super(t,e,r),Object.defineProperty(this,Pn,{value:On}),Qt(this,{payable:n,gas:s})}format(t){if(Jt(null!=t&&"sighash"!==t,"cannot format a constructor for sighash","UNSUPPORTED_OPERATION",{operation:"format(sighash)"}),"json"===t)return JSON.stringify({type:"constructor",stateMutability:this.payable?"payable":"undefined",payable:this.payable,gas:null!=this.gas?this.gas:void 0,inputs:this.inputs.map((e=>JSON.parse(e.format(t))))});const e=[`constructor${Mn(t,this.inputs)}`];return this.payable&&e.push("payable"),null!=this.gas&&e.push(`@${this.gas.toString()}`),e.join(" ")}static from(t){if(Qn.isFragment(t))return t;if("string"==typeof t)try{return Qn.from(yn(t))}catch(e){_t(!1,"invalid constuctor fragment","obj",t)}else if(t instanceof gn){bn(t,Xr(["constructor"]));const e=En(t),r=!!bn(t,tn).has("payable"),n=vn(t);return kn(t),new Qn(In,"constructor",e,r,n)}return new Qn(In,"constructor",t.inputs?t.inputs.map(Fn.from):[],!!t.payable,null!=t.gas?t.gas:null)}static isFragment(t){return t&&t[Pn]===On}}class jn extends Dn{payable;constructor(t,e,r){super(t,"fallback",e),Object.defineProperty(this,Pn,{value:Sn}),Qt(this,{payable:r})}format(t){const e=0===this.inputs.length?"receive":"fallback";if("json"===t){const t=this.payable?"payable":"nonpayable";return JSON.stringify({type:e,stateMutability:t})}return`${e}()${this.payable?" payable":""}`}static from(t){if(jn.isFragment(t))return t;if("string"==typeof t)try{return jn.from(yn(t))}catch(e){_t(!1,"invalid fallback fragment","obj",t)}else if(t instanceof gn){const e=t.toString();if(_t(t.peekKeyword(Xr(["fallback","receive"])),"type must be fallback or receive","obj",e),"receive"===t.popKeyword(Xr(["fallback","receive"]))){const e=En(t);return _t(0===e.length,"receive cannot have arguments","obj.inputs",e),bn(t,Xr(["payable"])),kn(t),new jn(In,[],!0)}let r=En(t);r.length?_t(1===r.length&&"bytes"===r[0].type,"invalid fallback inputs","obj.inputs",r.map((t=>t.format("minimal"))).join(", ")):r=[Fn.from("bytes")];const n=An(t);if(_t("nonpayable"===n||"payable"===n,"fallback cannot be constants","obj.stateMutability",n),bn(t,Xr(["returns"])).has("returns")){const e=En(t);_t(1===e.length&&"bytes"===e[0].type,"invalid fallback outputs","obj.outputs",e.map((t=>t.format("minimal"))).join(", "))}return kn(t),new jn(In,r,"payable"===n)}if("receive"===t.type)return new jn(In,[],!0);if("fallback"===t.type){const e=[Fn.from("bytes")],r="payable"===t.stateMutability;return new jn(In,e,r)}_t(!1,"invalid fallback description","obj",t)}static isFragment(t){return t&&t[Pn]===Sn}}class zn extends Ln{constant;outputs;stateMutability;payable;gas;constructor(t,e,r,n,s,i){super(t,"function",e,n),Object.defineProperty(this,Pn,{value:Tn}),Qt(this,{constant:"view"===r||"pure"===r,gas:i,outputs:s=Object.freeze(s.slice()),payable:"payable"===r,stateMutability:r})}get selector(){return Yr(this.format("sighash")).substring(0,10)}format(t){if(null==t&&(t="sighash"),"json"===t)return JSON.stringify({type:"function",name:this.name,constant:this.constant,stateMutability:"nonpayable"!==this.stateMutability?this.stateMutability:void 0,payable:this.payable,gas:null!=this.gas?this.gas:void 0,inputs:this.inputs.map((e=>JSON.parse(e.format(t)))),outputs:this.outputs.map((e=>JSON.parse(e.format(t))))});const e=[];return"sighash"!==t&&e.push("function"),e.push(this.name+Mn(t,this.inputs)),"sighash"!==t&&("nonpayable"!==this.stateMutability&&e.push(this.stateMutability),this.outputs&&this.outputs.length&&(e.push("returns"),e.push(Mn(t,this.outputs))),null!=this.gas&&e.push(`@${this.gas.toString()}`)),e.join(" ")}static getSelector(t,e){return e=(e||[]).map((t=>Fn.from(t))),new zn(In,t,"view",e,[],null).selector}static from(t){if(zn.isFragment(t))return t;if("string"==typeof t)try{return zn.from(yn(t))}catch(e){_t(!1,"invalid function fragment","obj",t)}else if(t instanceof gn){const e=wn("function",t),r=En(t),n=An(t);let s=[];bn(t,Xr(["returns"])).has("returns")&&(s=En(t));const i=vn(t);return kn(t),new zn(In,e,n,r,s,i)}let e=t.stateMutability;return null==e&&(e="payable","boolean"==typeof t.constant?(e="view",t.constant||(e="payable","boolean"!=typeof t.payable||t.payable||(e="nonpayable"))):"boolean"!=typeof t.payable||t.payable||(e="nonpayable")),new zn(In,t.name,e,t.inputs?t.inputs.map(Fn.from):[],t.outputs?t.outputs.map(Fn.from):[],null!=t.gas?t.gas:null)}static isFragment(t){return t&&t[Pn]===Tn}}class Vn extends Ln{constructor(t,e,r){super(t,"struct",e,r),Object.defineProperty(this,Pn,{value:Un})}format(){throw new Error("@TODO")}static from(t){if("string"==typeof t)try{return Vn.from(yn(t))}catch(e){_t(!1,"invalid struct fragment","obj",t)}else if(t instanceof gn){const e=wn("struct",t),r=En(t);return kn(t),new Vn(In,e,r)}return new Vn(In,t.name,t.inputs?t.inputs.map(Fn.from):[])}static isFragment(t){return t&&t[Pn]===Un}}const Kn=new Map;Kn.set(0,"GENERIC_PANIC"),Kn.set(1,"ASSERT_FALSE"),Kn.set(17,"OVERFLOW"),Kn.set(18,"DIVIDE_BY_ZERO"),Kn.set(33,"ENUM_RANGE_ERROR"),Kn.set(34,"BAD_STORAGE_DATA"),Kn.set(49,"STACK_UNDERFLOW"),Kn.set(50,"ARRAY_RANGE_ERROR"),Kn.set(65,"OUT_OF_MEMORY"),Kn.set(81,"UNINITIALIZED_FUNCTION_CALL");const Jn=new RegExp(/^bytes([0-9]*)$/),_n=new RegExp(/^(u?int)([0-9]*)$/);let qn=null,Wn=1024;class Zn{#p(t){if(t.isArray())return new Fr(this.#p(t.arrayChildren),t.arrayLength,t.name);if(t.isTuple())return new $r(t.components.map((t=>this.#p(t))),t.name);switch(t.baseType){case"address":return new Or(t.name);case"bool":return new Dr(t.name);case"string":return new Zr(t.name);case"bytes":return new Mr(t.name);case"":return new Qr(t.name)}let e=t.type.match(_n);if(e){let r=parseInt(e[2]||"256");return _t(0!==r&&r<=256&&r%8==0,"invalid "+e[1]+" bit length","param",t),new Kr(r/8,"int"===e[1],t.name)}if(e=t.type.match(Jn),e){let r=parseInt(e[1]);return _t(0!==r&&r<=32,"invalid bytes length","param",t),new Gr(r,t.name)}_t(!1,"invalid type","type",t.type)}getDefaultValue(t){const e=t.map((t=>this.#p(Fn.from(t))));return new $r(e,"_").defaultValue()}encode(t,e){qt(e.length,t.length,"types/values length mismatch");const r=t.map((t=>this.#p(Fn.from(t)))),n=new $r(r,"_"),s=new Fe;return n.encode(s,e),s.data}decode(t,e,r){const n=t.map((t=>this.#p(Fn.from(t))));return new $r(n,"_").decode(new De(e,r,Wn))}static _setDefaultMaxInflation(t){_t("number"==typeof t&&Number.isInteger(t),"invalid defaultMaxInflation factor","value",t),Wn=t}static defaultAbiCoder(){return null==qn&&(qn=new Zn),qn}static getBuiltinCallException(t,e,r){return function(t,e,r,n){let s="missing revert data",i=null,o=null;if(r){s="execution reverted";const t=Yt(r);if(r=ne(r),0===t.length)s+=" (no data present; likely require(false) occurred",i="require(false)";else if(t.length%32!=4)s+=" (could not decode reason; invalid data length)";else if("0x08c379a0"===ne(t.slice(0,4)))try{i=n.decode(["string"],t.slice(4))[0],o={signature:"Error(string)",name:"Error",args:[i]},s+=`: ${JSON.stringify(i)}`}catch(t){s+=" (could not decode reason; invalid string data)"}else if("0x4e487b71"===ne(t.slice(0,4)))try{const e=Number(n.decode(["uint256"],t.slice(4))[0]);o={signature:"Panic(uint256)",name:"Panic",args:[e]},i=`Panic due to ${Kn.get(e)||"UNKNOWN"}(${e})`,s+=`: ${i}`}catch(t){s+=" (could not decode panic code)"}else s+=" (unknown custom error)"}const a={to:e.to?Br(e.to):null,data:e.data||"0x"};return e.from&&(a.from=Br(e.from)),Kt(s,"CALL_EXCEPTION",{action:t,data:r,reason:i,transaction:a,invocation:null,revert:o})}(t,e,r,Zn.defaultAbiCoder())}}function $n(t){return t&&"function"==typeof t.getAddress}async function Yn(t,e){const r=await e;return null!=r&&"0x0000000000000000000000000000000000000000"!==r||(Jt("string"!=typeof t,"unconfigured name","UNCONFIGURED_NAME",{value:t}),_t(!1,"invalid AddressLike value; did not resolve to a value address","target",t)),Br(r)}function Xn(t,e){return"string"==typeof t?t.match(/^0x[0-9a-f]{40}$/i)?Br(t):(Jt(null!=e,"ENS resolution requires a provider","UNSUPPORTED_OPERATION",{operation:"resolveName"}),Yn(t,e.resolveName(t))):$n(t)?Yn(t,t.getAddress()):t&&"function"==typeof t.then?Yn(t,t):void _t(!1,"unsupported addressable value","target",t)}const ts=new Uint8Array(32);ts.fill(0);const es=BigInt(-1),rs=BigInt(0),ns=BigInt(1),ss=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),is=Ae(ns,32),os=Ae(rs,32),as={name:"string",version:"string",chainId:"uint256",verifyingContract:"address",salt:"bytes32"},cs=["name","version","chainId","verifyingContract","salt"];function ls(t){return function(e){return _t("string"==typeof e,`invalid domain value for ${JSON.stringify(t)}`,`domain.${t}`,e),e}}const us={name:ls("name"),version:ls("version"),chainId:function(t){const e=ge(t,"domain.chainId");return _t(e>=0,"invalid chain ID","domain.chainId",t),Number.isSafeInteger(e)?Number(e):ve(e)},verifyingContract:function(t){try{return Br(t).toLowerCase()}catch(t){}_t(!1,'invalid domain value "verifyingContract"',"domain.verifyingContract",t)},salt:function(t){const e=Yt(t,"domain.salt");return _t(32===e.length,'invalid domain value "salt"',"domain.salt",t),ne(e)}};function hs(t){{const e=t.match(/^(u?)int(\d+)$/);if(e){const r=""===e[1],n=parseInt(e[2]);_t(n%8==0&&0!==n&&n<=256&&e[2]===String(n),"invalid numeric width","type",t);const s=pe(ss,r?n-1:n),i=r?(s+ns)*es:rs;return function(e){const n=ge(e,"value");return _t(n>=i&&n<=s,`value out-of-bounds for ${t}`,"value",n),Ae(r?de(n,256):n,32)}}}{const e=t.match(/^bytes(\d+)$/);if(e){const r=parseInt(e[1]);return _t(0!==r&&r<=32&&e[1]===String(r),"invalid bytes width","type",t),function(e){return _t(Yt(e).length===r,`invalid length for ${t}`,"value",e),function(t){const e=Yt(t),r=e.length%32;return r?se([e,ts.slice(r)]):ne(e)}(e)}}}switch(t){case"address":return function(t){return ce(Br(t),32)};case"bool":return function(t){return t?is:os};case"bytes":return function(t){return br(t)};case"string":return function(t){return Yr(t)}}return null}function fs(t,e){return`${t}(${e.map((({name:t,type:e})=>e+" "+t)).join(",")})`}function ds(t){const e=t.match(/^([^\x5b]*)((\x5b\d*\x5d)*)(\x5b(\d*)\x5d)$/);return e?{base:e[1],index:e[2]+e[4],array:{base:e[1],prefix:e[1]+e[2],count:e[5]?parseInt(e[5]):-1}}:{base:t}}class ps{primaryType;#g;get types(){return JSON.parse(this.#g)}#y;#m;constructor(t){this.#y=new Map,this.#m=new Map;const e=new Map,r=new Map,n=new Map,s={};Object.keys(t).forEach((i=>{s[i]=t[i].map((({name:e,type:r})=>{let{base:n,index:s}=ds(r);return"int"!==n||t.int||(n="int256"),"uint"!==n||t.uint||(n="uint256"),{name:e,type:n+(s||"")}})),e.set(i,new Set),r.set(i,[]),n.set(i,new Set)})),this.#g=JSON.stringify(s);for(const n in s){const i=new Set;for(const o of s[n]){_t(!i.has(o.name),`duplicate variable name ${JSON.stringify(o.name)} in ${JSON.stringify(n)}`,"types",t),i.add(o.name);const s=ds(o.type).base;_t(s!==n,`circular type reference to ${JSON.stringify(s)}`,"types",t),hs(s)||(_t(r.has(s),`unknown type ${JSON.stringify(s)}`,"types",t),r.get(s).push(n),e.get(n).add(s))}}const i=Array.from(r.keys()).filter((t=>0===r.get(t).length));_t(0!==i.length,"missing primary type","types",t),_t(1===i.length,`ambiguous primary types or unused types: ${i.map((t=>JSON.stringify(t))).join(", ")}`,"types",t),Qt(this,{primaryType:i[0]}),function s(i,o){_t(!o.has(i),`circular type reference to ${JSON.stringify(i)}`,"types",t),o.add(i);for(const t of e.get(i))if(r.has(t)){s(t,o);for(const e of o)n.get(e).add(t)}o.delete(i)}(this.primaryType,new Set);for(const[t,e]of n){const r=Array.from(e);r.sort(),this.#y.set(t,fs(t,s[t])+r.map((t=>fs(t,s[t]))).join(""))}}getEncoder(t){let e=this.#m.get(t);return e||(e=this.#w(t),this.#m.set(t,e)),e}#w(t){{const e=hs(t);if(e)return e}const e=ds(t).array;if(e){const t=e.prefix,r=this.getEncoder(t);return n=>{_t(-1===e.count||e.count===n.length,`array length mismatch; expected length ${e.count}`,"value",n);let s=n.map(r);return this.#y.has(t)&&(s=s.map(br)),br(se(s))}}const r=this.types[t];if(r){const e=Yr(this.#y.get(t));return t=>{const n=r.map((({name:e,type:r})=>{const n=this.getEncoder(r)(t[e]);return this.#y.has(r)?br(n):n}));return n.unshift(e),se(n)}}_t(!1,`unknown type: ${t}`,"type",t)}encodeType(t){const e=this.#y.get(t);return _t(e,`unknown type: ${JSON.stringify(t)}`,"name",t),e}encodeData(t,e){return this.getEncoder(t)(e)}hashStruct(t,e){return br(this.encodeData(t,e))}encode(t){return this.encodeData(this.primaryType,t)}hash(t){return this.hashStruct(this.primaryType,t)}_visit(t,e,r){if(hs(t))return r(t,e);const n=ds(t).array;if(n)return _t(-1===n.count||n.count===e.length,`array length mismatch; expected length ${n.count}`,"value",e),e.map((t=>this._visit(n.prefix,t,r)));const s=this.types[t];if(s)return s.reduce(((t,{name:n,type:s})=>(t[n]=this._visit(s,e[n],r),t)),{});_t(!1,`unknown type: ${t}`,"type",t)}visit(t,e){return this._visit(this.primaryType,t,e)}static from(t){return new ps(t)}static getPrimaryType(t){return ps.from(t).primaryType}static hashStruct(t,e,r){return ps.from(e).hashStruct(t,r)}static hashDomain(t){const e=[];for(const r in t){if(null==t[r])continue;const n=as[r];_t(n,`invalid typed-data domain key: ${JSON.stringify(r)}`,"domain",t),e.push({name:r,type:n})}return e.sort(((t,e)=>cs.indexOf(t.name)-cs.indexOf(e.name))),ps.hashStruct("EIP712Domain",{EIP712Domain:e},t)}static encode(t,e,r){return se(["0x1901",ps.hashDomain(t),ps.from(e).hash(r)])}static hash(t,e,r){return br(ps.encode(t,e,r))}static async resolveNames(t,e,r,n){t=Object.assign({},t);for(const e in t)null==t[e]&&delete t[e];const s={};t.verifyingContract&&!te(t.verifyingContract,20)&&(s[t.verifyingContract]="0x");const i=ps.from(e);i.visit(r,((t,e)=>("address"!==t||te(e,20)||(s[e]="0x"),e)));for(const t in s)s[t]=await n(t);return t.verifyingContract&&s[t.verifyingContract]&&(t.verifyingContract=s[t.verifyingContract]),{domain:t,value:r=i.visit(r,((t,e)=>"address"===t&&s[e]?s[e]:e))}}static getPayload(t,e,r){ps.hashDomain(t);const n={},s=[];cs.forEach((e=>{const r=t[e];null!=r&&(n[e]=us[e](r),s.push({name:e,type:as[e]}))}));const i=ps.from(e);e=i.types;const o=Object.assign({},e);return _t(null==o.EIP712Domain,"types must not contain EIP712Domain type","types.EIP712Domain",e),o.EIP712Domain=s,i.encode(r),{types:o,domain:n,primaryType:i.primaryType,message:i.visit(r,((t,e)=>{if(t.match(/^bytes(\d*)/))return ne(Yt(e));if(t.match(/^u?int/))return ge(e).toString();switch(t){case"address":return e.toLowerCase();case"bool":return!!e;case"string":return _t("string"==typeof e,"invalid string","value",e),e}_t(!1,"unsupported type","type",t)}))}}}function gs(t,e){return{address:Br(t),storageKeys:e.map(((t,e)=>(_t(te(t,32),"invalid slot",`storageKeys[${e}]`,t),t.toLowerCase())))}}function ys(t){if(Array.isArray(t))return t.map(((e,r)=>Array.isArray(e)?(_t(2===e.length,"invalid slot set",`value[${r}]`,e),gs(e[0],e[1])):(_t(null!=e&&"object"==typeof e,"invalid address-slot set","value",t),gs(e.address,e.storageKeys))));_t(null!=t&&"object"==typeof t,"invalid access list","value",t);const e=Object.keys(t).map((e=>{const r=t[e].reduce(((t,e)=>(t[e]=!0,t)),{});return gs(e,Object.keys(r).sort())}));return e.sort(((t,e)=>t.address.localeCompare(e.address))),e}function ms(t){return async function(t,e){Jt(null==e||!e.cancelled,"request cancelled before sending","CANCELLED");const r=t.url.split(":")[0].toLowerCase();Jt("http"===r||"https"===r,`unsupported protocol ${r}`,"UNSUPPORTED_OPERATION",{info:{protocol:r},operation:"request"}),Jt("https"===r||!t.credentials||t.allowInsecureAuthentication,"insecure authorized connections unsupported","UNSUPPORTED_OPERATION",{operation:"request"});let n=null;const s=new AbortController,i=setTimeout((()=>{n=Kt("request timeout","TIMEOUT"),s.abort()}),t.timeout);e&&e.addListener((()=>{n=Kt("request cancelled","CANCELLED"),s.abort()}));const o={method:t.method,headers:new Headers(Array.from(t)),body:t.body||void 0,signal:s.signal};let a;try{a=await fetch(t.url,o)}catch(t){if(clearTimeout(i),n)throw n;throw t}clearTimeout(i);const c={};a.headers.forEach(((t,e)=>{c[e.toLowerCase()]=t}));const l=await a.arrayBuffer(),u=null==l?null:new Uint8Array(l);return{statusCode:a.status,statusMessage:a.statusText,headers:c,body:u}}}ms();let ws=ms();const bs=new RegExp("^data:([^;:]*)?(;base64)?,(.*)$","i"),As=new RegExp("^ipfs://(ipfs/)?(.*)$","i");let Es=!1;async function vs(t,e){try{const e=t.match(bs);if(!e)throw new Error("invalid data");return new Cs(200,"OK",{"content-type":e[1]||"text/plain"},e[2]?function(t){t=atob(t);const e=new Uint8Array(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return Yt(e)}(e[3]):qr(e[3].replace(/%([0-9a-f][0-9a-f])/gi,((t,e)=>String.fromCharCode(parseInt(e,16))))))}catch(e){return new Cs(599,"BAD REQUEST (invalid data: URI)",{},null,new Ns(t))}}function ks(t){return async function(e,r){try{const r=e.match(As);if(!r)throw new Error("invalid link");return new Ns(`${t}${r[2]}`)}catch(t){return new Cs(599,"BAD REQUEST (invalid IPFS URI)",{},null,new Ns(e))}}}const xs={data:vs,ipfs:ks("https://gateway.ipfs.io/ipfs/")},Bs=new WeakMap;class Is{#b;#A;constructor(t){this.#b=[],this.#A=!1,Bs.set(t,(()=>{if(!this.#A){this.#A=!0;for(const t of this.#b)setTimeout((()=>{t()}),0);this.#b=[]}}))}addListener(t){Jt(!this.#A,"singal already cancelled","UNSUPPORTED_OPERATION",{operation:"fetchCancelSignal.addCancelListener"}),this.#b.push(t)}get cancelled(){return this.#A}checkSignal(){Jt(!this.cancelled,"cancelled","CANCELLED",{})}}function Ps(t){if(null==t)throw new Error("missing signal; should not happen");return t.checkSignal(),t}class Ns{#E;#v;#k;#x;#B;#I;#P;#N;#C;#R;#O;#S;#T;#U;#F;get url(){return this.#I}set url(t){this.#I=String(t)}get body(){return null==this.#P?null:new Uint8Array(this.#P)}set body(t){if(null==t)this.#P=void 0,this.#N=void 0;else if("string"==typeof t)this.#P=qr(t),this.#N="text/plain";else if(t instanceof Uint8Array)this.#P=t,this.#N="application/octet-stream";else{if("object"!=typeof t)throw new Error("invalid body");this.#P=qr(JSON.stringify(t)),this.#N="application/json"}}hasBody(){return null!=this.#P}get method(){return this.#x?this.#x:this.hasBody()?"POST":"GET"}set method(t){null==t&&(t=""),this.#x=String(t).toUpperCase()}get headers(){const t=Object.assign({},this.#k);return this.#C&&(t.authorization=`Basic ${function(t){const e=Yt(t);let r="";for(let t=0;t<e.length;t++)r+=String.fromCharCode(e[t]);return btoa(r)}(qr(this.#C))}`),this.allowGzip&&(t["accept-encoding"]="gzip"),null==t["content-type"]&&this.#N&&(t["content-type"]=this.#N),this.body&&(t["content-length"]=String(this.body.length)),t}getHeader(t){return this.headers[t.toLowerCase()]}setHeader(t,e){this.#k[String(t).toLowerCase()]=String(e)}clearHeaders(){this.#k={}}[Symbol.iterator](){const t=this.headers,e=Object.keys(t);let r=0;return{next:()=>{if(r<e.length){const n=e[r++];return{value:[n,t[n]],done:!1}}return{value:void 0,done:!0}}}}get credentials(){return this.#C||null}setCredentials(t,e){_t(!t.match(/:/),"invalid basic authentication username","username","[REDACTED]"),this.#C=`${t}:${e}`}get allowGzip(){return this.#v}set allowGzip(t){this.#v=!!t}get allowInsecureAuthentication(){return!!this.#E}set allowInsecureAuthentication(t){this.#E=!!t}get timeout(){return this.#B}set timeout(t){_t(t>=0,"timeout must be non-zero","timeout",t),this.#B=t}get preflightFunc(){return this.#R||null}set preflightFunc(t){this.#R=t}get processFunc(){return this.#O||null}set processFunc(t){this.#O=t}get retryFunc(){return this.#S||null}set retryFunc(t){this.#S=t}get getUrlFunc(){return this.#F||ws}set getUrlFunc(t){this.#F=t}constructor(t){this.#I=String(t),this.#E=!1,this.#v=!0,this.#k={},this.#x="",this.#B=3e5,this.#U={slotInterval:250,maxAttempts:12},this.#F=null}toString(){return`<FetchRequest method=${JSON.stringify(this.method)} url=${JSON.stringify(this.url)} headers=${JSON.stringify(this.headers)} body=${this.#P?ne(this.#P):"null"}>`}setThrottleParams(t){null!=t.slotInterval&&(this.#U.slotInterval=t.slotInterval),null!=t.maxAttempts&&(this.#U.maxAttempts=t.maxAttempts)}async#D(t,e,r,n,s){if(t>=this.#U.maxAttempts)return s.makeServerError("exceeded maximum retry limit");Jt(Rs()<=e,"timeout","TIMEOUT",{operation:"request.send",reason:"timeout",request:n}),r>0&&await function(t){return new Promise((e=>setTimeout(e,t)))}(r);let i=this.clone();const o=(i.url.split(":")[0]||"").toLowerCase();if(o in xs){const t=await xs[o](i.url,Ps(n.#T));if(t instanceof Cs){let e=t;if(this.processFunc){Ps(n.#T);try{e=await this.processFunc(i,e)}catch(t){null!=t.throttle&&"number"==typeof t.stall||e.makeServerError("error in post-processing function",t).assertOk()}}return e}i=t}this.preflightFunc&&(i=await this.preflightFunc(i));const a=await this.getUrlFunc(i,Ps(n.#T));let c=new Cs(a.statusCode,a.statusMessage,a.headers,a.body,n);if(301===c.statusCode||302===c.statusCode){try{const r=c.headers.location||"";return i.redirect(r).#D(t+1,e,0,n,c)}catch(t){}return c}if(429===c.statusCode&&(null==this.retryFunc||await this.retryFunc(i,c,t))){const r=c.headers["retry-after"];let s=this.#U.slotInterval*Math.trunc(Math.random()*Math.pow(2,t));return"string"==typeof r&&r.match(/^[1-9][0-9]*$/)&&(s=parseInt(r)),i.clone().#D(t+1,e,s,n,c)}if(this.processFunc){Ps(n.#T);try{c=await this.processFunc(i,c)}catch(r){null!=r.throttle&&"number"==typeof r.stall||c.makeServerError("error in post-processing function",r).assertOk();let s=this.#U.slotInterval*Math.trunc(Math.random()*Math.pow(2,t));return r.stall>=0&&(s=r.stall),i.clone().#D(t+1,e,s,n,c)}}return c}send(){return Jt(null==this.#T,"request already sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.send"}),this.#T=new Is(this),this.#D(0,Rs()+this.timeout,0,this,new Cs(0,"",{},null,this))}cancel(){Jt(null!=this.#T,"request has not been sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.cancel"});const t=Bs.get(this);if(!t)throw new Error("missing signal; should not happen");t()}redirect(t){const e=this.url.split(":")[0].toLowerCase(),r=t.split(":")[0].toLowerCase();Jt("GET"===this.method&&("https"!==e||"http"!==r)&&t.match(/^https?:/),"unsupported redirect","UNSUPPORTED_OPERATION",{operation:`redirect(${this.method} ${JSON.stringify(this.url)} => ${JSON.stringify(t)})`});const n=new Ns(t);return n.method="GET",n.allowGzip=this.allowGzip,n.timeout=this.timeout,n.#k=Object.assign({},this.#k),this.#P&&(n.#P=new Uint8Array(this.#P)),n.#N=this.#N,n}clone(){const t=new Ns(this.url);return t.#x=this.#x,this.#P&&(t.#P=this.#P),t.#N=this.#N,t.#k=Object.assign({},this.#k),t.#C=this.#C,this.allowGzip&&(t.allowGzip=!0),t.timeout=this.timeout,this.allowInsecureAuthentication&&(t.allowInsecureAuthentication=!0),t.#R=this.#R,t.#O=this.#O,t.#S=this.#S,t.#U=Object.assign({},this.#U),t.#F=this.#F,t}static lockConfig(){Es=!0}static getGateway(t){return xs[t.toLowerCase()]||null}static registerGateway(t,e){if("http"===(t=t.toLowerCase())||"https"===t)throw new Error(`cannot intercept ${t}; use registerGetUrl`);if(Es)throw new Error("gateways locked");xs[t]=e}static registerGetUrl(t){if(Es)throw new Error("gateways locked");ws=t}static createGetUrlFunc(t){return ms()}static createDataGateway(){return vs}static createIpfsGatewayFunc(t){return ks(t)}}class Cs{#L;#M;#k;#P;#G;#H;toString(){return`<FetchResponse status=${this.statusCode} body=${this.#P?ne(this.#P):"null"}>`}get statusCode(){return this.#L}get statusMessage(){return this.#M}get headers(){return Object.assign({},this.#k)}get body(){return null==this.#P?null:new Uint8Array(this.#P)}get bodyText(){try{return null==this.#P?"":Wr(this.#P)}catch(t){Jt(!1,"response body is not valid UTF-8 data","UNSUPPORTED_OPERATION",{operation:"bodyText",info:{response:this}})}}get bodyJson(){try{return JSON.parse(this.bodyText)}catch(t){Jt(!1,"response body is not valid JSON","UNSUPPORTED_OPERATION",{operation:"bodyJson",info:{response:this}})}}[Symbol.iterator](){const t=this.headers,e=Object.keys(t);let r=0;return{next:()=>{if(r<e.length){const n=e[r++];return{value:[n,t[n]],done:!1}}return{value:void 0,done:!0}}}}constructor(t,e,r,n,s){this.#L=t,this.#M=e,this.#k=Object.keys(r).reduce(((t,e)=>(t[e.toLowerCase()]=String(r[e]),t)),{}),this.#P=null==n?null:new Uint8Array(n),this.#G=s||null,this.#H={message:""}}makeServerError(t,e){let r;r=t?`CLIENT ESCALATED SERVER ERROR (${this.statusCode} ${this.statusMessage}; ${t})`:`CLIENT ESCALATED SERVER ERROR (${t=`${this.statusCode} ${this.statusMessage}`})`;const n=new Cs(599,r,this.headers,this.body,this.#G||void 0);return n.#H={message:t,error:e},n}throwThrottleError(t,e){null==e?e=-1:_t(Number.isInteger(e)&&e>=0,"invalid stall timeout","stall",e);const r=new Error(t||"throttling requests");throw Qt(r,{stall:e,throttle:!0}),r}getHeader(t){return this.headers[t.toLowerCase()]}hasBody(){return null!=this.#P}get request(){return this.#G}ok(){return""===this.#H.message&&this.statusCode>=200&&this.statusCode<300}assertOk(){if(this.ok())return;let{message:t,error:e}=this.#H;""===t&&(t=`server response ${this.statusCode} ${this.statusMessage}`);let r=null;this.request&&(r=this.request.url);let n=null;try{this.#P&&(n=Wr(this.#P))}catch(t){}Jt(!1,t,"SERVER_ERROR",{request:this.request||"unknown request",response:this,error:e,info:{requestUrl:r,responseBody:n,responseStatus:`${this.statusCode} ${this.statusMessage}`}})}}function Rs(){return(new Date).getTime()}const Os="0x0000000000000000000000000000000000000000";class Ss{fragment;name;signature;topic;args;constructor(t,e,r){const n=t.name,s=t.format();Qt(this,{fragment:t,name:n,signature:s,topic:e,args:r})}}class Ts{fragment;name;args;signature;selector;value;constructor(t,e,r,n){const s=t.name,i=t.format();Qt(this,{fragment:t,name:s,args:r,signature:i,selector:e,value:n})}}class Us{fragment;name;args;signature;selector;constructor(t,e,r){const n=t.name,s=t.format();Qt(this,{fragment:t,name:n,args:r,signature:s,selector:e})}}class Fs{hash;_isIndexed;static isIndexed(t){return!(!t||!t._isIndexed)}constructor(t){Qt(this,{hash:t,_isIndexed:!0})}}const Ds={0:"generic panic",1:"assert(false)",17:"arithmetic overflow",18:"division or modulo by zero",33:"enum overflow",34:"invalid encoded storage byte array accessed",49:"out-of-bounds array access; popping on an empty array",50:"out-of-bounds access of an array or bytesN",65:"out of memory",81:"uninitialized function"},Ls={"0x08c379a0":{signature:"Error(string)",name:"Error",inputs:["string"],reason:t=>`reverted with reason string ${JSON.stringify(t)}`},"0x4e487b71":{signature:"Panic(uint256)",name:"Panic",inputs:["uint256"],reason:t=>{let e="unknown panic code";return t>=0&&t<=255&&Ds[t.toString()]&&(e=Ds[t.toString()]),`reverted with panic code 0x${t.toString(16)} (${e})`}}};class Ms{fragments;deploy;fallback;receive;#Q;#j;#z;#V;constructor(t){let e=[];e="string"==typeof t?JSON.parse(t):t,this.#z=new Map,this.#Q=new Map,this.#j=new Map;const r=[];for(const t of e)try{r.push(Dn.from(t))}catch(e){console.log(`[Warning] Invalid Fragment ${JSON.stringify(t)}:`,e.message)}Qt(this,{fragments:Object.freeze(r)});let n=null,s=!1;this.#V=this.getAbiCoder(),this.fragments.forEach(((t,e)=>{let r;switch(t.type){case"constructor":return this.deploy?void console.log("duplicate definition - constructor"):void Qt(this,{deploy:t});case"fallback":return void(0===t.inputs.length?s=!0:(_t(!n||t.payable!==n.payable,"conflicting fallback fragments",`fragments[${e}]`,t),n=t,s=n.payable));case"function":r=this.#z;break;case"event":r=this.#j;break;case"error":r=this.#Q;break;default:return}const i=t.format();r.has(i)||r.set(i,t)})),this.deploy||Qt(this,{deploy:Qn.from("constructor()")}),Qt(this,{fallback:n,receive:s})}format(t){const e=t?"minimal":"full";return this.fragments.map((t=>t.format(e)))}formatJson(){const t=this.fragments.map((t=>t.format("json")));return JSON.stringify(t.map((t=>JSON.parse(t))))}getAbiCoder(){return Zn.defaultAbiCoder()}#K(t,e,r){if(te(t)){const e=t.toLowerCase();for(const t of this.#z.values())if(e===t.selector)return t;return null}if(-1===t.indexOf("(")){const n=[];for(const[e,r]of this.#z)e.split("(")[0]===t&&n.push(r);if(e){const t=e.length>0?e[e.length-1]:null;let r=e.length,s=!0;Rr.isTyped(t)&&"overrides"===t.type&&(s=!1,r--);for(let t=n.length-1;t>=0;t--){const e=n[t].inputs.length;e===r||s&&e===r-1||n.splice(t,1)}for(let t=n.length-1;t>=0;t--){const r=n[t].inputs;for(let s=0;s<e.length;s++)if(Rr.isTyped(e[s])){if(s>=r.length){if("overrides"===e[s].type)continue;n.splice(t,1);break}if(e[s].type!==r[s].baseType){n.splice(t,1);break}}}}if(1===n.length&&e&&e.length!==n[0].inputs.length){const t=e[e.length-1];(null==t||Array.isArray(t)||"object"!=typeof t)&&n.splice(0,1)}return 0===n.length?null:(n.length>1&&r&&_t(!1,`ambiguous function description (i.e. matches ${n.map((t=>JSON.stringify(t.format()))).join(", ")})`,"key",t),n[0])}return this.#z.get(zn.from(t).format())||null}getFunctionName(t){const e=this.#K(t,null,!1);return _t(e,"no matching function","key",t),e.name}hasFunction(t){return!!this.#K(t,null,!1)}getFunction(t,e){return this.#K(t,e||null,!0)}forEachFunction(t){const e=Array.from(this.#z.keys());e.sort(((t,e)=>t.localeCompare(e)));for(let r=0;r<e.length;r++){const n=e[r];t(this.#z.get(n),r)}}#J(t,e,r){if(te(t)){const e=t.toLowerCase();for(const t of this.#j.values())if(e===t.topicHash)return t;return null}if(-1===t.indexOf("(")){const n=[];for(const[e,r]of this.#j)e.split("(")[0]===t&&n.push(r);if(e){for(let t=n.length-1;t>=0;t--)n[t].inputs.length<e.length&&n.splice(t,1);for(let t=n.length-1;t>=0;t--){const r=n[t].inputs;for(let s=0;s<e.length;s++)if(Rr.isTyped(e[s])&&e[s].type!==r[s].baseType){n.splice(t,1);break}}}return 0===n.length?null:(n.length>1&&r&&_t(!1,`ambiguous event description (i.e. matches ${n.map((t=>JSON.stringify(t.format()))).join(", ")})`,"key",t),n[0])}return this.#j.get(Hn.from(t).format())||null}getEventName(t){const e=this.#J(t,null,!1);return _t(e,"no matching event","key",t),e.name}hasEvent(t){return!!this.#J(t,null,!1)}getEvent(t,e){return this.#J(t,e||null,!0)}forEachEvent(t){const e=Array.from(this.#j.keys());e.sort(((t,e)=>t.localeCompare(e)));for(let r=0;r<e.length;r++){const n=e[r];t(this.#j.get(n),r)}}getError(t,e){if(te(t)){const e=t.toLowerCase();if(Ls[e])return Gn.from(Ls[e].signature);for(const t of this.#Q.values())if(e===t.selector)return t;return null}if(-1===t.indexOf("(")){const e=[];for(const[r,n]of this.#Q)r.split("(")[0]===t&&e.push(n);return 0===e.length?"Error"===t?Gn.from("error Error(string)"):"Panic"===t?Gn.from("error Panic(uint256)"):null:(e.length>1&&_t(!1,`ambiguous error description (i.e. ${e.map((t=>JSON.stringify(t.format()))).join(", ")})`,"name",t),e[0])}if("Error(string)"===(t=Gn.from(t).format()))return Gn.from("error Error(string)");if("Panic(uint256)"===t)return Gn.from("error Panic(uint256)");return this.#Q.get(t)||null}forEachError(t){const e=Array.from(this.#Q.keys());e.sort(((t,e)=>t.localeCompare(e)));for(let r=0;r<e.length;r++){const n=e[r];t(this.#Q.get(n),r)}}_decodeParams(t,e){return this.#V.decode(t,e)}_encodeParams(t,e){return this.#V.encode(t,e)}encodeDeploy(t){return this._encodeParams(this.deploy.inputs,t||[])}decodeErrorResult(t,e){if("string"==typeof t){const e=this.getError(t);_t(e,"unknown error","fragment",t),t=e}return _t(oe(e,0,4)===t.selector,`data signature does not match error ${t.name}.`,"data",e),this._decodeParams(t.inputs,oe(e,4))}encodeErrorResult(t,e){if("string"==typeof t){const e=this.getError(t);_t(e,"unknown error","fragment",t),t=e}return se([t.selector,this._encodeParams(t.inputs,e||[])])}decodeFunctionData(t,e){if("string"==typeof t){const e=this.getFunction(t);_t(e,"unknown function","fragment",t),t=e}return _t(oe(e,0,4)===t.selector,`data signature does not match function ${t.name}.`,"data",e),this._decodeParams(t.inputs,oe(e,4))}encodeFunctionData(t,e){if("string"==typeof t){const e=this.getFunction(t);_t(e,"unknown function","fragment",t),t=e}return se([t.selector,this._encodeParams(t.inputs,e||[])])}decodeFunctionResult(t,e){if("string"==typeof t){const e=this.getFunction(t);_t(e,"unknown function","fragment",t),t=e}let r="invalid length for result data";const n=Xt(e);if(n.length%32==0)try{return this.#V.decode(t.outputs,n)}catch(t){r="could not decode result data"}Jt(!1,r,"BAD_DATA",{value:ne(n),info:{method:t.name,signature:t.format()}})}makeError(t,e){const r=Yt(t,"data"),n=Zn.getBuiltinCallException("call",e,r);if(n.message.startsWith("execution reverted (unknown custom error)")){const t=ne(r.slice(0,4)),e=this.getError(t);if(e)try{const t=this.#V.decode(e.inputs,r.slice(4));n.revert={name:e.name,signature:e.format(),args:t},n.reason=n.revert.signature,n.message=`execution reverted: ${n.reason}`}catch(t){n.message="execution reverted (coult not decode custom error)"}}const s=this.parseTransaction(e);return s&&(n.invocation={method:s.name,signature:s.signature,args:s.args}),n}encodeFunctionResult(t,e){if("string"==typeof t){const e=this.getFunction(t);_t(e,"unknown function","fragment",t),t=e}return ne(this.#V.encode(t.outputs,e||[]))}encodeFilterTopics(t,e){if("string"==typeof t){const e=this.getEvent(t);_t(e,"unknown event","eventFragment",t),t=e}Jt(e.length<=t.inputs.length,`too many arguments for ${t.format()}`,"UNEXPECTED_ARGUMENT",{count:e.length,expectedCount:t.inputs.length});const r=[];t.anonymous||r.push(t.topicHash);const n=(t,e)=>"string"===t.type?Yr(e):"bytes"===t.type?br(ne(e)):("bool"===t.type&&"boolean"==typeof e?e=e?"0x01":"0x00":t.type.match(/^u?int/)?e=Ae(e):t.type.match(/^bytes/)?e=ae(e,32,!1):"address"===t.type&&this.#V.encode(["address"],[e]),ce(ne(e),32));for(e.forEach(((e,s)=>{const i=t.inputs[s];i.indexed?null==e?r.push(null):"array"===i.baseType||"tuple"===i.baseType?_t(!1,"filtering with tuples or arrays not supported","contract."+i.name,e):Array.isArray(e)?r.push(e.map((t=>n(i,t)))):r.push(n(i,e)):_t(null==e,"cannot filter non-indexed parameters; must be null","contract."+i.name,e)}));r.length&&null===r[r.length-1];)r.pop();return r}encodeEventLog(t,e){if("string"==typeof t){const e=this.getEvent(t);_t(e,"unknown event","eventFragment",t),t=e}const r=[],n=[],s=[];return t.anonymous||r.push(t.topicHash),_t(e.length===t.inputs.length,"event arguments/values mismatch","values",e),t.inputs.forEach(((t,i)=>{const o=e[i];if(t.indexed)if("string"===t.type)r.push(Yr(o));else if("bytes"===t.type)r.push(br(o));else{if("tuple"===t.baseType||"array"===t.baseType)throw new Error("not implemented");r.push(this.#V.encode([t.type],[o]))}else n.push(t),s.push(o)})),{data:this.#V.encode(n,s),topics:r}}decodeEventLog(t,e,r){if("string"==typeof t){const e=this.getEvent(t);_t(e,"unknown event","eventFragment",t),t=e}if(null!=r&&!t.anonymous){const e=t.topicHash;_t(te(r[0],32)&&r[0].toLowerCase()===e,"fragment/topic mismatch","topics[0]",r[0]),r=r.slice(1)}const n=[],s=[],i=[];t.inputs.forEach(((t,e)=>{t.indexed?"string"===t.type||"bytes"===t.type||"tuple"===t.baseType||"array"===t.baseType?(n.push(Fn.from({type:"bytes32",name:t.name})),i.push(!0)):(n.push(t),i.push(!1)):(s.push(t),i.push(!1))}));const o=null!=r?this.#V.decode(n,se(r)):null,a=this.#V.decode(s,e,!0),c=[],l=[];let u=0,h=0;return t.inputs.forEach(((t,e)=>{let r=null;if(t.indexed)if(null==o)r=new Fs(null);else if(i[e])r=new Fs(o[h++]);else try{r=o[h++]}catch(t){r=t}else try{r=a[u++]}catch(t){r=t}c.push(r),l.push(t.name||null)})),Se.fromItems(c,l)}parseTransaction(t){const e=Yt(t.data,"tx.data"),r=ge(null!=t.value?t.value:0,"tx.value"),n=this.getFunction(ne(e.slice(0,4)));if(!n)return null;const s=this.#V.decode(n.inputs,e.slice(4));return new Ts(n,n.selector,s,r)}parseCallResult(t){throw new Error("@TODO")}parseLog(t){const e=this.getEvent(t.topics[0]);return!e||e.anonymous?null:new Ss(e,e.topicHash,this.decodeEventLog(e,t.data,t.topics))}parseError(t){const e=ne(t),r=this.getError(oe(e,0,4));if(!r)return null;const n=this.#V.decode(r.inputs,oe(e,4));return new Us(r,r.selector,n)}static from(t){return t instanceof Ms?t:"string"==typeof t?new Ms(JSON.parse(t)):"function"==typeof t.formatJson?new Ms(t.formatJson()):"function"==typeof t.format?new Ms(t.format("json")):new Ms(t)}}const Gs=BigInt(0);function Hs(t){return null==t?null:t}function Qs(t){return null==t?null:t.toString()}class js{gasPrice;maxFeePerGas;maxPriorityFeePerGas;constructor(t,e,r){Qt(this,{gasPrice:Hs(t),maxFeePerGas:Hs(e),maxPriorityFeePerGas:Hs(r)})}toJSON(){const{gasPrice:t,maxFeePerGas:e,maxPriorityFeePerGas:r}=this;return{_type:"FeeData",gasPrice:Qs(t),maxFeePerGas:Qs(e),maxPriorityFeePerGas:Qs(r)}}}function zs(t){const e={};t.to&&(e.to=t.to),t.from&&(e.from=t.from),t.data&&(e.data=ne(t.data));const r="chainId,gasLimit,gasPrice,maxFeePerBlobGas,maxFeePerGas,maxPriorityFeePerGas,value".split(/,/);for(const n of r)n in t&&null!=t[n]&&(e[n]=ge(t[n],`request.${n}`));const n="type,nonce".split(/,/);for(const r of n)r in t&&null!=t[r]&&(e[r]=be(t[r],`request.${r}`));return t.accessList&&(e.accessList=ys(t.accessList)),"blockTag"in t&&(e.blockTag=t.blockTag),"enableCcipRead"in t&&(e.enableCcipRead=!!t.enableCcipRead),"customData"in t&&(e.customData=t.customData),"blobVersionedHashes"in t&&t.blobVersionedHashes&&(e.blobVersionedHashes=t.blobVersionedHashes.slice()),"kzg"in t&&(e.kzg=t.kzg),"blobs"in t&&t.blobs&&(e.blobs=t.blobs.map((t=>ee(t)?ne(t):Object.assign({},t)))),e}class Vs{provider;number;hash;timestamp;parentHash;parentBeaconBlockRoot;nonce;difficulty;gasLimit;gasUsed;stateRoot;receiptsRoot;blobGasUsed;excessBlobGas;miner;prevRandao;extraData;baseFeePerGas;#_;constructor(t,e){this.#_=t.transactions.map((t=>"string"!=typeof t?new _s(t,e):t)),Qt(this,{provider:e,hash:Hs(t.hash),number:t.number,timestamp:t.timestamp,parentHash:t.parentHash,parentBeaconBlockRoot:t.parentBeaconBlockRoot,nonce:t.nonce,difficulty:t.difficulty,gasLimit:t.gasLimit,gasUsed:t.gasUsed,blobGasUsed:t.blobGasUsed,excessBlobGas:t.excessBlobGas,miner:t.miner,prevRandao:Hs(t.prevRandao),extraData:t.extraData,baseFeePerGas:Hs(t.baseFeePerGas),stateRoot:t.stateRoot,receiptsRoot:t.receiptsRoot})}get transactions(){return this.#_.map((t=>"string"==typeof t?t:t.hash))}get prefetchedTransactions(){const t=this.#_.slice();return 0===t.length?[]:(Jt("object"==typeof t[0],"transactions were not prefetched with block request","UNSUPPORTED_OPERATION",{operation:"transactionResponses()"}),t)}toJSON(){const{baseFeePerGas:t,difficulty:e,extraData:r,gasLimit:n,gasUsed:s,hash:i,miner:o,prevRandao:a,nonce:c,number:l,parentHash:u,parentBeaconBlockRoot:h,stateRoot:f,receiptsRoot:d,timestamp:p,transactions:g}=this;return{_type:"Block",baseFeePerGas:Qs(t),difficulty:Qs(e),extraData:r,gasLimit:Qs(n),gasUsed:Qs(s),blobGasUsed:Qs(this.blobGasUsed),excessBlobGas:Qs(this.excessBlobGas),hash:i,miner:o,prevRandao:a,nonce:c,number:l,parentHash:u,timestamp:p,parentBeaconBlockRoot:h,stateRoot:f,receiptsRoot:d,transactions:g}}[Symbol.iterator](){let t=0;const e=this.transactions;return{next:()=>t<this.length?{value:e[t++],done:!1}:{value:void 0,done:!0}}}get length(){return this.#_.length}get date(){return null==this.timestamp?null:new Date(1e3*this.timestamp)}async getTransaction(t){let e;if("number"==typeof t)e=this.#_[t];else{const r=t.toLowerCase();for(const t of this.#_){if("string"==typeof t){if(t!==r)continue;e=t;break}if(t.hash===r){e=t;break}}}if(null==e)throw new Error("no such tx");return"string"==typeof e?await this.provider.getTransaction(e):e}getPrefetchedTransaction(t){const e=this.prefetchedTransactions;if("number"==typeof t)return e[t];t=t.toLowerCase();for(const r of e)if(r.hash===t)return r;_t(!1,"no matching transaction","indexOrHash",t)}isMined(){return!!this.hash}isLondon(){return!!this.baseFeePerGas}orphanedEvent(){if(!this.isMined())throw new Error("");return{orphan:"drop-block",hash:this.hash,number:this.number}}}class Ks{provider;transactionHash;blockHash;blockNumber;removed;address;data;topics;index;transactionIndex;constructor(t,e){this.provider=e;const r=Object.freeze(t.topics.slice());Qt(this,{transactionHash:t.transactionHash,blockHash:t.blockHash,blockNumber:t.blockNumber,removed:t.removed,address:t.address,data:t.data,topics:r,index:t.index,transactionIndex:t.transactionIndex})}toJSON(){const{address:t,blockHash:e,blockNumber:r,data:n,index:s,removed:i,topics:o,transactionHash:a,transactionIndex:c}=this;return{_type:"log",address:t,blockHash:e,blockNumber:r,data:n,index:s,removed:i,topics:o,transactionHash:a,transactionIndex:c}}async getBlock(){const t=await this.provider.getBlock(this.blockHash);return Jt(!!t,"failed to find transaction","UNKNOWN_ERROR",{}),t}async getTransaction(){const t=await this.provider.getTransaction(this.transactionHash);return Jt(!!t,"failed to find transaction","UNKNOWN_ERROR",{}),t}async getTransactionReceipt(){const t=await this.provider.getTransactionReceipt(this.transactionHash);return Jt(!!t,"failed to find transaction receipt","UNKNOWN_ERROR",{}),t}removedEvent(){return{orphan:"drop-log",log:{transactionHash:(t=this).transactionHash,blockHash:t.blockHash,blockNumber:t.blockNumber,address:t.address,data:t.data,topics:Object.freeze(t.topics.slice()),index:t.index}};var t}}class Js{provider;to;from;contractAddress;hash;index;blockHash;blockNumber;logsBloom;gasUsed;blobGasUsed;cumulativeGasUsed;gasPrice;blobGasPrice;type;status;root;#q;constructor(t,e){this.#q=Object.freeze(t.logs.map((t=>new Ks(t,e))));let r=Gs;null!=t.effectiveGasPrice?r=t.effectiveGasPrice:null!=t.gasPrice&&(r=t.gasPrice),Qt(this,{provider:e,to:t.to,from:t.from,contractAddress:t.contractAddress,hash:t.hash,index:t.index,blockHash:t.blockHash,blockNumber:t.blockNumber,logsBloom:t.logsBloom,gasUsed:t.gasUsed,cumulativeGasUsed:t.cumulativeGasUsed,blobGasUsed:t.blobGasUsed,gasPrice:r,blobGasPrice:t.blobGasPrice,type:t.type,status:t.status,root:t.root})}get logs(){return this.#q}toJSON(){const{to:t,from:e,contractAddress:r,hash:n,index:s,blockHash:i,blockNumber:o,logsBloom:a,logs:c,status:l,root:u}=this;return{_type:"TransactionReceipt",blockHash:i,blockNumber:o,contractAddress:r,cumulativeGasUsed:Qs(this.cumulativeGasUsed),from:e,gasPrice:Qs(this.gasPrice),blobGasUsed:Qs(this.blobGasUsed),blobGasPrice:Qs(this.blobGasPrice),gasUsed:Qs(this.gasUsed),hash:n,index:s,logs:c,logsBloom:a,root:u,status:l,to:t}}get length(){return this.logs.length}[Symbol.iterator](){let t=0;return{next:()=>t<this.length?{value:this.logs[t++],done:!1}:{value:void 0,done:!0}}}get fee(){return this.gasUsed*this.gasPrice}async getBlock(){const t=await this.provider.getBlock(this.blockHash);if(null==t)throw new Error("TODO");return t}async getTransaction(){const t=await this.provider.getTransaction(this.hash);if(null==t)throw new Error("TODO");return t}async getResult(){return await this.provider.getTransactionResult(this.hash)}async confirmations(){return await this.provider.getBlockNumber()-this.blockNumber+1}removedEvent(){return Ws(this)}reorderedEvent(t){return Jt(!t||t.isMined(),"unmined 'other' transction cannot be orphaned","UNSUPPORTED_OPERATION",{operation:"reorderedEvent(other)"}),qs(this,t)}}class _s{provider;blockNumber;blockHash;index;hash;type;to;from;nonce;gasLimit;gasPrice;maxPriorityFeePerGas;maxFeePerGas;maxFeePerBlobGas;data;value;chainId;signature;accessList;blobVersionedHashes;#W;constructor(t,e){this.provider=e,this.blockNumber=null!=t.blockNumber?t.blockNumber:null,this.blockHash=null!=t.blockHash?t.blockHash:null,this.hash=t.hash,this.index=t.index,this.type=t.type,this.from=t.from,this.to=t.to||null,this.gasLimit=t.gasLimit,this.nonce=t.nonce,this.data=t.data,this.value=t.value,this.gasPrice=t.gasPrice,this.maxPriorityFeePerGas=null!=t.maxPriorityFeePerGas?t.maxPriorityFeePerGas:null,this.maxFeePerGas=null!=t.maxFeePerGas?t.maxFeePerGas:null,this.maxFeePerBlobGas=null!=t.maxFeePerBlobGas?t.maxFeePerBlobGas:null,this.chainId=t.chainId,this.signature=t.signature,this.accessList=null!=t.accessList?t.accessList:null,this.blobVersionedHashes=null!=t.blobVersionedHashes?t.blobVersionedHashes:null,this.#W=-1}toJSON(){const{blockNumber:t,blockHash:e,index:r,hash:n,type:s,to:i,from:o,nonce:a,data:c,signature:l,accessList:u,blobVersionedHashes:h}=this;return{_type:"TransactionResponse",accessList:u,blockNumber:t,blockHash:e,blobVersionedHashes:h,chainId:Qs(this.chainId),data:c,from:o,gasLimit:Qs(this.gasLimit),gasPrice:Qs(this.gasPrice),hash:n,maxFeePerGas:Qs(this.maxFeePerGas),maxPriorityFeePerGas:Qs(this.maxPriorityFeePerGas),maxFeePerBlobGas:Qs(this.maxFeePerBlobGas),nonce:a,signature:l,to:i,index:r,type:s,value:Qs(this.value)}}async getBlock(){let t=this.blockNumber;if(null==t){const e=await this.getTransaction();e&&(t=e.blockNumber)}if(null==t)return null;const e=this.provider.getBlock(t);if(null==e)throw new Error("TODO");return e}async getTransaction(){return this.provider.getTransaction(this.hash)}async confirmations(){if(null==this.blockNumber){const{tx:t,blockNumber:e}=await Ht({tx:this.getTransaction(),blockNumber:this.provider.getBlockNumber()});return null==t||null==t.blockNumber?0:e-t.blockNumber+1}return await this.provider.getBlockNumber()-this.blockNumber+1}async wait(t,e){const r=null==t?1:t,n=null==e?0:e;let s=this.#W,i=-1,o=-1===s;const a=async()=>{if(o)return null;const{blockNumber:t,nonce:e}=await Ht({blockNumber:this.provider.getBlockNumber(),nonce:this.provider.getTransactionCount(this.from)});if(e<this.nonce)return void(s=t);if(o)return null;const n=await this.getTransaction();if(!n||null==n.blockNumber)for(-1===i&&(i=s-3,i<this.#W&&(i=this.#W));i<=t;){if(o)return null;const e=await this.provider.getBlock(i,!0);if(null==e)return;for(const t of e)if(t===this.hash)return;for(let n=0;n<e.length;n++){const i=await e.getTransaction(n);if(i.from===this.from&&i.nonce===this.nonce){if(o)return null;const e=await this.provider.getTransactionReceipt(i.hash);if(null==e)return;if(t-e.blockNumber+1<r)return;let n="replaced";i.data===this.data&&i.to===this.to&&i.value===this.value?n="repriced":"0x"===i.data&&i.from===i.to&&i.value===Gs&&(n="cancelled"),Jt(!1,"transaction was replaced","TRANSACTION_REPLACED",{cancelled:"replaced"===n||"cancelled"===n,reason:n,replacement:i.replaceableTransaction(s),hash:i.hash,receipt:e})}}i++}},c=t=>{if(null==t||0!==t.status)return t;Jt(!1,"transaction execution reverted","CALL_EXCEPTION",{action:"sendTransaction",data:null,reason:null,invocation:null,revert:null,transaction:{to:t.to,from:t.from,data:""},receipt:t})},l=await this.provider.getTransactionReceipt(this.hash);if(0===r)return c(l);if(l){if(await l.confirmations()>=r)return c(l)}else if(await a(),0===r)return null;const u=new Promise(((t,e)=>{const i=[],l=()=>{i.forEach((t=>t()))};if(i.push((()=>{o=!0})),n>0){const t=setTimeout((()=>{l(),e(Kt("wait for transaction timeout","TIMEOUT"))}),n);i.push((()=>{clearTimeout(t)}))}const u=async n=>{if(await n.confirmations()>=r){l();try{t(c(n))}catch(t){e(t)}}};if(i.push((()=>{this.provider.off(this.hash,u)})),this.provider.on(this.hash,u),s>=0){const t=async()=>{try{await a()}catch(t){if(zt(t,"TRANSACTION_REPLACED"))return l(),void e(t)}o||this.provider.once("block",t)};i.push((()=>{this.provider.off("block",t)})),this.provider.once("block",t)}}));return await u}isMined(){return null!=this.blockHash}isLegacy(){return 0===this.type}isBerlin(){return 1===this.type}isLondon(){return 2===this.type}isCancun(){return 3===this.type}removedEvent(){return Jt(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),Ws(this)}reorderedEvent(t){return Jt(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),Jt(!t||t.isMined(),"unmined 'other' transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),qs(this,t)}replaceableTransaction(t){_t(Number.isInteger(t)&&t>=0,"invalid startBlock","startBlock",t);const e=new _s(this,this.provider);return e.#W=t,e}}function qs(t,e){return{orphan:"reorder-transaction",tx:t,other:e}}function Ws(t){return{orphan:"drop-transaction",tx:t}}class Zs{filter;emitter;#Z;constructor(t,e,r){this.#Z=e,Qt(this,{emitter:t,filter:r})}async removeListener(){null!=this.#Z&&await this.emitter.off(this.filter,this.#Z)}}class $s extends Ks{interface;fragment;args;constructor(t,e,r){super(t,t.provider),Qt(this,{args:e.decodeEventLog(r,t.data,t.topics),fragment:r,interface:e})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}class Ys extends Ks{error;constructor(t,e){super(t,t.provider),Qt(this,{error:e})}}class Xs extends Js{#$;constructor(t,e,r){super(r,e),this.#$=t}get logs(){return super.logs.map((t=>{const e=t.topics.length?this.#$.getEvent(t.topics[0]):null;if(e)try{return new $s(t,this.#$,e)}catch(e){return new Ys(t,e)}return t}))}}class ti extends _s{#$;constructor(t,e,r){super(r,e),this.#$=t}async wait(t,e){const r=await super.wait(t,e);return null==r?null:new Xs(this.#$,this.provider,r)}}class ei extends Zs{log;constructor(t,e,r,n){super(t,e,r),Qt(this,{log:n})}async getBlock(){return await this.log.getBlock()}async getTransaction(){return await this.log.getTransaction()}async getTransactionReceipt(){return await this.log.getTransactionReceipt()}}class ri extends ei{constructor(t,e,r,n,s){super(t,e,r,new $s(s,t.interface,n)),Qt(this,{args:t.interface.decodeEventLog(n,this.log.data,this.log.topics),fragment:n})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}const ni=BigInt(0);function si(t){return t&&"function"==typeof t.call}function ii(t){return t&&"function"==typeof t.estimateGas}function oi(t){return t&&"function"==typeof t.resolveName}function ai(t){return t&&"function"==typeof t.sendTransaction}function ci(t){if(null!=t){if(oi(t))return t;if(t.provider)return t.provider}}class li{#Y;fragment;constructor(t,e,r){if(Qt(this,{fragment:e}),e.inputs.length<r.length)throw new Error("too many arguments");const n=ui(t.runner,"resolveName"),s=oi(n)?n:null;this.#Y=async function(){const n=await Promise.all(e.inputs.map(((t,e)=>null==r[e]?null:t.walkAsync(r[e],((t,e)=>"address"===t?Array.isArray(e)?Promise.all(e.map((t=>Xn(t,s)))):Xn(e,s):e)))));return t.interface.encodeFilterTopics(e,n)}()}getTopicFilter(){return this.#Y}}function ui(t,e){return null==t?null:"function"==typeof t[e]?t:t.provider&&"function"==typeof t.provider[e]?t.provider:null}function hi(t){return null==t?null:t.provider||null}async function fi(t,e){const r=Rr.dereference(t,"overrides");_t("object"==typeof r,"invalid overrides parameter","overrides",t);const n=zs(r);return _t(null==n.to||(e||[]).indexOf("to")>=0,"cannot override to","overrides.to",n.to),_t(null==n.data||(e||[]).indexOf("data")>=0,"cannot override data","overrides.data",n.data),n.from&&(n.from=n.from),n}function di(t){const e=async function(e){const r=await fi(e,["data"]);r.to=await t.getAddress(),r.from&&(r.from=await Xn(r.from,ci(t.runner)));const n=t.interface,s=ge(r.value||ni,"overrides.value")===ni,i="0x"===(r.data||"0x");return!n.fallback||n.fallback.payable||!n.receive||i||s||_t(!1,"cannot send data to receive or send value to non-payable fallback","overrides",e),_t(n.fallback||i,"cannot send data to receive-only contract","overrides.data",r.data),_t(n.receive||n.fallback&&n.fallback.payable||s,"cannot send value to non-payable fallback","overrides.value",r.value),_t(n.fallback||i,"cannot send data to receive-only contract","overrides.data",r.data),r},r=async function(r){const n=t.runner;Jt(ai(n),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const s=await n.sendTransaction(await e(r)),i=hi(t.runner);return new ti(t.interface,i,s)},n=async t=>await r(t);return Qt(n,{_contract:t,estimateGas:async function(r){const n=ui(t.runner,"estimateGas");return Jt(ii(n),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await n.estimateGas(await e(r))},populateTransaction:e,send:r,staticCall:async function(r){const n=ui(t.runner,"call");Jt(si(n),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const s=await e(r);try{return await n.call(s)}catch(e){if(Vt(e)&&e.data)throw t.interface.makeError(e.data,s);throw e}}}),n}const pi=Symbol.for("_ethersInternal_contract"),gi=new WeakMap;function yi(t){return gi.get(t[pi])}async function mi(t,e){let r,n=null;if(Array.isArray(e)){const n=function(e){if(te(e,32))return e;const r=t.interface.getEvent(e);return _t(r,"unknown fragment","name",e),r.topicHash};r=e.map((t=>null==t?null:Array.isArray(t)?t.map(n):n(t)))}else"*"===e?r=[null]:"string"==typeof e?te(e,32)?r=[e]:(n=t.interface.getEvent(e),_t(n,"unknown fragment","event",e),r=[n.topicHash]):(s=e)&&"object"==typeof s&&"getTopicFilter"in s&&"function"==typeof s.getTopicFilter&&s.fragment?r=await e.getTopicFilter():"fragment"in e?(n=e.fragment,r=[n.topicHash]):_t(!1,"unknown event name","event",e);var s;return r=r.map((t=>{if(null==t)return null;if(Array.isArray(t)){const e=Array.from(new Set(t.map((t=>t.toLowerCase()))).values());return 1===e.length?e[0]:(e.sort(),e)}return t.toLowerCase()})),{fragment:n,tag:r.map((t=>null==t?"null":Array.isArray(t)?t.join("|"):t)).join("&"),topics:r}}async function wi(t,e){const{subs:r}=yi(t);return r.get((await mi(t,e)).tag)||null}async function bi(t,e,r){const n=hi(t.runner);Jt(n,"contract runner does not support subscribing","UNSUPPORTED_OPERATION",{operation:e});const{fragment:s,tag:i,topics:o}=await mi(t,r),{addr:a,subs:c}=yi(t);let l=c.get(i);if(!l){const e={address:a||t,topics:o},u=e=>{let n=s;if(null==n)try{n=t.interface.getEvent(e.topics[0])}catch(t){}if(n){const i=n,o=s?t.interface.decodeEventLog(s,e.data,e.topics):[];Ei(t,r,o,(n=>new ri(t,n,r,i,e)))}else Ei(t,r,[],(n=>new ei(t,n,r,e)))};let h=[];l={tag:i,listeners:[],start:()=>{h.length||h.push(n.on(e,u))},stop:async()=>{if(0==h.length)return;let t=h;h=[],await Promise.all(t),n.off(e,u)}},c.set(i,l)}return l}let Ai=Promise.resolve();async function Ei(t,e,r,n){try{await Ai}catch(t){}const s=async function(t,e,r,n){await Ai;const s=await wi(t,e);if(!s)return!1;const i=s.listeners.length;return s.listeners=s.listeners.filter((({listener:e,once:s})=>{const i=Array.from(r);n&&i.push(n(s?null:e));try{e.call(t,...i)}catch(t){}return!s})),0===s.listeners.length&&(s.stop(),yi(t).subs.delete(s.tag)),i>0}(t,e,r,n);return Ai=s,await s}const vi=["then"];class ki{target;interface;runner;filters;[pi];fallback;constructor(t,e,r,n){_t("string"==typeof t||$n(t),"invalid value for Contract target","target",t),null==r&&(r=null);const s=Ms.from(e);let i;Qt(this,{target:t,runner:r,interface:s}),Object.defineProperty(this,pi,{value:{}});let o=null,a=null;if(n){const t=hi(r);a=new ti(this.interface,t,n)}let c=new Map;if("string"==typeof t)if(te(t))o=t,i=Promise.resolve(t);else{const e=ui(r,"resolveName");if(!oi(e))throw Kt("contract runner does not support name resolution","UNSUPPORTED_OPERATION",{operation:"resolveName"});i=e.resolveName(t).then((e=>{if(null==e)throw Kt("an ENS name used for a contract target must be correctly configured","UNCONFIGURED_NAME",{value:t});return yi(this).addr=e,e}))}else i=t.getAddress().then((t=>{if(null==t)throw new Error("TODO");return yi(this).addr=t,t}));var l;l={addrPromise:i,addr:o,deployTx:a,subs:c},gi.set(this[pi],l);const u=new Proxy({},{get:(t,e,r)=>{if("symbol"==typeof e||vi.indexOf(e)>=0)return Reflect.get(t,e,r);try{return this.getEvent(e)}catch(t){if(!zt(t,"INVALID_ARGUMENT")||"key"!==t.argument)throw t}},has:(t,e)=>vi.indexOf(e)>=0?Reflect.has(t,e):Reflect.has(t,e)||this.interface.hasEvent(String(e))});return Qt(this,{filters:u}),Qt(this,{fallback:s.receive||s.fallback?di(this):null}),new Proxy(this,{get:(t,e,r)=>{if("symbol"==typeof e||e in t||vi.indexOf(e)>=0)return Reflect.get(t,e,r);try{return t.getFunction(e)}catch(t){if(!zt(t,"INVALID_ARGUMENT")||"key"!==t.argument)throw t}},has:(t,e)=>"symbol"==typeof e||e in t||vi.indexOf(e)>=0?Reflect.has(t,e):t.interface.hasFunction(e)})}connect(t){return new ki(this.target,this.interface,t)}attach(t){return new ki(t,this.interface,this.runner)}async getAddress(){return await yi(this).addrPromise}async getDeployedCode(){const t=hi(this.runner);Jt(t,"runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"getDeployedCode"});const e=await t.getCode(await this.getAddress());return"0x"===e?null:e}async waitForDeployment(){const t=this.deploymentTransaction();if(t)return await t.wait(),this;if(null!=await this.getDeployedCode())return this;const e=hi(this.runner);return Jt(null!=e,"contract runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"waitForDeployment"}),new Promise(((t,r)=>{const n=async()=>{try{if(null!=await this.getDeployedCode())return t(this);e.once("block",n)}catch(t){r(t)}};n()}))}deploymentTransaction(){return yi(this).deployTx}getFunction(t){return"string"!=typeof t&&(t=t.format()),function(t,e){const r=function(...r){const n=t.interface.getFunction(e,r);return Jt(n,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:r}}),n},n=async function(...e){const n=r(...e);let s={};if(n.inputs.length+1===e.length&&(s=await fi(e.pop()),s.from&&(s.from=await Xn(s.from,ci(t.runner)))),n.inputs.length!==e.length)throw new Error("internal error: fragment inputs doesn't match arguments; should not happen");const i=await async function(t,e,r){const n=ui(t,"resolveName"),s=oi(n)?n:null;return await Promise.all(e.map(((t,e)=>t.walkAsync(r[e],((t,e)=>(e=Rr.dereference(e,t),"address"===t?Xn(e,s):e))))))}(t.runner,n.inputs,e);return Object.assign({},s,await Ht({to:t.getAddress(),data:t.interface.encodeFunctionData(n,i)}))},s=async function(...t){const e=await o(...t);return 1===e.length?e[0]:e},i=async function(...e){const r=t.runner;Jt(ai(r),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const s=await r.sendTransaction(await n(...e)),i=hi(t.runner);return new ti(t.interface,i,s)},o=async function(...e){const s=ui(t.runner,"call");Jt(si(s),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const i=await n(...e);let o="0x";try{o=await s.call(i)}catch(e){if(Vt(e)&&e.data)throw t.interface.makeError(e.data,i);throw e}const a=r(...e);return t.interface.decodeFunctionResult(a,o)},a=async(...t)=>r(...t).constant?await s(...t):await i(...t);return Qt(a,{name:t.interface.getFunctionName(e),_contract:t,_key:e,getFragment:r,estimateGas:async function(...e){const r=ui(t.runner,"estimateGas");return Jt(ii(r),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await r.estimateGas(await n(...e))},populateTransaction:n,send:i,staticCall:s,staticCallResult:o}),Object.defineProperty(a,"fragment",{configurable:!1,enumerable:!0,get:()=>{const r=t.interface.getFunction(e);return Jt(r,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),r}}),a}(this,t)}getEvent(t){return"string"!=typeof t&&(t=t.format()),function(t,e){const r=function(...r){const n=t.interface.getEvent(e,r);return Jt(n,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:r}}),n},n=function(...e){return new li(t,r(...e),e)};return Qt(n,{name:t.interface.getEventName(e),_contract:t,_key:e,getFragment:r}),Object.defineProperty(n,"fragment",{configurable:!1,enumerable:!0,get:()=>{const r=t.interface.getEvent(e);return Jt(r,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),r}}),n}(this,t)}async queryTransaction(t){throw new Error("@TODO")}async queryFilter(t,e,r){null==e&&(e=0),null==r&&(r="latest");const{addr:n,addrPromise:s}=yi(this),i=n||await s,{fragment:o,topics:a}=await mi(this,t),c={address:i,topics:a,fromBlock:e,toBlock:r},l=hi(this.runner);return Jt(l,"contract runner does not have a provider","UNSUPPORTED_OPERATION",{operation:"queryFilter"}),(await l.getLogs(c)).map((t=>{let e=o;if(null==e)try{e=this.interface.getEvent(t.topics[0])}catch(t){}if(e)try{return new $s(t,this.interface,e)}catch(e){return new Ys(t,e)}return new Ks(t,l)}))}async on(t,e){const r=await bi(this,"on",t);return r.listeners.push({listener:e,once:!1}),r.start(),this}async once(t,e){const r=await bi(this,"once",t);return r.listeners.push({listener:e,once:!0}),r.start(),this}async emit(t,...e){return await Ei(this,t,e,null)}async listenerCount(t){if(t){const e=await wi(this,t);return e?e.listeners.length:0}const{subs:e}=yi(this);let r=0;for(const{listeners:t}of e.values())r+=t.length;return r}async listeners(t){if(t){const e=await wi(this,t);return e?e.listeners.map((({listener:t})=>t)):[]}const{subs:e}=yi(this);let r=[];for(const{listeners:t}of e.values())r=r.concat(t.map((({listener:t})=>t)));return r}async off(t,e){const r=await wi(this,t);if(!r)return this;if(e){const t=r.listeners.map((({listener:t})=>t)).indexOf(e);t>=0&&r.listeners.splice(t,1)}return null!=e&&0!==r.listeners.length||(r.stop(),yi(this).subs.delete(r.tag)),this}async removeAllListeners(t){if(t){const e=await wi(this,t);if(!e)return this;e.stop(),yi(this).subs.delete(e.tag)}else{const{subs:t}=yi(this);for(const{tag:e,stop:r}of t.values())r(),t.delete(e)}return this}async addListener(t,e){return await this.on(t,e)}async removeListener(t,e){return await this.off(t,e)}static buildClass(t){return class extends ki{constructor(e,r=null){super(e,t,r)}}}static from(t,e,r){return null==r&&(r=null),new this(t,e,r)}}class xi extends(function(){return ki}()){}const Bi=new Map([[8217,"apostrophe"],[8260,"fraction slash"],[12539,"middle dot"]]);function Ii(t){return function(t){let e=0;return()=>t[e++]}(function(t){let e=0;function r(){return t[e++]<<8|t[e++]}let n=r(),s=1,i=[0,1];for(let t=1;t<n;t++)i.push(s+=r());let o=r(),a=e;e+=o;let c=0,l=0;function u(){return 0==c&&(l=l<<8|t[e++],c=8),l>>--c&1}const h=2**31,f=h>>>1,d=f>>1,p=h-1;let g=0;for(let t=0;t<31;t++)g=g<<1|u();let y=[],m=0,w=h;for(;;){let t=Math.floor(((g-m+1)*s-1)/w),e=0,r=n;for(;r-e>1;){let n=e+r>>>1;t<i[n]?r=n:e=n}if(0==e)break;y.push(e);let o=m+Math.floor(w*i[e]/s),a=m+Math.floor(w*i[e+1]/s)-1;for(;!((o^a)&f);)g=g<<1&p|u(),o=o<<1&p,a=a<<1&p|1;for(;o&~a&d;)g=g&f|g<<1&p>>>1|u(),o=o<<1^f,a=(a^f)<<1|f|1;m=o,w=1+a-o}let b=n-4;return y.map((e=>{switch(e-b){case 3:return b+65792+(t[a++]<<16|t[a++]<<8|t[a++]);case 2:return b+256+(t[a++]<<8|t[a++]);case 1:return b+t[a++];default:return e-1}}))}(function(t){let e=[];[..."ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"].forEach(((t,r)=>e[t.charCodeAt(0)]=r));let r=t.length,n=new Uint8Array(6*r>>3);for(let s=0,i=0,o=0,a=0;s<r;s++)a=a<<6|e[t.charCodeAt(s)],o+=6,o>=8&&(n[i++]=a>>(o-=8));return n}(t)))}function Pi(t){return 1&t?~t>>1:t>>1}function Ni(t,e){let r=Array(t);for(let n=0,s=0;n<t;n++)r[n]=s+=Pi(e());return r}function Ci(t,e=0){let r=[];for(;;){let n=t(),s=t();if(!s)break;e+=n;for(let t=0;t<s;t++)r.push(e+t);e+=s+1}return r}function Ri(t){return Si((()=>{let e=Ci(t);if(e.length)return e}))}function Oi(t){let e=[];for(;;){let r=t();if(0==r)break;e.push(Ui(r,t))}for(;;){let r=t()-1;if(r<0)break;e.push(Fi(r,t))}return e.flat()}function Si(t){let e=[];for(;;){let r=t(e.length);if(!r)break;e.push(r)}return e}function Ti(t,e,r){let n=Array(t).fill().map((()=>[]));for(let s=0;s<e;s++)Ni(t,r).forEach(((t,e)=>n[e].push(t)));return n}function Ui(t,e){let r=1+e(),n=e(),s=Si(e);return Ti(s.length,1+t,e).flatMap(((t,e)=>{let[i,...o]=t;return Array(s[e]).fill().map(((t,e)=>{let s=e*n;return[i+e*r,o.map((t=>t+s))]}))}))}function Fi(t,e){return Ti(1+e(),1+t,e).map((t=>[t[0],t.slice(1)]))}function Di(t){return`{${function(t){return t.toString(16).toUpperCase().padStart(2,"0")}(t)}}`}function Li(t){let e=t.length;if(e<4096)return String.fromCodePoint(...t);let r=[];for(let n=0;n<e;)r.push(String.fromCodePoint(...t.slice(n,n+=4096)));return r.join("")}function Mi(t,e){let r=t.length,n=r-e.length;for(let s=0;0==n&&s<r;s++)n=t[s]-e[s];return n}const Gi=44032,Hi=4352,Qi=4449,ji=4519;function zi(t){return t>>24&255}function Vi(t){return 16777215&t}let Ki,Ji,_i,qi;function Wi(t){return t>=Gi&&t<55204}function Zi(t,e){if(t>=Hi&&t<4371&&e>=Qi&&e<4470)return Gi+588*(t-Hi)+28*(e-Qi);if(Wi(t)&&e>ji&&e<4547&&(t-Gi)%28==0)return t+(e-ji);{let r=qi.get(t);return r&&(r=r.get(e),r)?r:-1}}function $i(t){Ki||function(){let t=Ii("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");Ki=new Map(Ri(t).flatMap(((t,e)=>t.map((t=>[t,e+1<<24]))))),Ji=new Set(Ci(t)),_i=new Map,qi=new Map;for(let[e,r]of Oi(t)){if(!Ji.has(e)&&2==r.length){let[t,n]=r,s=qi.get(t);s||(s=new Map,qi.set(t,s)),s.set(n,e)}_i.set(e,r.reverse())}}();let e=[],r=[],n=!1;function s(t){let r=Ki.get(t);r&&(n=!0,t|=r),e.push(t)}for(let n of t)for(;;){if(n<128)e.push(n);else if(Wi(n)){let t=n-Gi,e=t%588/28|0,r=t%28;s(Hi+(t/588|0)),s(Qi+e),r>0&&s(ji+r)}else{let t=_i.get(n);t?r.push(...t):s(n)}if(!r.length)break;n=r.pop()}if(n&&e.length>1){let t=zi(e[0]);for(let r=1;r<e.length;r++){let n=zi(e[r]);if(0==n||t<=n){t=n;continue}let s=r-1;for(;;){let r=e[s+1];if(e[s+1]=e[s],e[s]=r,!s)break;if(t=zi(e[--s]),t<=n)break}t=zi(e[r])}}return e}function Yi(t){return $i(t).map(Vi)}function Xi(t){return function(t){let e=[],r=[],n=-1,s=0;for(let i of t){let t=zi(i),o=Vi(i);if(-1==n)0==t?n=o:e.push(o);else if(s>0&&s>=t)0==t?(e.push(n,...r),r.length=0,n=o):r.push(o),s=t;else{let i=Zi(n,o);i>=0?n=i:0==s&&0==t?(e.push(n),n=o):(r.push(o),s=t)}}return n>=0&&e.push(n,...r),e}($i(t))}const to=t=>Array.from(t);function eo(t,e){return t.P.has(e)||t.Q.has(e)}class ro extends Array{get is_emoji(){return!0}}let no,so,io,oo,ao,co,lo,uo,ho,fo,po,go;function yo(){if(no)return;let t=Ii("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");const e=()=>Ci(t),r=()=>new Set(e()),n=(t,e)=>e.forEach((e=>t.add(e)));no=new Map(Oi(t)),so=r(),io=e(),oo=new Set(e().map((t=>io[t]))),io=new Set(io),ao=r(),co=r();let s=Ri(t),i=t();const o=()=>{let t=new Set;return e().forEach((e=>n(t,s[e]))),n(t,e()),t};lo=Si((e=>{let r=Si(t).map((t=>t+96));if(r.length){let n=e>=i;return r[0]-=32,r=Li(r),n&&(r=`Restricted[${r}]`),{N:r,P:o(),Q:o(),M:!t(),R:n}}})),uo=r(),ho=new Map;let a=e().concat(to(uo)).sort(((t,e)=>t-e));a.forEach(((e,r)=>{let n=t(),s=a[r]=n?a[r-n]:{V:[],M:new Map};s.V.push(e),uo.has(e)||ho.set(e,s)}));for(let{V:t,M:e}of new Set(ho.values())){let r=[];for(let e of t){let t=lo.filter((t=>eo(t,e))),s=r.find((({G:e})=>t.some((t=>e.has(t)))));s||(s={G:new Set,V:[]},r.push(s)),s.V.push(e),n(s.G,t)}let s=r.flatMap((t=>to(t.G)));for(let{G:t,V:n}of r){let r=new Set(s.filter((e=>!t.has(e))));for(let t of n)e.set(t,r)}}fo=new Set;let c=new Set;const l=t=>fo.has(t)?c.add(t):fo.add(t);for(let t of lo){for(let e of t.P)l(e);for(let e of t.Q)l(e)}for(let t of fo)ho.has(t)||c.has(t)||ho.set(t,1);n(fo,Yi(fo)),po=function(t){let e=[],r=Ci(t);return function t({S:r,B:n},s,i){if(!(4&r&&i===s[s.length-1])){2&r&&(i=s[s.length-1]),1&r&&e.push(s);for(let e of n)for(let r of e.Q)t(e,[...s,r],i)}}(function e(n){return{S:t(),B:Si((()=>{let n=Ci(t).map((t=>r[t]));if(n.length)return e(n)})),Q:n}}([]),[]),e}(t).map((t=>ro.from(t))).sort(Mi),go=new Map;for(let t of po){let e=[go];for(let r of t){let t=e.map((t=>{let e=t.get(r);return e||(e=new Map,t.set(r,e)),e}));65039===r?e.push(...t):e=t}for(let r of e)r.V=t}}function mo(t){return(Ao(t)?"":`${wo(bo([t]))} `)+Di(t)}function wo(t){return`"${t}"‚Äé`}function bo(t,e=1/0,r=Di){let n=[];var s;s=t[0],yo(),io.has(s)&&n.push("‚óå"),t.length>e&&(e>>=1,t=[...t.slice(0,e),8230,...t.slice(-e)]);let i=0,o=t.length;for(let e=0;e<o;e++){let s=t[e];Ao(s)&&(n.push(Li(t.slice(i,e))),n.push(r(s)),i=e+1)}return n.push(Li(t.slice(i,o))),n.join("")}function Ao(t){return yo(),ao.has(t)}function Eo(t,e,r){if(!t)return[];yo();let n=0;return t.split(".").map((t=>{let s=function(t){let e=[];for(let r=0,n=t.length;r<n;){let n=t.codePointAt(r);r+=n<65536?1:2,e.push(n)}return e}(t),i={input:s,offset:n};n+=s.length+1;try{let t,n=i.tokens=function(t,e,r){let n=[],s=[];for(t=t.slice().reverse();t.length;){let i=Io(t);if(i)s.length&&(n.push(e(s)),s=[]),n.push(r(i));else{let e=t.pop();if(fo.has(e))s.push(e);else{let t=no.get(e);if(t)s.push(...t);else if(!so.has(e))throw vo(e)}}}return s.length&&n.push(e(s)),n}(s,e,r),o=n.length;if(!o)throw new Error("empty label");let a=i.output=n.flat();if(function(t){for(let e=t.lastIndexOf(95);e>0;)if(95!==t[--e])throw new Error("underscore allowed only at start")}(a),!(i.emoji=o>1||n[0].is_emoji)&&a.every((t=>t<128)))!function(t){if(t.length>=4&&45==t[2]&&45==t[3])throw new Error(`invalid label extension: "${Li(t.slice(0,4))}"`)}(a),t="ASCII";else{let e=n.flatMap((t=>t.is_emoji?[]:t));if(e.length){if(io.has(a[0]))throw xo("leading combining mark");for(let t=1;t<o;t++){let e=n[t];if(!e.is_emoji&&io.has(e[0]))throw xo(`emoji + combining mark: "${Li(n[t-1])} + ${bo([e[0]])}"`)}!function(t){let e=t[0],r=Bi.get(e);if(r)throw xo(`leading ${r}`);let n=t.length,s=-1;for(let i=1;i<n;i++){e=t[i];let n=Bi.get(e);if(n){if(s==i)throw xo(`${r} + ${n}`);s=i+1,r=n}}if(s==n)throw xo(`trailing ${r}`)}(a);let r=to(new Set(e)),[s]=function(t){let e=lo;for(let r of t){let t=e.filter((t=>eo(t,r)));if(!t.length)throw lo.some((t=>eo(t,r)))?ko(e[0],r):vo(r);if(e=t,1==t.length)break}return e}(r);!function(t,e){for(let r of e)if(!eo(t,r))throw ko(t,r);if(t.M){let t=Yi(e);for(let e=1,r=t.length;e<r;e++)if(oo.has(t[e])){let n=e+1;for(let s;n<r&&oo.has(s=t[n]);n++)for(let r=e;r<n;r++)if(t[r]==s)throw new Error(`duplicate non-spacing marks: ${mo(s)}`);if(n-e>4)throw new Error(`excessive non-spacing marks: ${wo(bo(t.slice(e-1,n)))} (${n-e}/4)`);e=n}}}(s,e),function(t,e){let r,n=[];for(let t of e){let e=ho.get(t);if(1===e)return;if(e){let n=e.M.get(t);if(r=r?r.filter((t=>n.has(t))):to(n),!r.length)return}else n.push(t)}if(r)for(let e of r)if(n.every((t=>eo(e,t))))throw new Error(`whole-script confusable: ${t.N}/${e.N}`)}(s,r),t=s.N}else t="Emoji"}i.type=t}catch(t){i.error=t}return i}))}function vo(t){return new Error(`disallowed character: ${mo(t)}`)}function ko(t,e){let r=mo(e),n=lo.find((t=>t.P.has(e)));return n&&(r=`${n.N} ${r}`),new Error(`illegal mixture: ${t.N} + ${r}`)}function xo(t){return new Error(`illegal placement: ${t}`)}function Bo(t){return t.filter((t=>65039!=t))}function Io(t,e){let r,n=go,s=t.length;for(;s&&(n=n.get(t[--s]),n);){let{V:i}=n;i&&(r=i,e&&e.push(...t.slice(s).reverse()),t.length=s)}return r}const Po=new Uint8Array(32);function No(t){return _t(0!==t.length,"invalid ENS name; empty component","comp",t),t}function Co(t){const e=qr(function(t){try{if(0===t.length)throw new Error("empty label");return function(t){return function(t){return t.map((({input:e,error:r,output:n})=>{if(r){let n=r.message;throw new Error(1==t.length?n:`Invalid label ${wo(bo(e,63))}: ${n}`)}return Li(n)})).join(".")}(Eo(t,Xi,Bo))}(t)}catch(e){_t(!1,`invalid ENS name (${e.message})`,"name",t)}}(t)),r=[];if(0===t.length)return r;let n=0;for(let t=0;t<e.length;t++)46===e[t]&&(r.push(No(e.slice(n,t))),n=t+1);return _t(n<e.length,"invalid ENS name; empty component","name",t),r.push(No(e.slice(n))),r}function Ro(t){_t("string"==typeof t,"invalid ENS name; not a string","name",t),_t(t.length,"invalid ENS name (empty label)","name",t);let e=Po;const r=Co(t);for(;r.length;)e=br(se([e,br(r.pop())]));return ne(e)}function Oo(t,e){const r=null!=e?e:63;return _t(r<=255,"DNS encoded label cannot exceed 255","length",r),ne(se(Co(t).map((e=>{_t(e.length<=r,`label ${JSON.stringify(t)} exceeds ${r} bytes`,"name",t);const n=new Uint8Array(e.length+1);return n.set(e,1),n[0]=n.length-1,n}))))+"00"}Po.fill(0);class So extends Xe{constructor(t,e,r,n){super(),this.blockLen=t,this.outputLen=e,this.padOffset=r,this.isLE=n,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=Ze(this.buffer)}update(t){Ge(this);const{view:e,buffer:r,blockLen:n}=this,s=(t=Ye(t)).length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);if(o!==n)r.set(t.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===n&&(this.process(e,0),this.pos=0);else{const e=Ze(t);for(;n<=s-i;i+=n)this.process(e,i)}}return this.length+=t.length,this.roundClean(),this}digestInto(t){Ge(this),He(t,this),this.finished=!0;const{buffer:e,view:r,blockLen:n,isLE:s}=this;let{pos:i}=this;e[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>n-i&&(this.process(r,0),i=0);for(let t=i;t<n;t++)e[t]=0;!function(t,e,r,n){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,r,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(r>>s&i),a=Number(r&i),c=n?4:0,l=n?0:4;t.setUint32(e+c,o,n),t.setUint32(e+l,a,n)}(r,n-8,BigInt(8*this.length),s),this.process(r,0);const o=Ze(t),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=a/4,l=this.get();if(c>l.length)throw new Error("_sha2: outputLen bigger than state");for(let t=0;t<c;t++)o.setUint32(4*t,l[t],s)}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const r=t.slice(0,e);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:e,buffer:r,length:n,finished:s,destroyed:i,pos:o}=this;return t.length=n,t.pos=o,t.finished=s,t.destroyed=i,n%e&&t.buffer.set(r),t}}const To=(t,e,r)=>t&e^~t&r,Uo=(t,e,r)=>t&e^t&r^e&r,Fo=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Do=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Lo=new Uint32Array(64);class Mo extends So{constructor(){super(64,32,8,!1),this.A=0|Do[0],this.B=0|Do[1],this.C=0|Do[2],this.D=0|Do[3],this.E=0|Do[4],this.F=0|Do[5],this.G=0|Do[6],this.H=0|Do[7]}get(){const{A:t,B:e,C:r,D:n,E:s,F:i,G:o,H:a}=this;return[t,e,r,n,s,i,o,a]}set(t,e,r,n,s,i,o,a){this.A=0|t,this.B=0|e,this.C=0|r,this.D=0|n,this.E=0|s,this.F=0|i,this.G=0|o,this.H=0|a}process(t,e){for(let r=0;r<16;r++,e+=4)Lo[r]=t.getUint32(e,!1);for(let t=16;t<64;t++){const e=Lo[t-15],r=Lo[t-2],n=$e(e,7)^$e(e,18)^e>>>3,s=$e(r,17)^$e(r,19)^r>>>10;Lo[t]=s+Lo[t-7]+n+Lo[t-16]|0}let{A:r,B:n,C:s,D:i,E:o,F:a,G:c,H:l}=this;for(let t=0;t<64;t++){const e=l+($e(o,6)^$e(o,11)^$e(o,25))+To(o,a,c)+Fo[t]+Lo[t]|0,u=($e(r,2)^$e(r,13)^$e(r,22))+Uo(r,n,s)|0;l=c,c=a,a=o,o=i+e|0,i=s,s=n,n=r,r=e+u|0}r=r+this.A|0,n=n+this.B|0,s=s+this.C|0,i=i+this.D|0,o=o+this.E|0,a=a+this.F|0,c=c+this.G|0,l=l+this.H|0,this.set(r,n,s,i,o,a,c,l)}roundClean(){Lo.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const Go=tr((()=>new Mo)),[Ho,Qo]=(()=>We.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map((t=>BigInt(t)))))(),jo=new Uint32Array(80),zo=new Uint32Array(80);class Vo extends So{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:t,Al:e,Bh:r,Bl:n,Ch:s,Cl:i,Dh:o,Dl:a,Eh:c,El:l,Fh:u,Fl:h,Gh:f,Gl:d,Hh:p,Hl:g}=this;return[t,e,r,n,s,i,o,a,c,l,u,h,f,d,p,g]}set(t,e,r,n,s,i,o,a,c,l,u,h,f,d,p,g){this.Ah=0|t,this.Al=0|e,this.Bh=0|r,this.Bl=0|n,this.Ch=0|s,this.Cl=0|i,this.Dh=0|o,this.Dl=0|a,this.Eh=0|c,this.El=0|l,this.Fh=0|u,this.Fl=0|h,this.Gh=0|f,this.Gl=0|d,this.Hh=0|p,this.Hl=0|g}process(t,e){for(let r=0;r<16;r++,e+=4)jo[r]=t.getUint32(e),zo[r]=t.getUint32(e+=4);for(let t=16;t<80;t++){const e=0|jo[t-15],r=0|zo[t-15],n=We.rotrSH(e,r,1)^We.rotrSH(e,r,8)^We.shrSH(e,r,7),s=We.rotrSL(e,r,1)^We.rotrSL(e,r,8)^We.shrSL(e,r,7),i=0|jo[t-2],o=0|zo[t-2],a=We.rotrSH(i,o,19)^We.rotrBH(i,o,61)^We.shrSH(i,o,6),c=We.rotrSL(i,o,19)^We.rotrBL(i,o,61)^We.shrSL(i,o,6),l=We.add4L(s,c,zo[t-7],zo[t-16]),u=We.add4H(l,n,a,jo[t-7],jo[t-16]);jo[t]=0|u,zo[t]=0|l}let{Ah:r,Al:n,Bh:s,Bl:i,Ch:o,Cl:a,Dh:c,Dl:l,Eh:u,El:h,Fh:f,Fl:d,Gh:p,Gl:g,Hh:y,Hl:m}=this;for(let t=0;t<80;t++){const e=We.rotrSH(u,h,14)^We.rotrSH(u,h,18)^We.rotrBH(u,h,41),w=We.rotrSL(u,h,14)^We.rotrSL(u,h,18)^We.rotrBL(u,h,41),b=u&f^~u&p,A=h&d^~h&g,E=We.add5L(m,w,A,Qo[t],zo[t]),v=We.add5H(E,y,e,b,Ho[t],jo[t]),k=0|E,x=We.rotrSH(r,n,28)^We.rotrBH(r,n,34)^We.rotrBH(r,n,39),B=We.rotrSL(r,n,28)^We.rotrBL(r,n,34)^We.rotrBL(r,n,39),I=r&s^r&o^s&o,P=n&i^n&a^i&a;y=0|p,m=0|g,p=0|f,g=0|d,f=0|u,d=0|h,({h:u,l:h}=We.add(0|c,0|l,0|v,0|k)),c=0|o,l=0|a,o=0|s,a=0|i,s=0|r,i=0|n;const N=We.add3L(k,B,P);r=We.add3H(N,v,x,I),n=0|N}({h:r,l:n}=We.add(0|this.Ah,0|this.Al,0|r,0|n)),({h:s,l:i}=We.add(0|this.Bh,0|this.Bl,0|s,0|i)),({h:o,l:a}=We.add(0|this.Ch,0|this.Cl,0|o,0|a)),({h:c,l}=We.add(0|this.Dh,0|this.Dl,0|c,0|l)),({h:u,l:h}=We.add(0|this.Eh,0|this.El,0|u,0|h)),({h:f,l:d}=We.add(0|this.Fh,0|this.Fl,0|f,0|d)),({h:p,l:g}=We.add(0|this.Gh,0|this.Gl,0|p,0|g)),({h:y,l:m}=We.add(0|this.Hh,0|this.Hl,0|y,0|m)),this.set(r,n,s,i,o,a,c,l,u,h,f,d,p,g,y,m)}roundClean(){jo.fill(0),zo.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const Ko=tr((()=>new Vo)),Jo=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("unable to locate global object")}();function _o(t){switch(t){case"sha256":return Go.create();case"sha512":return Ko.create()}_t(!1,"invalid hashing algorithm name","algorithm",t)}Jo.crypto||Jo.msCrypto;const qo=function(t){return _o("sha256").update(t).digest()},Wo=function(t){return _o("sha512").update(t).digest()};let Zo=qo,$o=Wo,Yo=!1,Xo=!1;function ta(t){const e=Yt(t,"data");return ne(Zo(e))}function ea(t){const e=Yt(t,"data");return ne($o(e))}ta._=qo,ta.lock=function(){Yo=!0},ta.register=function(t){if(Yo)throw new Error("sha256 is locked");Zo=t},Object.freeze(ta),ea._=Wo,ea.lock=function(){Xo=!0},ea.register=function(t){if(Xo)throw new Error("sha512 is locked");$o=t},Object.freeze(ta);const ra="0x0000000000000000000000000000000000000000000000000000000000000000",na=BigInt(0),sa=BigInt(1),ia=BigInt(2),oa=BigInt(27),aa=BigInt(28),ca=BigInt(35),la={};function ua(t){return ce(Ee(t),32)}class ha{#X;#tt;#et;#rt;get r(){return this.#X}set r(t){_t(32===ie(t),"invalid r","value",t),this.#X=ne(t)}get s(){return this.#tt}set s(t){_t(32===ie(t),"invalid s","value",t);const e=ne(t);_t(parseInt(e.substring(0,3))<8,"non-canonical s","value",e),this.#tt=e}get v(){return this.#et}set v(t){const e=be(t,"value");_t(27===e||28===e,"invalid v","v",t),this.#et=e}get networkV(){return this.#rt}get legacyChainId(){const t=this.networkV;return null==t?null:ha.getChainId(t)}get yParity(){return 27===this.v?0:1}get yParityAndS(){const t=Yt(this.s);return this.yParity&&(t[0]|=128),ne(t)}get compactSerialized(){return se([this.r,this.yParityAndS])}get serialized(){return se([this.r,this.s,this.yParity?"0x1c":"0x1b"])}constructor(t,e,r,n){Zt(t,la,"Signature"),this.#X=e,this.#tt=r,this.#et=n,this.#rt=null}[Symbol.for("nodejs.util.inspect.custom")](){return`Signature { r: "${this.r}", s: "${this.s}", yParity: ${this.yParity}, networkV: ${this.networkV} }`}clone(){const t=new ha(la,this.r,this.s,this.v);return this.networkV&&(t.#rt=this.networkV),t}toJSON(){const t=this.networkV;return{_type:"signature",networkV:null!=t?t.toString():null,r:this.r,s:this.s,v:this.v}}static getChainId(t){const e=ge(t,"v");return e==oa||e==aa?na:(_t(e>=ca,"invalid EIP-155 v","v",t),(e-ca)/ia)}static getChainIdV(t,e){return ge(t)*ia+BigInt(35+e-27)}static getNormalizedV(t){const e=ge(t);return e===na||e===oa?27:e===sa||e===aa?28:(_t(e>=ca,"invalid v","v",t),e&sa?27:28)}static from(t){function e(e,r){_t(e,r,"signature",t)}if(null==t)return new ha(la,ra,ra,27);if("string"==typeof t){const r=Yt(t,"signature");if(64===r.length){const t=ne(r.slice(0,32)),e=r.slice(32,64),n=128&e[0]?28:27;return e[0]&=127,new ha(la,t,ne(e),n)}if(65===r.length){const t=ne(r.slice(0,32)),n=r.slice(32,64);e(!(128&n[0]),"non-canonical s");const s=ha.getNormalizedV(r[64]);return new ha(la,t,ne(n),s)}e(!1,"invalid raw signature length")}if(t instanceof ha)return t.clone();const r=t.r;e(null!=r,"missing r");const n=ua(r),s=function(t,r){if(null!=t)return ua(t);if(null!=r){e(te(r,32),"invalid yParityAndS");const t=Yt(r);return t[0]&=127,ne(t)}e(!1,"missing s")}(t.s,t.yParityAndS);e(!(128&Yt(s)[0]),"non-canonical s");const{networkV:i,v:o}=function(t,r,n){if(null!=t){const e=ge(t);return{networkV:e>=ca?e:void 0,v:ha.getNormalizedV(e)}}if(null!=r)return e(te(r,32),"invalid yParityAndS"),{v:128&Yt(r)[0]?28:27};if(null!=n){switch(be(n,"sig.yParity")){case 0:return{v:27};case 1:return{v:28}}e(!1,"invalid yParity")}e(!1,"missing v")}(t.v,t.yParityAndS,t.yParity),a=new ha(la,n,s,o);return i&&(a.#rt=i),e(null==t.yParity||be(t.yParity,"sig.yParity")===a.yParity,"yParity mismatch"),e(null==t.yParityAndS||t.yParityAndS===a.yParityAndS,"yParityAndS mismatch"),a}}function fa(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function da(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function pa(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}const ga="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0,ya=t=>t instanceof Uint8Array,ma=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),wa=(t,e)=>t<<32-e|t>>>e;if(68!==new Uint8Array(new Uint32Array([287454020]).buffer)[0])throw new Error("Non little-endian hardware is not supported");function ba(t){if("string"==typeof t&&(t=function(t){if("string"!=typeof t)throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array((new TextEncoder).encode(t))}(t)),!ya(t))throw new Error("expected Uint8Array, got "+typeof t);return t}class Aa{clone(){return this._cloneInto()}}function Ea(t){const e=e=>t().update(ba(e)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function va(t=32){if(ga&&"function"==typeof ga.getRandomValues)return ga.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}class ka extends Aa{constructor(t,e,r,n){super(),this.blockLen=t,this.outputLen=e,this.padOffset=r,this.isLE=n,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=ma(this.buffer)}update(t){pa(this);const{view:e,buffer:r,blockLen:n}=this,s=(t=ba(t)).length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);if(o!==n)r.set(t.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===n&&(this.process(e,0),this.pos=0);else{const e=ma(t);for(;n<=s-i;i+=n)this.process(e,i)}}return this.length+=t.length,this.roundClean(),this}digestInto(t){pa(this),function(t,e){da(t);const r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}(t,this),this.finished=!0;const{buffer:e,view:r,blockLen:n,isLE:s}=this;let{pos:i}=this;e[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>n-i&&(this.process(r,0),i=0);for(let t=i;t<n;t++)e[t]=0;!function(t,e,r,n){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,r,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(r>>s&i),a=Number(r&i),c=n?4:0,l=n?0:4;t.setUint32(e+c,o,n),t.setUint32(e+l,a,n)}(r,n-8,BigInt(8*this.length),s),this.process(r,0);const o=ma(t),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=a/4,l=this.get();if(c>l.length)throw new Error("_sha2: outputLen bigger than state");for(let t=0;t<c;t++)o.setUint32(4*t,l[t],s)}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const r=t.slice(0,e);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:e,buffer:r,length:n,finished:s,destroyed:i,pos:o}=this;return t.length=n,t.pos=o,t.finished=s,t.destroyed=i,n%e&&t.buffer.set(r),t}}const xa=(t,e,r)=>t&e^~t&r,Ba=(t,e,r)=>t&e^t&r^e&r,Ia=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Pa=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Na=new Uint32Array(64);class Ca extends ka{constructor(){super(64,32,8,!1),this.A=0|Pa[0],this.B=0|Pa[1],this.C=0|Pa[2],this.D=0|Pa[3],this.E=0|Pa[4],this.F=0|Pa[5],this.G=0|Pa[6],this.H=0|Pa[7]}get(){const{A:t,B:e,C:r,D:n,E:s,F:i,G:o,H:a}=this;return[t,e,r,n,s,i,o,a]}set(t,e,r,n,s,i,o,a){this.A=0|t,this.B=0|e,this.C=0|r,this.D=0|n,this.E=0|s,this.F=0|i,this.G=0|o,this.H=0|a}process(t,e){for(let r=0;r<16;r++,e+=4)Na[r]=t.getUint32(e,!1);for(let t=16;t<64;t++){const e=Na[t-15],r=Na[t-2],n=wa(e,7)^wa(e,18)^e>>>3,s=wa(r,17)^wa(r,19)^r>>>10;Na[t]=s+Na[t-7]+n+Na[t-16]|0}let{A:r,B:n,C:s,D:i,E:o,F:a,G:c,H:l}=this;for(let t=0;t<64;t++){const e=l+(wa(o,6)^wa(o,11)^wa(o,25))+xa(o,a,c)+Ia[t]+Na[t]|0,u=(wa(r,2)^wa(r,13)^wa(r,22))+Ba(r,n,s)|0;l=c,c=a,a=o,o=i+e|0,i=s,s=n,n=r,r=e+u|0}r=r+this.A|0,n=n+this.B|0,s=s+this.C|0,i=i+this.D|0,o=o+this.E|0,a=a+this.F|0,c=c+this.G|0,l=l+this.H|0,this.set(r,n,s,i,o,a,c,l)}roundClean(){Na.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const Ra=Ea((()=>new Ca)),Oa=(BigInt(0),BigInt(1)),Sa=BigInt(2),Ta=t=>t instanceof Uint8Array,Ua=Array.from({length:256},((t,e)=>e.toString(16).padStart(2,"0")));function Fa(t){if(!Ta(t))throw new Error("Uint8Array expected");let e="";for(let r=0;r<t.length;r++)e+=Ua[t[r]];return e}function Da(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);return BigInt(""===t?"0":`0x${t}`)}function La(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);const e=t.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const r=new Uint8Array(e/2);for(let e=0;e<r.length;e++){const n=2*e,s=t.slice(n,n+2),i=Number.parseInt(s,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");r[e]=i}return r}function Ma(t){return Da(Fa(t))}function Ga(t){if(!Ta(t))throw new Error("Uint8Array expected");return Da(Fa(Uint8Array.from(t).reverse()))}function Ha(t,e){return La(t.toString(16).padStart(2*e,"0"))}function Qa(t,e){return Ha(t,e).reverse()}function ja(t,e,r){let n;if("string"==typeof e)try{n=La(e)}catch(r){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${r}`)}else{if(!Ta(e))throw new Error(`${t} must be hex string or Uint8Array`);n=Uint8Array.from(e)}const s=n.length;if("number"==typeof r&&s!==r)throw new Error(`${t} expected ${r} bytes, got ${s}`);return n}function za(...t){const e=new Uint8Array(t.reduce(((t,e)=>t+e.length),0));let r=0;return t.forEach((t=>{if(!Ta(t))throw new Error("Uint8Array expected");e.set(t,r),r+=t.length})),e}const Va=t=>(Sa<<BigInt(t-1))-Oa,Ka=t=>new Uint8Array(t),Ja=t=>Uint8Array.from(t);function _a(t,e,r){if("number"!=typeof t||t<2)throw new Error("hashLen must be a number");if("number"!=typeof e||e<2)throw new Error("qByteLen must be a number");if("function"!=typeof r)throw new Error("hmacFn must be a function");let n=Ka(t),s=Ka(t),i=0;const o=()=>{n.fill(1),s.fill(0),i=0},a=(...t)=>r(s,n,...t),c=(t=Ka())=>{s=a(Ja([0]),t),n=a(),0!==t.length&&(s=a(Ja([1]),t),n=a())},l=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let t=0;const r=[];for(;t<e;){n=a();const e=n.slice();r.push(e),t+=n.length}return za(...r)};return(t,e)=>{let r;for(o(),c(t);!(r=e(l()));)c();return o(),r}}const qa={bigint:t=>"bigint"==typeof t,function:t=>"function"==typeof t,boolean:t=>"boolean"==typeof t,string:t=>"string"==typeof t,stringOrUint8Array:t=>"string"==typeof t||t instanceof Uint8Array,isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>"function"==typeof t&&Number.isSafeInteger(t.outputLen)};function Wa(t,e,r={}){const n=(e,r,n)=>{const s=qa[r];if("function"!=typeof s)throw new Error(`Invalid validator "${r}", expected function`);const i=t[e];if(!(n&&void 0===i||s(i,t)))throw new Error(`Invalid param ${String(e)}=${i} (${typeof i}), expected ${r}`)};for(const[t,r]of Object.entries(e))n(t,r,!1);for(const[t,e]of Object.entries(r))n(t,e,!0);return t}const Za=BigInt(0),$a=BigInt(1),Ya=BigInt(2),Xa=BigInt(3),tc=BigInt(4),ec=BigInt(5),rc=BigInt(8);function nc(t,e){const r=t%e;return r>=Za?r:e+r}function sc(t,e,r){if(r<=Za||e<Za)throw new Error("Expected power/modulo > 0");if(r===$a)return Za;let n=$a;for(;e>Za;)e&$a&&(n=n*t%r),t=t*t%r,e>>=$a;return n}function ic(t,e,r){let n=t;for(;e-- >Za;)n*=n,n%=r;return n}function oc(t,e){if(t===Za||e<=Za)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=nc(t,e),n=e,s=Za,i=$a,o=$a,a=Za;for(;r!==Za;){const t=n/r,e=n%r,c=s-o*t,l=i-a*t;n=r,r=e,s=o,i=a,o=c,a=l}if(n!==$a)throw new Error("invert: does not exist");return nc(s,e)}BigInt(9),BigInt(16);const ac=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function cc(t,e){const r=void 0!==e?e:t.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}function lc(t){if("bigint"!=typeof t)throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function uc(t){const e=lc(t);return e+Math.ceil(e/2)}class hc extends Aa{constructor(t,e){super(),this.finished=!1,this.destroyed=!1,function(t){if("function"!=typeof t||"function"!=typeof t.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");fa(t.outputLen),fa(t.blockLen)}(t);const r=ba(e);if(this.iHash=t.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const n=this.blockLen,s=new Uint8Array(n);s.set(r.length>n?t.create().update(r).digest():r);for(let t=0;t<s.length;t++)s[t]^=54;this.iHash.update(s),this.oHash=t.create();for(let t=0;t<s.length;t++)s[t]^=106;this.oHash.update(s),s.fill(0)}update(t){return pa(this),this.iHash.update(t),this}digestInto(t){pa(this),da(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:e,iHash:r,finished:n,destroyed:s,blockLen:i,outputLen:o}=this;return t.finished=n,t.destroyed=s,t.blockLen=i,t.outputLen=o,t.oHash=e._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const fc=(t,e,r)=>new hc(t,e).update(r).digest();fc.create=(t,e)=>new hc(t,e);const dc=BigInt(0),pc=BigInt(1);function gc(t){return Wa(t.Fp,ac.reduce(((t,e)=>(t[e]="function",t)),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"})),Wa(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...cc(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}const{Ph:yc,aT:mc}=t,wc={Err:class extends Error{constructor(t=""){super(t)}},_parseInt(t){const{Err:e}=wc;if(t.length<2||2!==t[0])throw new e("Invalid signature integer tag");const r=t[1],n=t.subarray(2,r+2);if(!r||n.length!==r)throw new e("Invalid signature integer: wrong length");if(128&n[0])throw new e("Invalid signature integer: negative");if(0===n[0]&&!(128&n[1]))throw new e("Invalid signature integer: unnecessary leading zero");return{d:yc(n),l:t.subarray(r+2)}},toSig(t){const{Err:e}=wc,r="string"==typeof t?mc(t):t;if(!(r instanceof Uint8Array))throw new Error("ui8a expected");let n=r.length;if(n<2||48!=r[0])throw new e("Invalid signature tag");if(r[1]!==n-2)throw new e("Invalid signature: incorrect length");const{d:s,l:i}=wc._parseInt(r.subarray(2)),{d:o,l:a}=wc._parseInt(i);if(a.length)throw new e("Invalid signature: left bytes after parsing");return{r:s,s:o}},hexFromSig(t){const e=t=>8&Number.parseInt(t[0],16)?"00"+t:t,r=t=>{const e=t.toString(16);return 1&e.length?`0${e}`:e},n=e(r(t.s)),s=e(r(t.r)),i=n.length/2,o=s.length/2,a=r(i),c=r(o);return`30${r(o+i+4)}02${c}${s}02${a}${n}`}},bc=BigInt(0),Ac=BigInt(1),Ec=(BigInt(2),BigInt(3));function vc(t){const e=function(t){const e=gc(t);return Wa(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}(t),{Fp:r,n}=e,s=r.BYTES+1,i=2*r.BYTES+1;function o(t){return nc(t,n)}function a(t){return oc(t,n)}const{ProjectivePoint:c,normPrivateKeyToScalar:l,weierstrassEquation:u,isWithinCurveOrder:h}=function(t){const e=function(t){const e=gc(t);Wa(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:r,Fp:n,a:s}=e;if(r){if(!n.eql(s,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if("object"!=typeof r||"bigint"!=typeof r.beta||"function"!=typeof r.splitScalar)throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}(t),{Fp:r}=e,n=e.toBytes||((t,e,n)=>{const s=e.toAffine();return za(Uint8Array.from([4]),r.toBytes(s.x),r.toBytes(s.y))}),s=e.fromBytes||(t=>{const e=t.subarray(1);return{x:r.fromBytes(e.subarray(0,r.BYTES)),y:r.fromBytes(e.subarray(r.BYTES,2*r.BYTES))}});function i(t){const{a:n,b:s}=e,i=r.sqr(t),o=r.mul(i,t);return r.add(r.add(o,r.mul(t,n)),s)}if(!r.eql(r.sqr(e.Gy),i(e.Gx)))throw new Error("bad generator point: equation left != right");function o(t){return"bigint"==typeof t&&bc<t&&t<e.n}function a(t){if(!o(t))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(t){const{allowedPrivateKeyLengths:r,nByteLength:n,wrapPrivateKey:s,n:i}=e;if(r&&"bigint"!=typeof t){if(t instanceof Uint8Array&&(t=Fa(t)),"string"!=typeof t||!r.includes(t.length))throw new Error("Invalid key");t=t.padStart(2*n,"0")}let o;try{o="bigint"==typeof t?t:Ma(ja("private key",t,n))}catch(e){throw new Error(`private key must be ${n} bytes, hex or bigint, not ${typeof t}`)}return s&&(o=nc(o,i)),a(o),o}const l=new Map;function u(t){if(!(t instanceof h))throw new Error("ProjectivePoint expected")}class h{constructor(t,e,n){if(this.px=t,this.py=e,this.pz=n,null==t||!r.isValid(t))throw new Error("x required");if(null==e||!r.isValid(e))throw new Error("y required");if(null==n||!r.isValid(n))throw new Error("z required")}static fromAffine(t){const{x:e,y:n}=t||{};if(!t||!r.isValid(e)||!r.isValid(n))throw new Error("invalid affine point");if(t instanceof h)throw new Error("projective point not allowed");const s=t=>r.eql(t,r.ZERO);return s(e)&&s(n)?h.ZERO:new h(e,n,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(t){const e=r.invertBatch(t.map((t=>t.pz)));return t.map(((t,r)=>t.toAffine(e[r]))).map(h.fromAffine)}static fromHex(t){const e=h.fromAffine(s(ja("pointHex",t)));return e.assertValidity(),e}static fromPrivateKey(t){return h.BASE.multiply(c(t))}_setWindowSize(t){this._WINDOW_SIZE=t,l.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!r.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:t,y:n}=this.toAffine();if(!r.isValid(t)||!r.isValid(n))throw new Error("bad point: x or y not FE");const s=r.sqr(n),o=i(t);if(!r.eql(s,o))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:t}=this.toAffine();if(r.isOdd)return!r.isOdd(t);throw new Error("Field doesn't support isOdd")}equals(t){u(t);const{px:e,py:n,pz:s}=this,{px:i,py:o,pz:a}=t,c=r.eql(r.mul(e,a),r.mul(i,s)),l=r.eql(r.mul(n,a),r.mul(o,s));return c&&l}negate(){return new h(this.px,r.neg(this.py),this.pz)}double(){const{a:t,b:n}=e,s=r.mul(n,Ec),{px:i,py:o,pz:a}=this;let c=r.ZERO,l=r.ZERO,u=r.ZERO,f=r.mul(i,i),d=r.mul(o,o),p=r.mul(a,a),g=r.mul(i,o);return g=r.add(g,g),u=r.mul(i,a),u=r.add(u,u),c=r.mul(t,u),l=r.mul(s,p),l=r.add(c,l),c=r.sub(d,l),l=r.add(d,l),l=r.mul(c,l),c=r.mul(g,c),u=r.mul(s,u),p=r.mul(t,p),g=r.sub(f,p),g=r.mul(t,g),g=r.add(g,u),u=r.add(f,f),f=r.add(u,f),f=r.add(f,p),f=r.mul(f,g),l=r.add(l,f),p=r.mul(o,a),p=r.add(p,p),f=r.mul(p,g),c=r.sub(c,f),u=r.mul(p,d),u=r.add(u,u),u=r.add(u,u),new h(c,l,u)}add(t){u(t);const{px:n,py:s,pz:i}=this,{px:o,py:a,pz:c}=t;let l=r.ZERO,f=r.ZERO,d=r.ZERO;const p=e.a,g=r.mul(e.b,Ec);let y=r.mul(n,o),m=r.mul(s,a),w=r.mul(i,c),b=r.add(n,s),A=r.add(o,a);b=r.mul(b,A),A=r.add(y,m),b=r.sub(b,A),A=r.add(n,i);let E=r.add(o,c);return A=r.mul(A,E),E=r.add(y,w),A=r.sub(A,E),E=r.add(s,i),l=r.add(a,c),E=r.mul(E,l),l=r.add(m,w),E=r.sub(E,l),d=r.mul(p,A),l=r.mul(g,w),d=r.add(l,d),l=r.sub(m,d),d=r.add(m,d),f=r.mul(l,d),m=r.add(y,y),m=r.add(m,y),w=r.mul(p,w),A=r.mul(g,A),m=r.add(m,w),w=r.sub(y,w),w=r.mul(p,w),A=r.add(A,w),y=r.mul(m,A),f=r.add(f,y),y=r.mul(E,A),l=r.mul(b,l),l=r.sub(l,y),y=r.mul(b,m),d=r.mul(E,d),d=r.add(d,y),new h(l,f,d)}subtract(t){return this.add(t.negate())}is0(){return this.equals(h.ZERO)}wNAF(t){return d.wNAFCached(this,l,t,(t=>{const e=r.invertBatch(t.map((t=>t.pz)));return t.map(((t,r)=>t.toAffine(e[r]))).map(h.fromAffine)}))}multiplyUnsafe(t){const n=h.ZERO;if(t===bc)return n;if(a(t),t===Ac)return this;const{endo:s}=e;if(!s)return d.unsafeLadder(this,t);let{k1neg:i,k1:o,k2neg:c,k2:l}=s.splitScalar(t),u=n,f=n,p=this;for(;o>bc||l>bc;)o&Ac&&(u=u.add(p)),l&Ac&&(f=f.add(p)),p=p.double(),o>>=Ac,l>>=Ac;return i&&(u=u.negate()),c&&(f=f.negate()),f=new h(r.mul(f.px,s.beta),f.py,f.pz),u.add(f)}multiply(t){a(t);let n,s,i=t;const{endo:o}=e;if(o){const{k1neg:t,k1:e,k2neg:a,k2:c}=o.splitScalar(i);let{p:l,f:u}=this.wNAF(e),{p:f,f:p}=this.wNAF(c);l=d.constTimeNegate(t,l),f=d.constTimeNegate(a,f),f=new h(r.mul(f.px,o.beta),f.py,f.pz),n=l.add(f),s=u.add(p)}else{const{p:t,f:e}=this.wNAF(i);n=t,s=e}return h.normalizeZ([n,s])[0]}multiplyAndAddUnsafe(t,e,r){const n=h.BASE,s=(t,e)=>e!==bc&&e!==Ac&&t.equals(n)?t.multiply(e):t.multiplyUnsafe(e),i=s(this,e).add(s(t,r));return i.is0()?void 0:i}toAffine(t){const{px:e,py:n,pz:s}=this,i=this.is0();null==t&&(t=i?r.ONE:r.inv(s));const o=r.mul(e,t),a=r.mul(n,t),c=r.mul(s,t);if(i)return{x:r.ZERO,y:r.ZERO};if(!r.eql(c,r.ONE))throw new Error("invZ was invalid");return{x:o,y:a}}isTorsionFree(){const{h:t,isTorsionFree:r}=e;if(t===Ac)return!0;if(r)return r(h,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:t,clearCofactor:r}=e;return t===Ac?this:r?r(h,this):this.multiplyUnsafe(e.h)}toRawBytes(t=!0){return this.assertValidity(),n(h,this,t)}toHex(t=!0){return Fa(this.toRawBytes(t))}}h.BASE=new h(e.Gx,e.Gy,r.ONE),h.ZERO=new h(r.ZERO,r.ONE,r.ZERO);const f=e.nBitLength,d=function(t,e){const r=(t,e)=>{const r=e.negate();return t?r:e},n=t=>({windows:Math.ceil(e/t)+1,windowSize:2**(t-1)});return{constTimeNegate:r,unsafeLadder(e,r){let n=t.ZERO,s=e;for(;r>dc;)r&pc&&(n=n.add(s)),s=s.double(),r>>=pc;return n},precomputeWindow(t,e){const{windows:r,windowSize:s}=n(e),i=[];let o=t,a=o;for(let t=0;t<r;t++){a=o,i.push(a);for(let t=1;t<s;t++)a=a.add(o),i.push(a);o=a.double()}return i},wNAF(e,s,i){const{windows:o,windowSize:a}=n(e);let c=t.ZERO,l=t.BASE;const u=BigInt(2**e-1),h=2**e,f=BigInt(e);for(let t=0;t<o;t++){const e=t*a;let n=Number(i&u);i>>=f,n>a&&(n-=h,i+=pc);const o=e,d=e+Math.abs(n)-1,p=t%2!=0,g=n<0;0===n?l=l.add(r(p,s[o])):c=c.add(r(g,s[d]))}return{p:c,f:l}},wNAFCached(t,e,r,n){const s=t._WINDOW_SIZE||1;let i=e.get(t);return i||(i=this.precomputeWindow(t,s),1!==s&&e.set(t,n(i))),this.wNAF(s,i,r)}}}(h,e.endo?Math.ceil(f/2):f);return{CURVE:e,ProjectivePoint:h,normPrivateKeyToScalar:c,weierstrassEquation:i,isWithinCurveOrder:o}}({...e,toBytes(t,e,n){const s=e.toAffine(),i=r.toBytes(s.x),o=za;return n?o(Uint8Array.from([e.hasEvenY()?2:3]),i):o(Uint8Array.from([4]),i,r.toBytes(s.y))},fromBytes(t){const e=t.length,n=t[0],o=t.subarray(1);if(e!==s||2!==n&&3!==n){if(e===i&&4===n)return{x:r.fromBytes(o.subarray(0,r.BYTES)),y:r.fromBytes(o.subarray(r.BYTES,2*r.BYTES))};throw new Error(`Point of length ${e} was invalid. Expected ${s} compressed bytes or ${i} uncompressed bytes`)}{const t=Ma(o);if(!(bc<(a=t)&&a<r.ORDER))throw new Error("Point is not on curve");const e=u(t);let s=r.sqrt(e);return!(1&~n)!=((s&Ac)===Ac)&&(s=r.neg(s)),{x:t,y:s}}var a}}),f=t=>Fa(Ha(t,e.nByteLength));function d(t){return t>n>>Ac}const p=(t,e,r)=>Ma(t.slice(e,r));class g{constructor(t,e,r){this.r=t,this.s=e,this.recovery=r,this.assertValidity()}static fromCompact(t){const r=e.nByteLength;return t=ja("compactSignature",t,2*r),new g(p(t,0,r),p(t,r,2*r))}static fromDER(t){const{r:e,s:r}=wc.toSig(ja("DER",t));return new g(e,r)}assertValidity(){if(!h(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!h(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(t){return new g(this.r,this.s,t)}recoverPublicKey(t){const{r:n,s,recovery:i}=this,l=b(ja("msgHash",t));if(null==i||![0,1,2,3].includes(i))throw new Error("recovery id invalid");const u=2===i||3===i?n+e.n:n;if(u>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");const h=1&i?"03":"02",d=c.fromHex(h+f(u)),p=a(u),g=o(-l*p),y=o(s*p),m=c.BASE.multiplyAndAddUnsafe(d,g,y);if(!m)throw new Error("point at infinify");return m.assertValidity(),m}hasHighS(){return d(this.s)}normalizeS(){return this.hasHighS()?new g(this.r,o(-this.s),this.recovery):this}toDERRawBytes(){return La(this.toDERHex())}toDERHex(){return wc.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return La(this.toCompactHex())}toCompactHex(){return f(this.r)+f(this.s)}}const y={isValidPrivateKey(t){try{return l(t),!0}catch(t){return!1}},normPrivateKeyToScalar:l,randomPrivateKey:()=>{const t=uc(e.n);return function(t,e,r=!1){const n=t.length,s=lc(e),i=uc(e);if(n<16||n<i||n>1024)throw new Error(`expected ${i}-1024 bytes of input, got ${n}`);const o=nc(r?Ma(t):Ga(t),e-$a)+$a;return r?Qa(o,s):Ha(o,s)}(e.randomBytes(t),e.n)},precompute:(t=8,e=c.BASE)=>(e._setWindowSize(t),e.multiply(BigInt(3)),e)};function m(t){const e=t instanceof Uint8Array,r="string"==typeof t,n=(e||r)&&t.length;return e?n===s||n===i:r?n===2*s||n===2*i:t instanceof c}const w=e.bits2int||function(t){const r=Ma(t),n=8*t.length-e.nBitLength;return n>0?r>>BigInt(n):r},b=e.bits2int_modN||function(t){return o(w(t))},A=Va(e.nBitLength);function E(t){if("bigint"!=typeof t)throw new Error("bigint expected");if(!(bc<=t&&t<A))throw new Error(`bigint expected < 2^${e.nBitLength}`);return Ha(t,e.nByteLength)}const v={lowS:e.lowS,prehash:!1},k={lowS:e.lowS,prehash:!1};return c.BASE._setWindowSize(8),{CURVE:e,getPublicKey:function(t,e=!0){return c.fromPrivateKey(t).toRawBytes(e)},getSharedSecret:function(t,e,r=!0){if(m(t))throw new Error("first arg must be private key");if(!m(e))throw new Error("second arg must be public key");return c.fromHex(e).multiply(l(t)).toRawBytes(r)},sign:function(t,n,s=v){const{seed:i,k2sig:u}=function(t,n,s=v){if(["recovered","canonical"].some((t=>t in s)))throw new Error("sign() legacy options not supported");const{hash:i,randomBytes:u}=e;let{lowS:f,prehash:p,extraEntropy:y}=s;null==f&&(f=!0),t=ja("msgHash",t),p&&(t=ja("prehashed msgHash",i(t)));const m=b(t),A=l(n),k=[E(A),E(m)];if(null!=y){const t=!0===y?u(r.BYTES):y;k.push(ja("extraEntropy",t))}const x=za(...k),B=m;return{seed:x,k2sig:function(t){const e=w(t);if(!h(e))return;const r=a(e),n=c.BASE.multiply(e).toAffine(),s=o(n.x);if(s===bc)return;const i=o(r*o(B+s*A));if(i===bc)return;let l=(n.x===s?0:2)|Number(n.y&Ac),u=i;return f&&d(i)&&(u=function(t){return d(t)?o(-t):t}(i),l^=1),new g(s,u,l)}}}(t,n,s),f=e;return _a(f.hash.outputLen,f.nByteLength,f.hmac)(i,u)},verify:function(t,r,n,s=k){const i=t;if(r=ja("msgHash",r),n=ja("publicKey",n),"strict"in s)throw new Error("options.strict was renamed to lowS");const{lowS:l,prehash:u}=s;let h,f;try{if("string"==typeof i||i instanceof Uint8Array)try{h=g.fromDER(i)}catch(t){if(!(t instanceof wc.Err))throw t;h=g.fromCompact(i)}else{if("object"!=typeof i||"bigint"!=typeof i.r||"bigint"!=typeof i.s)throw new Error("PARSE");{const{r:t,s:e}=i;h=new g(t,e)}}f=c.fromHex(n)}catch(t){if("PARSE"===t.message)throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(l&&h.hasHighS())return!1;u&&(r=e.hash(r));const{r:d,s:p}=h,y=b(r),m=a(p),w=o(y*m),A=o(d*m),E=c.BASE.multiplyAndAddUnsafe(f,w,A)?.toAffine();return!!E&&o(E.x)===d},ProjectivePoint:c,Signature:g,utils:y}}function kc(t){return{hash:t,hmac:(e,...r)=>fc(t,e,function(...t){const e=new Uint8Array(t.reduce(((t,e)=>t+e.length),0));let r=0;return t.forEach((t=>{if(!ya(t))throw new Error("Uint8Array expected");e.set(t,r),r+=t.length})),e}(...r)),randomBytes:va}}BigInt(4);const xc=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Bc=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),Ic=BigInt(1),Pc=BigInt(2),Nc=(t,e)=>(t+e/Pc)/e;const Cc=function(t,e,r=!1,n={}){if(t<=Za)throw new Error(`Expected Field ORDER > 0, got ${t}`);const{nBitLength:s,nByteLength:i}=cc(t,e);if(i>2048)throw new Error("Field lengths over 2048 bytes are not supported");const o=function(t){if(t%tc===Xa){const e=(t+$a)/tc;return function(t,r){const n=t.pow(r,e);if(!t.eql(t.sqr(n),r))throw new Error("Cannot find square root");return n}}if(t%rc===ec){const e=(t-ec)/rc;return function(t,r){const n=t.mul(r,Ya),s=t.pow(n,e),i=t.mul(r,s),o=t.mul(t.mul(i,Ya),s),a=t.mul(i,t.sub(o,t.ONE));if(!t.eql(t.sqr(a),r))throw new Error("Cannot find square root");return a}}return function(t){const e=(t-$a)/Ya;let r,n,s;for(r=t-$a,n=0;r%Ya===Za;r/=Ya,n++);for(s=Ya;s<t&&sc(s,e,t)!==t-$a;s++);if(1===n){const e=(t+$a)/tc;return function(t,r){const n=t.pow(r,e);if(!t.eql(t.sqr(n),r))throw new Error("Cannot find square root");return n}}const i=(r+$a)/Ya;return function(t,o){if(t.pow(o,e)===t.neg(t.ONE))throw new Error("Cannot find square root");let a=n,c=t.pow(t.mul(t.ONE,s),r),l=t.pow(o,i),u=t.pow(o,r);for(;!t.eql(u,t.ONE);){if(t.eql(u,t.ZERO))return t.ZERO;let e=1;for(let r=t.sqr(u);e<a&&!t.eql(r,t.ONE);e++)r=t.sqr(r);const r=t.pow(c,$a<<BigInt(a-e-1));c=t.sqr(r),l=t.mul(l,r),u=t.mul(u,c),a=e}return l}}(t)}(t),a=Object.freeze({ORDER:t,BITS:s,BYTES:i,MASK:Va(s),ZERO:Za,ONE:$a,create:e=>nc(e,t),isValid:e=>{if("bigint"!=typeof e)throw new Error("Invalid field element: expected bigint, got "+typeof e);return Za<=e&&e<t},is0:t=>t===Za,isOdd:t=>(t&$a)===$a,neg:e=>nc(-e,t),eql:(t,e)=>t===e,sqr:e=>nc(e*e,t),add:(e,r)=>nc(e+r,t),sub:(e,r)=>nc(e-r,t),mul:(e,r)=>nc(e*r,t),pow:(t,e)=>function(t,e,r){if(r<Za)throw new Error("Expected power > 0");if(r===Za)return t.ONE;if(r===$a)return e;let n=t.ONE,s=e;for(;r>Za;)r&$a&&(n=t.mul(n,s)),s=t.sqr(s),r>>=$a;return n}(a,t,e),div:(e,r)=>nc(e*oc(r,t),t),sqrN:t=>t*t,addN:(t,e)=>t+e,subN:(t,e)=>t-e,mulN:(t,e)=>t*e,inv:e=>oc(e,t),sqrt:n.sqrt||(t=>o(a,t)),invertBatch:t=>function(t,e){const r=new Array(e.length),n=e.reduce(((e,n,s)=>t.is0(n)?e:(r[s]=e,t.mul(e,n))),t.ONE),s=t.inv(n);return e.reduceRight(((e,n,s)=>t.is0(n)?e:(r[s]=t.mul(e,r[s]),t.mul(e,n))),s),r}(a,t),cmov:(t,e,r)=>r?e:t,toBytes:t=>r?Qa(t,i):Ha(t,i),fromBytes:t=>{if(t.length!==i)throw new Error(`Fp.fromBytes: expected ${i}, got ${t.length}`);return r?Ga(t):Ma(t)}});return Object.freeze(a)}(xc,void 0,void 0,{sqrt:function(t){const e=xc,r=BigInt(3),n=BigInt(6),s=BigInt(11),i=BigInt(22),o=BigInt(23),a=BigInt(44),c=BigInt(88),l=t*t*t%e,u=l*l*t%e,h=ic(u,r,e)*u%e,f=ic(h,r,e)*u%e,d=ic(f,Pc,e)*l%e,p=ic(d,s,e)*d%e,g=ic(p,i,e)*p%e,y=ic(g,a,e)*g%e,m=ic(y,c,e)*y%e,w=ic(m,a,e)*g%e,b=ic(w,r,e)*u%e,A=ic(b,o,e)*p%e,E=ic(A,n,e)*l%e,v=ic(E,Pc,e);if(!Cc.eql(Cc.sqr(v),t))throw new Error("Cannot find square root");return v}}),Rc=function(t,e){const r=e=>vc({...t,...kc(e)});return Object.freeze({...r(e),create:r})}({a:BigInt(0),b:BigInt(7),Fp:Cc,n:Bc,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const e=Bc,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-Ic*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=r,o=BigInt("0x100000000000000000000000000000000"),a=Nc(i*t,e),c=Nc(-n*t,e);let l=nc(t-a*r-c*s,e),u=nc(-a*n-c*i,e);const h=l>o,f=u>o;if(h&&(l=e-l),f&&(u=e-u),l>o||u>o)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:h,k1:l,k2neg:f,k2:u}}}},Ra);BigInt(0),Rc.ProjectivePoint;class Oc{#nt;constructor(t){_t(32===ie(t),"invalid private key","privateKey","[REDACTED]"),this.#nt=ne(t)}get privateKey(){return this.#nt}get publicKey(){return Oc.computePublicKey(this.#nt)}get compressedPublicKey(){return Oc.computePublicKey(this.#nt,!0)}sign(t){_t(32===ie(t),"invalid digest length","digest",t);const e=Rc.sign(Xt(t),Xt(this.#nt),{lowS:!0});return ha.from({r:Ae(e.r,32),s:Ae(e.s,32),v:e.recovery?28:27})}computeSharedSecret(t){const e=Oc.computePublicKey(t);return ne(Rc.getSharedSecret(Xt(this.#nt),Yt(e),!1))}static computePublicKey(t,e){let r=Yt(t,"key");if(32===r.length)return ne(Rc.getPublicKey(r,!!e));if(64===r.length){const t=new Uint8Array(65);t[0]=4,t.set(r,1),r=t}return ne(Rc.ProjectivePoint.fromHex(r).toRawBytes(e))}static recoverPublicKey(t,e){_t(32===ie(t),"invalid digest length","digest",t);const r=ha.from(e);let n=Rc.Signature.fromCompact(Xt(se([r.r,r.s])));n=n.addRecoveryBit(r.yParity);const s=n.recoverPublicKey(Xt(t));return _t(null!=s,"invalid signautre for digest","signature",e),"0x"+s.toHex(!1)}static addPoints(t,e,r){const n=Rc.ProjectivePoint.fromHex(Oc.computePublicKey(t).substring(2)),s=Rc.ProjectivePoint.fromHex(Oc.computePublicKey(e).substring(2));return"0x"+n.add(s).toHex(!!r)}}function Sc(t){let e=t.toString(16);for(;e.length<2;)e="0"+e;return"0x"+e}function Tc(t,e,r){let n=0;for(let s=0;s<r;s++)n=256*n+t[e+s];return n}function Uc(t,e,r,n){const s=[];for(;r<e+1+n;){const i=Fc(t,r);s.push(i.result),Jt((r+=i.consumed)<=e+1+n,"child data too short","BUFFER_OVERRUN",{buffer:t,length:n,offset:e})}return{consumed:1+n,result:s}}function Fc(t,e){Jt(0!==t.length,"data too short","BUFFER_OVERRUN",{buffer:t,length:0,offset:1});const r=e=>{Jt(e<=t.length,"data short segment too short","BUFFER_OVERRUN",{buffer:t,length:t.length,offset:e})};if(t[e]>=248){const n=t[e]-247;r(e+1+n);const s=Tc(t,e+1,n);return r(e+1+n+s),Uc(t,e,e+1+n,n+s)}if(t[e]>=192){const n=t[e]-192;return r(e+1+n),Uc(t,e,e+1,n)}if(t[e]>=184){const n=t[e]-183;r(e+1+n);const s=Tc(t,e+1,n);return r(e+1+n+s),{consumed:1+n+s,result:ne(t.slice(e+1+n,e+1+n+s))}}if(t[e]>=128){const n=t[e]-128;return r(e+1+n),{consumed:1+n,result:ne(t.slice(e+1,e+1+n))}}return{consumed:1,result:Sc(t[e])}}function Dc(t){const e=Yt(t,"data"),r=Fc(e,0);return _t(r.consumed===e.length,"unexpected junk after rlp payload","data",t),r.result}function Lc(t){const e=[];for(;t;)e.unshift(255&t),t>>=8;return e}function Mc(t){if(Array.isArray(t)){let e=[];if(t.forEach((function(t){e=e.concat(Mc(t))})),e.length<=55)return e.unshift(192+e.length),e;const r=Lc(e.length);return r.unshift(247+r.length),r.concat(e)}const e=Array.prototype.slice.call(Yt(t,"object"));if(1===e.length&&e[0]<=127)return e;if(e.length<=55)return e.unshift(128+e.length),e;const r=Lc(e.length);return r.unshift(183+r.length),r.concat(e)}const Gc="0123456789abcdef";function Hc(t){let e="0x";for(const r of Mc(t))e+=Gc[r>>4],e+=Gc[15&r];return e}const Qc=BigInt(0),jc=BigInt(2),zc=BigInt(27),Vc=BigInt(28),Kc=BigInt(35),Jc=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),_c=131072;function qc(t,e){let r=t.toString(16);for(;r.length<2;)r="0"+r;return r+=ta(e).substring(4),"0x"+r}function Wc(t){return"0x"===t?null:Br(t)}function Zc(t,e){try{return ys(t)}catch(r){_t(!1,r.message,e,t)}}function $c(t,e){return"0x"===t?0:be(t,e)}function Yc(t,e){if("0x"===t)return Qc;const r=ge(t,e);return _t(r<=Jc,"value exceeds uint size",e,r),r}function Xc(t,e){const r=ge(t,"value"),n=Ee(r);return _t(n.length<=32,"value too large",`tx.${e}`,r),n}function tl(t){return ys(t).map((t=>[t.address,t.storageKeys]))}function el(t,e){_t(Array.isArray(t),`invalid ${e}`,"value",t);for(let e=0;e<t.length;e++)_t(te(t[e],32),"invalid ${ param } hash",`value[${e}]`,t[e]);return t}function rl(t,e){let r;try{if(r=$c(e[0],"yParity"),0!==r&&1!==r)throw new Error("bad yParity")}catch(t){_t(!1,"invalid yParity","yParity",e[0])}const n=ce(e[1],32),s=ce(e[2],32),i=ha.from({r:n,s,yParity:r});t.signature=i}class nl{#st;#it;#e;#ot;#at;#ct;#lt;#ut;#ht;#ft;#dt;#pt;#gt;#yt;#mt;#wt;get type(){return this.#st}set type(t){switch(t){case null:this.#st=null;break;case 0:case"legacy":this.#st=0;break;case 1:case"berlin":case"eip-2930":this.#st=1;break;case 2:case"london":case"eip-1559":this.#st=2;break;case 3:case"cancun":case"eip-4844":this.#st=3;break;default:_t(!1,"unsupported transaction type","type",t)}}get typeName(){switch(this.type){case 0:return"legacy";case 1:return"eip-2930";case 2:return"eip-1559";case 3:return"eip-4844"}return null}get to(){const t=this.#it;return null==t&&3===this.type?Os:t}set to(t){this.#it=null==t?null:Br(t)}get nonce(){return this.#ot}set nonce(t){this.#ot=be(t,"value")}get gasLimit(){return this.#at}set gasLimit(t){this.#at=ge(t)}get gasPrice(){const t=this.#ct;return null!=t||0!==this.type&&1!==this.type?t:Qc}set gasPrice(t){this.#ct=null==t?null:ge(t,"gasPrice")}get maxPriorityFeePerGas(){const t=this.#lt;return null==t?2===this.type||3===this.type?Qc:null:t}set maxPriorityFeePerGas(t){this.#lt=null==t?null:ge(t,"maxPriorityFeePerGas")}get maxFeePerGas(){const t=this.#ut;return null==t?2===this.type||3===this.type?Qc:null:t}set maxFeePerGas(t){this.#ut=null==t?null:ge(t,"maxFeePerGas")}get data(){return this.#e}set data(t){this.#e=ne(t)}get value(){return this.#ht}set value(t){this.#ht=ge(t,"value")}get chainId(){return this.#ft}set chainId(t){this.#ft=ge(t)}get signature(){return this.#dt||null}set signature(t){this.#dt=null==t?null:ha.from(t)}get accessList(){const t=this.#pt||null;return null==t?1===this.type||2===this.type||3===this.type?[]:null:t}set accessList(t){this.#pt=null==t?null:ys(t)}get maxFeePerBlobGas(){const t=this.#gt;return null==t&&3===this.type?Qc:t}set maxFeePerBlobGas(t){this.#gt=null==t?null:ge(t,"maxFeePerBlobGas")}get blobVersionedHashes(){let t=this.#yt;return null==t&&3===this.type?[]:t}set blobVersionedHashes(t){if(null!=t){_t(Array.isArray(t),"blobVersionedHashes must be an Array","value",t),t=t.slice();for(let e=0;e<t.length;e++)_t(te(t[e],32),"invalid blobVersionedHash",`value[${e}]`,t[e])}this.#yt=t}get blobs(){return null==this.#wt?null:this.#wt.map((t=>Object.assign({},t)))}set blobs(t){if(null==t)return void(this.#wt=null);const e=[],r=[];for(let n=0;n<t.length;n++){const s=t[n];if(ee(s)){Jt(this.#mt,"adding a raw blob requires a KZG library","UNSUPPORTED_OPERATION",{operation:"set blobs()"});let t=Yt(s);if(_t(t.length<=_c,"blob is too large",`blobs[${n}]`,s),t.length!==_c){const e=new Uint8Array(_c);e.set(t),t=e}const i=this.#mt.blobToKzgCommitment(t),o=ne(this.#mt.computeBlobKzgProof(t,i));e.push({data:ne(t),commitment:ne(i),proof:o}),r.push(qc(1,i))}else{const t=ne(s.commitment);e.push({data:ne(s.data),commitment:t,proof:ne(s.proof)}),r.push(qc(1,t))}}this.#wt=e,this.#yt=r}get kzg(){return this.#mt}set kzg(t){this.#mt=t}constructor(){this.#st=null,this.#it=null,this.#ot=0,this.#at=Qc,this.#ct=null,this.#lt=null,this.#ut=null,this.#e="0x",this.#ht=Qc,this.#ft=Qc,this.#dt=null,this.#pt=null,this.#gt=null,this.#yt=null,this.#wt=null,this.#mt=null}get hash(){return null==this.signature?null:br(this.#bt(!0,!1))}get unsignedHash(){return br(this.unsignedSerialized)}get from(){return null==this.signature?null:(t=this.unsignedHash,e=this.signature,function(t){let e;return e="string"==typeof t?Oc.computePublicKey(t,!1):t.publicKey,Br(br("0x"+e.substring(4)).substring(26))}(Oc.recoverPublicKey(t,e)));var t,e}get fromPublicKey(){return null==this.signature?null:Oc.recoverPublicKey(this.unsignedHash,this.signature)}isSigned(){return null!=this.signature}#bt(t,e){Jt(!t||null!=this.signature,"cannot serialize unsigned transaction; maybe you meant .unsignedSerialized","UNSUPPORTED_OPERATION",{operation:".serialized"});const r=t?this.signature:null;switch(this.inferType()){case 0:return function(t,e){const r=[Xc(t.nonce,"nonce"),Xc(t.gasPrice||0,"gasPrice"),Xc(t.gasLimit,"gasLimit"),t.to||"0x",Xc(t.value,"value"),t.data];let n=Qc;if(t.chainId!=Qc)n=ge(t.chainId,"tx.chainId"),_t(!e||null==e.networkV||e.legacyChainId===n,"tx.chainId/sig.v mismatch","sig",e);else if(t.signature){const e=t.signature.legacyChainId;null!=e&&(n=e)}if(!e)return n!==Qc&&(r.push(Ee(n)),r.push("0x"),r.push("0x")),Hc(r);let s=BigInt(27+e.yParity);return n!==Qc?s=ha.getChainIdV(n,e.v):BigInt(e.v)!==s&&_t(!1,"tx.chainId/sig.v mismatch","sig",e),r.push(Ee(s)),r.push(Ee(e.r)),r.push(Ee(e.s)),Hc(r)}(this,r);case 1:return function(t,e){const r=[Xc(t.chainId,"chainId"),Xc(t.nonce,"nonce"),Xc(t.gasPrice||0,"gasPrice"),Xc(t.gasLimit,"gasLimit"),t.to||"0x",Xc(t.value,"value"),t.data,tl(t.accessList||[])];return e&&(r.push(Xc(e.yParity,"recoveryParam")),r.push(Ee(e.r)),r.push(Ee(e.s))),se(["0x01",Hc(r)])}(this,r);case 2:return function(t,e){const r=[Xc(t.chainId,"chainId"),Xc(t.nonce,"nonce"),Xc(t.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),Xc(t.maxFeePerGas||0,"maxFeePerGas"),Xc(t.gasLimit,"gasLimit"),t.to||"0x",Xc(t.value,"value"),t.data,tl(t.accessList||[])];return e&&(r.push(Xc(e.yParity,"yParity")),r.push(Ee(e.r)),r.push(Ee(e.s))),se(["0x02",Hc(r)])}(this,r);case 3:return function(t,e,r){const n=[Xc(t.chainId,"chainId"),Xc(t.nonce,"nonce"),Xc(t.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),Xc(t.maxFeePerGas||0,"maxFeePerGas"),Xc(t.gasLimit,"gasLimit"),t.to||Os,Xc(t.value,"value"),t.data,tl(t.accessList||[]),Xc(t.maxFeePerBlobGas||0,"maxFeePerBlobGas"),el(t.blobVersionedHashes||[],"blobVersionedHashes")];return e&&(n.push(Xc(e.yParity,"yParity")),n.push(Ee(e.r)),n.push(Ee(e.s)),r)?se(["0x03",Hc([n,r.map((t=>t.data)),r.map((t=>t.commitment)),r.map((t=>t.proof))])]):se(["0x03",Hc(n)])}(this,r,e?this.blobs:null)}Jt(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:".serialized"})}get serialized(){return this.#bt(!0,!0)}get unsignedSerialized(){return this.#bt(!1,!1)}inferType(){const t=this.inferTypes();return t.indexOf(2)>=0?2:t.pop()}inferTypes(){const t=null!=this.gasPrice,e=null!=this.maxFeePerGas||null!=this.maxPriorityFeePerGas,r=null!=this.accessList,n=null!=this.#gt||this.#yt;null!=this.maxFeePerGas&&null!=this.maxPriorityFeePerGas&&Jt(this.maxFeePerGas>=this.maxPriorityFeePerGas,"priorityFee cannot be more than maxFee","BAD_DATA",{value:this}),Jt(!e||0!==this.type&&1!==this.type,"transaction type cannot have maxFeePerGas or maxPriorityFeePerGas","BAD_DATA",{value:this}),Jt(0!==this.type||!r,"legacy transaction cannot have accessList","BAD_DATA",{value:this});const s=[];return null!=this.type?s.push(this.type):e?s.push(2):t?(s.push(1),r||s.push(0)):r?(s.push(1),s.push(2)):(n&&this.to||(s.push(0),s.push(1),s.push(2)),s.push(3)),s.sort(),s}isLegacy(){return 0===this.type}isBerlin(){return 1===this.type}isLondon(){return 2===this.type}isCancun(){return 3===this.type}clone(){return nl.from(this)}toJSON(){const t=t=>null==t?null:t.toString();return{type:this.type,to:this.to,data:this.data,nonce:this.nonce,gasLimit:t(this.gasLimit),gasPrice:t(this.gasPrice),maxPriorityFeePerGas:t(this.maxPriorityFeePerGas),maxFeePerGas:t(this.maxFeePerGas),value:t(this.value),chainId:t(this.chainId),sig:this.signature?this.signature.toJSON():null,accessList:this.accessList}}static from(t){if(null==t)return new nl;if("string"==typeof t){const e=Yt(t);if(e[0]>=127)return nl.from(function(t){const e=Dc(t);_t(Array.isArray(e)&&(9===e.length||6===e.length),"invalid field count for legacy transaction","data",t);const r={type:0,nonce:$c(e[0],"nonce"),gasPrice:Yc(e[1],"gasPrice"),gasLimit:Yc(e[2],"gasLimit"),to:Wc(e[3]),value:Yc(e[4],"value"),data:ne(e[5]),chainId:Qc};if(6===e.length)return r;const n=Yc(e[6],"v"),s=Yc(e[7],"r"),i=Yc(e[8],"s");if(s===Qc&&i===Qc)r.chainId=n;else{let t=(n-Kc)/jc;t<Qc&&(t=Qc),r.chainId=t,_t(t!==Qc||n===zc||n===Vc,"non-canonical legacy v","v",e[6]),r.signature=ha.from({r:ce(e[7],32),s:ce(e[8],32),v:n})}return r}(e));switch(e[0]){case 1:return nl.from(function(t){const e=Dc(Yt(t).slice(1));_t(Array.isArray(e)&&(8===e.length||11===e.length),"invalid field count for transaction type: 1","data",ne(t));const r={type:1,chainId:Yc(e[0],"chainId"),nonce:$c(e[1],"nonce"),gasPrice:Yc(e[2],"gasPrice"),gasLimit:Yc(e[3],"gasLimit"),to:Wc(e[4]),value:Yc(e[5],"value"),data:ne(e[6]),accessList:Zc(e[7],"accessList")};return 8===e.length||rl(r,e.slice(8)),r}(e));case 2:return nl.from(function(t){const e=Dc(Yt(t).slice(1));_t(Array.isArray(e)&&(9===e.length||12===e.length),"invalid field count for transaction type: 2","data",ne(t));const r={type:2,chainId:Yc(e[0],"chainId"),nonce:$c(e[1],"nonce"),maxPriorityFeePerGas:Yc(e[2],"maxPriorityFeePerGas"),maxFeePerGas:Yc(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:Yc(e[4],"gasLimit"),to:Wc(e[5]),value:Yc(e[6],"value"),data:ne(e[7]),accessList:Zc(e[8],"accessList")};return 9===e.length||rl(r,e.slice(9)),r}(e));case 3:return nl.from(function(t){let e=Dc(Yt(t).slice(1)),r="3",n=null;if(4===e.length&&Array.isArray(e[0])){r="3 (network format)";const t=e[1],s=e[2],i=e[3];_t(Array.isArray(t),"invalid network format: blobs not an array","fields[1]",t),_t(Array.isArray(s),"invalid network format: commitments not an array","fields[2]",s),_t(Array.isArray(i),"invalid network format: proofs not an array","fields[3]",i),_t(t.length===s.length,"invalid network format: blobs/commitments length mismatch","fields",e),_t(t.length===i.length,"invalid network format: blobs/proofs length mismatch","fields",e),n=[];for(let r=0;r<e[1].length;r++)n.push({data:t[r],commitment:s[r],proof:i[r]});e=e[0]}_t(Array.isArray(e)&&(11===e.length||14===e.length),`invalid field count for transaction type: ${r}`,"data",ne(t));const s={type:3,chainId:Yc(e[0],"chainId"),nonce:$c(e[1],"nonce"),maxPriorityFeePerGas:Yc(e[2],"maxPriorityFeePerGas"),maxFeePerGas:Yc(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:Yc(e[4],"gasLimit"),to:Wc(e[5]),value:Yc(e[6],"value"),data:ne(e[7]),accessList:Zc(e[8],"accessList"),maxFeePerBlobGas:Yc(e[9],"maxFeePerBlobGas"),blobVersionedHashes:e[10]};n&&(s.blobs=n),_t(null!=s.to,`invalid address for transaction type: ${r}`,"data",t),_t(Array.isArray(s.blobVersionedHashes),"invalid blobVersionedHashes: must be an array","data",t);for(let e=0;e<s.blobVersionedHashes.length;e++)_t(te(s.blobVersionedHashes[e],32),`invalid blobVersionedHash at index ${e}: must be length 32`,"data",t);return 11===e.length||rl(s,e.slice(11)),s}(e))}Jt(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:"from"})}const e=new nl;return null!=t.type&&(e.type=t.type),null!=t.to&&(e.to=t.to),null!=t.nonce&&(e.nonce=t.nonce),null!=t.gasLimit&&(e.gasLimit=t.gasLimit),null!=t.gasPrice&&(e.gasPrice=t.gasPrice),null!=t.maxPriorityFeePerGas&&(e.maxPriorityFeePerGas=t.maxPriorityFeePerGas),null!=t.maxFeePerGas&&(e.maxFeePerGas=t.maxFeePerGas),null!=t.maxFeePerBlobGas&&(e.maxFeePerBlobGas=t.maxFeePerBlobGas),null!=t.data&&(e.data=t.data),null!=t.value&&(e.value=t.value),null!=t.chainId&&(e.chainId=t.chainId),null!=t.signature&&(e.signature=ha.from(t.signature)),null!=t.accessList&&(e.accessList=t.accessList),null!=t.blobVersionedHashes&&(e.blobVersionedHashes=t.blobVersionedHashes),null!=t.kzg&&(e.kzg=t.kzg),null!=t.blobs&&(e.blobs=t.blobs),null!=t.hash&&(_t(e.isSigned(),"unsigned transaction cannot define '.hash'","tx",t),_t(e.hash===t.hash,"hash mismatch","tx",t)),null!=t.from&&(_t(e.isSigned(),"unsigned transaction cannot define '.from'","tx",t),_t(e.from.toLowerCase()===(t.from||"").toLowerCase(),"from mismatch","tx",t)),e}}const sl="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";BigInt(0);const il=BigInt(58);function ol(t){return t.match(/^ipfs:\/\/ipfs\//i)?t=t.substring(12):t.match(/^ipfs:\/\//i)?t=t.substring(7):_t(!1,"unsupported IPFS format","link",t),`https://gateway.ipfs.io/ipfs/${t}`}class al{name;constructor(t){Qt(this,{name:t})}connect(t){return this}supportsCoinType(t){return!1}async encodeAddress(t,e){throw new Error("unsupported coin")}async decodeAddress(t,e){throw new Error("unsupported coin")}}const cl=new RegExp("^(ipfs)://(.*)$","i"),ll=[new RegExp("^(https)://(.*)$","i"),new RegExp("^(data):(.*)$","i"),cl,new RegExp("^eip155:[0-9]+/(erc[0-9]+):(.*)$","i")];class ul{provider;address;name;#At;#Et;constructor(t,e,r){Qt(this,{provider:t,address:e,name:r}),this.#At=null,this.#Et=new xi(e,["function supportsInterface(bytes4) view returns (bool)","function resolve(bytes, bytes) view returns (bytes)","function addr(bytes32) view returns (address)","function addr(bytes32, uint) view returns (bytes)","function text(bytes32, string) view returns (string)","function contenthash(bytes32) view returns (bytes)"],t)}async supportsWildcard(){return null==this.#At&&(this.#At=(async()=>{try{return await this.#Et.supportsInterface("0x9061b923")}catch(t){if(zt(t,"CALL_EXCEPTION"))return!1;throw this.#At=null,t}})()),await this.#At}async#vt(t,e){e=(e||[]).slice();const r=this.#Et.interface;e.unshift(Ro(this.name));let n=null;await this.supportsWildcard()&&(n=r.getFunction(t),Jt(n,"missing fragment","UNKNOWN_ERROR",{info:{funcName:t}}),e=[Oo(this.name,255),r.encodeFunctionData(n,e)],t="resolve(bytes,bytes)"),e.push({enableCcipRead:!0});try{const s=await this.#Et[t](...e);return n?r.decodeFunctionResult(n,s)[0]:s}catch(t){if(!zt(t,"CALL_EXCEPTION"))throw t}return null}async getAddress(t){if(null==t&&(t=60),60===t)try{const t=await this.#vt("addr(bytes32)");return null==t||t===Os?null:t}catch(t){if(zt(t,"CALL_EXCEPTION"))return null;throw t}if(t>=0&&t<2147483648){let e=t+2147483648;const r=await this.#vt("addr(bytes32,uint)",[e]);if(te(r,20))return Br(r)}let e=null;for(const r of this.provider.plugins)if(r instanceof al&&r.supportsCoinType(t)){e=r;break}if(null==e)return null;const r=await this.#vt("addr(bytes32,uint)",[t]);if(null==r||"0x"===r)return null;const n=await e.decodeAddress(t,r);if(null!=n)return n;Jt(!1,"invalid coin data","UNSUPPORTED_OPERATION",{operation:`getAddress(${t})`,info:{coinType:t,data:r}})}async getText(t){const e=await this.#vt("text(bytes32,string)",[t]);return null==e||"0x"===e?null:e}async getContentHash(){const t=await this.#vt("contenthash(bytes32)");if(null==t||"0x"===t)return null;const e=t.match(/^0x(e3010170|e5010172)(([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f]*))$/);if(e){const t="e3010170"===e[1]?"ipfs":"ipns",r=parseInt(e[4],16);if(e[5].length===2*r)return`${t}://${function(t){const e=Yt(t);let r=we(e),n="";for(;r;)n=sl[Number(r%il)]+n,r/=il;for(let t=0;t<e.length&&!e[t];t++)n=sl[0]+n;return n}("0x"+e[2])}`}const r=t.match(/^0xe40101fa011b20([0-9a-f]*)$/);if(r&&64===r[1].length)return`bzz://${r[1]}`;Jt(!1,"invalid or unsupported content hash data","UNSUPPORTED_OPERATION",{operation:"getContentHash()",info:{data:t}})}async getAvatar(){return(await this._getAvatar()).url}async _getAvatar(){const t=[{type:"name",value:this.name}];try{const e=await this.getText("avatar");if(null==e)return t.push({type:"!avatar",value:""}),{url:null,linkage:t};t.push({type:"avatar",value:e});for(let r=0;r<ll.length;r++){const n=e.match(ll[r]);if(null==n)continue;const s=n[1].toLowerCase();switch(s){case"https":case"data":return t.push({type:"url",value:e}),{linkage:t,url:e};case"ipfs":{const r=ol(e);return t.push({type:"ipfs",value:e}),t.push({type:"url",value:r}),{linkage:t,url:r}}case"erc721":case"erc1155":{const r="erc721"===s?"tokenURI(uint256)":"uri(uint256)";t.push({type:s,value:e});const i=await this.getAddress();if(null==i)return t.push({type:"!owner",value:""}),{url:null,linkage:t};const o=(n[2]||"").split("/");if(2!==o.length)return t.push({type:`!${s}caip`,value:n[2]||""}),{url:null,linkage:t};const a=o[1],c=new xi(o[0],["function tokenURI(uint) view returns (string)","function ownerOf(uint) view returns (address)","function uri(uint) view returns (string)","function balanceOf(address, uint256) view returns (uint)"],this.provider);if("erc721"===s){const e=await c.ownerOf(a);if(i!==e)return t.push({type:"!owner",value:e}),{url:null,linkage:t};t.push({type:"owner",value:e})}else if("erc1155"===s){const e=await c.balanceOf(i,a);if(!e)return t.push({type:"!balance",value:"0"}),{url:null,linkage:t};t.push({type:"balance",value:e.toString()})}let l=await c[r](a);if(null==l||"0x"===l)return t.push({type:"!metadata-url",value:""}),{url:null,linkage:t};t.push({type:"metadata-url-base",value:l}),"erc1155"===s&&(l=l.replace("{id}",Ae(a,32).substring(2)),t.push({type:"metadata-url-expanded",value:l})),l.match(/^ipfs:/i)&&(l=ol(l)),t.push({type:"metadata-url",value:l});let u={};const h=await new Ns(l).send();h.assertOk();try{u=h.bodyJson}catch(e){try{t.push({type:"!metadata",value:h.bodyText})}catch(e){const r=h.body;return r&&t.push({type:"!metadata",value:ne(r)}),{url:null,linkage:t}}return{url:null,linkage:t}}if(!u)return t.push({type:"!metadata",value:""}),{url:null,linkage:t};t.push({type:"metadata",value:JSON.stringify(u)});let f=u.image;if("string"!=typeof f)return t.push({type:"!imageUrl",value:""}),{url:null,linkage:t};if(f.match(/^(https:\/\/|data:)/i));else{if(null==f.match(cl))return t.push({type:"!imageUrl-ipfs",value:f}),{url:null,linkage:t};t.push({type:"imageUrl-ipfs",value:f}),f=ol(f)}return t.push({type:"url",value:f}),{linkage:t,url:f}}}}}catch(t){}return{linkage:t,url:null}}static async getEnsAddress(t){const e=await t.getNetwork(),r=e.getPlugin("org.ethers.plugins.network.Ens");return Jt(r,"network does not support ENS","UNSUPPORTED_OPERATION",{operation:"getEnsAddress",info:{network:e}}),r.address}static async#kt(t,e){const r=await ul.getEnsAddress(t);try{const n=new xi(r,["function resolver(bytes32) view returns (address)"],t),s=await n.resolver(Ro(e),{enableCcipRead:!0});return s===Os?null:s}catch(t){throw t}return null}static async fromName(t,e){let r=e;for(;;){if(""===r||"."===r)return null;if("eth"!==e&&"eth"===r)return null;const n=await ul.#kt(t,r);if(null!=n){const s=new ul(t,n,e);return r===e||await s.supportsWildcard()?s:null}r=r.split(".").slice(1).join(".")}}}const hl=BigInt(0);function fl(t,e){return function(r){return null==r?e:t(r)}}function dl(t,e){return r=>{if(e&&null==r)return null;if(!Array.isArray(r))throw new Error("not an array");return r.map((e=>t(e)))}}function pl(t,e){return r=>{const n={};for(const s in t){let i=s;if(e&&s in e&&!(i in r))for(const t of e[s])if(t in r){i=t;break}try{const e=t[s](r[i]);void 0!==e&&(n[s]=e)}catch(t){Jt(!1,`invalid value for value.${s} (${t instanceof Error?t.message:"not-an-error"})`,"BAD_DATA",{value:r})}}return n}}function gl(t){return _t(te(t,!0),"invalid data","value",t),t}function yl(t){return _t(te(t,32),"invalid hash","value",t),t}const ml=pl({address:Br,blockHash:yl,blockNumber:be,data:gl,index:be,removed:fl((function(t){switch(t){case!0:case"true":return!0;case!1:case"false":return!1}_t(!1,`invalid boolean; ${JSON.stringify(t)}`,"value",t)}),!1),topics:dl(yl),transactionHash:yl,transactionIndex:be},{index:["logIndex"]}),wl=pl({hash:fl(yl),parentHash:yl,parentBeaconBlockRoot:fl(yl,null),number:be,timestamp:be,nonce:fl(gl),difficulty:ge,gasLimit:ge,gasUsed:ge,stateRoot:fl(yl,null),receiptsRoot:fl(yl,null),blobGasUsed:fl(ge,null),excessBlobGas:fl(ge,null),miner:fl(Br),prevRandao:fl(yl,null),extraData:gl,baseFeePerGas:fl(ge)},{prevRandao:["mixHash"]}),bl=pl({transactionIndex:be,blockNumber:be,transactionHash:yl,address:Br,topics:dl(yl),data:gl,index:be,blockHash:yl},{index:["logIndex"]}),Al=pl({to:fl(Br,null),from:fl(Br,null),contractAddress:fl(Br,null),index:be,root:fl(ne),gasUsed:ge,blobGasUsed:fl(ge,null),logsBloom:fl(gl),blockHash:yl,hash:yl,logs:dl((function(t){return bl(t)})),blockNumber:be,cumulativeGasUsed:ge,effectiveGasPrice:fl(ge),blobGasPrice:fl(ge,null),status:fl(be),type:fl(be,0)},{effectiveGasPrice:["gasPrice"],hash:["transactionHash"],index:["transactionIndex"]});function El(t){t.to&&ge(t.to)===hl&&(t.to="0x0000000000000000000000000000000000000000");const e=pl({hash:yl,index:fl(be,void 0),type:t=>"0x"===t||null==t?0:be(t),accessList:fl(ys,null),blobVersionedHashes:fl(dl(yl,!0),null),blockHash:fl(yl,null),blockNumber:fl(be,null),transactionIndex:fl(be,null),from:Br,gasPrice:fl(ge),maxPriorityFeePerGas:fl(ge),maxFeePerGas:fl(ge),maxFeePerBlobGas:fl(ge,null),gasLimit:ge,to:fl(Br,null),value:ge,nonce:be,data:gl,creates:fl(Br,null),chainId:fl(ge,null)},{data:["input"],gasLimit:["gas"],index:["transactionIndex"]})(t);if(null==e.to&&null==e.creates&&(e.creates=function(t){const e=Br(t.from);let r=ge(t.nonce,"tx.nonce").toString(16);return r="0"===r?"0x":r.length%2?"0x0"+r:"0x"+r,Br(oe(br(Hc([e,r])),12))}(e)),1!==t.type&&2!==t.type||null!=t.accessList||(e.accessList=[]),t.signature?e.signature=ha.from(t.signature):e.signature=ha.from(t),null==e.chainId){const t=e.signature.legacyChainId;null!=t&&(e.chainId=t)}return e.blockHash&&ge(e.blockHash)===hl&&(e.blockHash=null),e}class vl{name;constructor(t){Qt(this,{name:t})}clone(){return new vl(this.name)}}class kl extends vl{effectiveBlock;txBase;txCreate;txDataZero;txDataNonzero;txAccessListStorageKey;txAccessListAddress;constructor(t,e){null==t&&(t=0),super(`org.ethers.network.plugins.GasCost#${t||0}`);const r={effectiveBlock:t};function n(t,n){let s=(e||{})[t];null==s&&(s=n),_t("number"==typeof s,`invalud value for ${t}`,"costs",e),r[t]=s}n("txBase",21e3),n("txCreate",32e3),n("txDataZero",4),n("txDataNonzero",16),n("txAccessListStorageKey",1900),n("txAccessListAddress",2400),Qt(this,r)}clone(){return new kl(this.effectiveBlock,this)}}class xl extends vl{address;targetNetwork;constructor(t,e){super("org.ethers.plugins.network.Ens"),Qt(this,{address:t||"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",targetNetwork:null==e?1:e})}clone(){return new xl(this.address,this.targetNetwork)}}class Bl extends vl{#I;#xt;get url(){return this.#I}get processFunc(){return this.#xt}constructor(t,e){super("org.ethers.plugins.network.FetchUrlFeeDataPlugin"),this.#I=t,this.#xt=e}clone(){return this}}const Il=new Map;class Pl{#Bt;#ft;#It;constructor(t,e){this.#Bt=t,this.#ft=ge(e),this.#It=new Map}toJSON(){return{name:this.name,chainId:String(this.chainId)}}get name(){return this.#Bt}set name(t){this.#Bt=t}get chainId(){return this.#ft}set chainId(t){this.#ft=ge(t,"chainId")}matches(t){if(null==t)return!1;if("string"==typeof t){try{return this.chainId===ge(t)}catch(t){}return this.name===t}if("number"==typeof t||"bigint"==typeof t){try{return this.chainId===ge(t)}catch(t){}return!1}if("object"==typeof t){if(null!=t.chainId){try{return this.chainId===ge(t.chainId)}catch(t){}return!1}return null!=t.name&&this.name===t.name}return!1}get plugins(){return Array.from(this.#It.values())}attachPlugin(t){if(this.#It.get(t.name))throw new Error(`cannot replace existing plugin: ${t.name} `);return this.#It.set(t.name,t.clone()),this}getPlugin(t){return this.#It.get(t)||null}getPlugins(t){return this.plugins.filter((e=>e.name.split("#")[0]===t))}clone(){const t=new Pl(this.name,this.chainId);return this.plugins.forEach((e=>{t.attachPlugin(e.clone())})),t}computeIntrinsicGas(t){const e=this.getPlugin("org.ethers.plugins.network.GasCost")||new kl;let r=e.txBase;if(null==t.to&&(r+=e.txCreate),t.data)for(let n=2;n<t.data.length;n+=2)"00"===t.data.substring(n,n+2)?r+=e.txDataZero:r+=e.txDataNonzero;if(t.accessList){const n=ys(t.accessList);for(const t in n)r+=e.txAccessListAddress+e.txAccessListStorageKey*n[t].storageKeys.length}return r}static from(t){if(function(){function t(t,e,r){const n=function(){const n=new Pl(t,e);return null!=r.ensNetwork&&n.attachPlugin(new xl(null,r.ensNetwork)),n.attachPlugin(new kl),(r.plugins||[]).forEach((t=>{n.attachPlugin(t)})),n};Pl.register(t,n),Pl.register(e,n),r.altNames&&r.altNames.forEach((t=>{Pl.register(t,n)}))}Rl||(Rl=!0,t("mainnet",1,{ensNetwork:1,altNames:["homestead"]}),t("ropsten",3,{ensNetwork:3}),t("rinkeby",4,{ensNetwork:4}),t("goerli",5,{ensNetwork:5}),t("kovan",42,{ensNetwork:42}),t("sepolia",11155111,{ensNetwork:11155111}),t("holesky",17e3,{ensNetwork:17e3}),t("classic",61,{}),t("classicKotti",6,{}),t("arbitrum",42161,{ensNetwork:1}),t("arbitrum-goerli",421613,{}),t("arbitrum-sepolia",421614,{}),t("base",8453,{ensNetwork:1}),t("base-goerli",84531,{}),t("base-sepolia",84532,{}),t("bnb",56,{ensNetwork:1}),t("bnbt",97,{}),t("linea",59144,{ensNetwork:1}),t("linea-goerli",59140,{}),t("linea-sepolia",59141,{}),t("matic",137,{ensNetwork:1,plugins:[Cl("https://gasstation.polygon.technology/v2")]}),t("matic-amoy",80002,{}),t("matic-mumbai",80001,{altNames:["maticMumbai","maticmum"],plugins:[Cl("https://gasstation-testnet.polygon.technology/v2")]}),t("optimism",10,{ensNetwork:1,plugins:[]}),t("optimism-goerli",420,{}),t("optimism-sepolia",11155420,{}),t("xdai",100,{ensNetwork:1}))}(),null==t)return Pl.from("mainnet");if("number"==typeof t&&(t=BigInt(t)),"string"==typeof t||"bigint"==typeof t){const e=Il.get(t);if(e)return e();if("bigint"==typeof t)return new Pl("unknown",t);_t(!1,"unknown network","network",t)}if("function"==typeof t.clone)return t.clone();if("object"==typeof t){_t("string"==typeof t.name&&"number"==typeof t.chainId,"invalid network object name or chainId","network",t);const e=new Pl(t.name,t.chainId);return(t.ensAddress||null!=t.ensNetwork)&&e.attachPlugin(new xl(t.ensAddress,t.ensNetwork)),e}_t(!1,"invalid network","network",t)}static register(t,e){"number"==typeof t&&(t=BigInt(t));const r=Il.get(t);r&&_t(!1,`conflicting network for ${JSON.stringify(r.name)}`,"nameOrChainId",t),Il.set(t,e)}}function Nl(t,e){const r=String(t);if(!r.match(/^[0-9.]+$/))throw new Error(`invalid gwei value: ${t}`);const n=r.split(".");if(1===n.length&&n.push(""),2!==n.length)throw new Error(`invalid gwei value: ${t}`);for(;n[1].length<e;)n[1]+="0";if(n[1].length>9){let t=BigInt(n[1].substring(0,9));n[1].substring(9).match(/^0+$/)||t++,n[1]=t.toString()}return BigInt(n[0]+n[1])}function Cl(t){return new Bl(t,(async(t,e,r)=>{let n;r.setHeader("User-Agent","ethers");try{const[e,s]=await Promise.all([r.send(),t()]);n=e;const i=n.bodyJson.standard;return{gasPrice:s.gasPrice,maxFeePerGas:Nl(i.maxFee,9),maxPriorityFeePerGas:Nl(i.maxPriorityFee,9)}}catch(t){Jt(!1,`error encountered with polygon gas station (${JSON.stringify(r.url)})`,"SERVER_ERROR",{request:r,response:n,error:t})}}))}let Rl=!1;function Ol(t){return JSON.parse(JSON.stringify(t))}class Sl{#Pt;#Nt;#Ct;#Rt;constructor(t){this.#Pt=t,this.#Nt=null,this.#Ct=4e3,this.#Rt=-2}get pollingInterval(){return this.#Ct}set pollingInterval(t){this.#Ct=t}async#Ot(){try{const t=await this.#Pt.getBlockNumber();if(-2===this.#Rt)return void(this.#Rt=t);if(t!==this.#Rt){for(let e=this.#Rt+1;e<=t;e++){if(null==this.#Nt)return;await this.#Pt.emit("block",e)}this.#Rt=t}}catch(t){}null!=this.#Nt&&(this.#Nt=this.#Pt._setTimeout(this.#Ot.bind(this),this.#Ct))}start(){this.#Nt||(this.#Nt=this.#Pt._setTimeout(this.#Ot.bind(this),this.#Ct),this.#Ot())}stop(){this.#Nt&&(this.#Pt._clearTimeout(this.#Nt),this.#Nt=null)}pause(t){this.stop(),t&&(this.#Rt=-2)}resume(){this.start()}}class Tl{#Pt;#Ot;#St;constructor(t){this.#Pt=t,this.#St=!1,this.#Ot=t=>{this._poll(t,this.#Pt)}}async _poll(t,e){throw new Error("sub-classes must override this")}start(){this.#St||(this.#St=!0,this.#Ot(-2),this.#Pt.on("block",this.#Ot))}stop(){this.#St&&(this.#St=!1,this.#Pt.off("block",this.#Ot))}pause(t){this.stop()}resume(){this.start()}}class Ul extends Tl{#Tt;#Ut;constructor(t,e){super(t),this.#Tt=e,this.#Ut=-2}pause(t){t&&(this.#Ut=-2),super.pause(t)}async _poll(t,e){const r=await e.getBlock(this.#Tt);null!=r&&(-2===this.#Ut?this.#Ut=r.number:r.number>this.#Ut&&(e.emit(this.#Tt,r.number),this.#Ut=r.number))}}class Fl extends Tl{#Y;constructor(t,e){super(t),this.#Y=Ol(e)}async _poll(t,e){throw new Error("@TODO")}}class Dl extends Tl{#Ft;constructor(t,e){super(t),this.#Ft=e}async _poll(t,e){const r=await e.getTransactionReceipt(this.#Ft);r&&e.emit(this.#Ft,r)}}class Ll{#Pt;#Y;#Nt;#St;#Rt;constructor(t,e){this.#Pt=t,this.#Y=Ol(e),this.#Nt=this.#Ot.bind(this),this.#St=!1,this.#Rt=-2}async#Ot(t){if(-2===this.#Rt)return;const e=Ol(this.#Y);e.fromBlock=this.#Rt+1,e.toBlock=t;const r=await this.#Pt.getLogs(e);if(0!==r.length)for(const t of r)this.#Pt.emit(this.#Y,t),this.#Rt=t.blockNumber;else this.#Rt<t-60&&(this.#Rt=t-60)}start(){this.#St||(this.#St=!0,-2===this.#Rt&&this.#Pt.getBlockNumber().then((t=>{this.#Rt=t})),this.#Pt.on("block",this.#Nt))}stop(){this.#St&&(this.#St=!1,this.#Pt.off("block",this.#Nt))}pause(t){this.stop(),t&&(this.#Rt=-2)}resume(){this.start()}}const Ml=BigInt(2);function Gl(t){return t&&"function"==typeof t.then}function Hl(t,e){return t+":"+JSON.stringify(e,((t,e)=>{if(null==e)return"null";if("bigint"==typeof e)return`bigint:${e.toString()}`;if("string"==typeof e)return e.toLowerCase();if("object"==typeof e&&!Array.isArray(e)){const t=Object.keys(e);return t.sort(),t.reduce(((t,r)=>(t[r]=e[r],t)),{})}return e}))}class Ql{name;constructor(t){Qt(this,{name:t})}start(){}stop(){}pause(t){}resume(){}}function jl(t){return(t=Array.from(new Set(t).values())).sort(),t}async function zl(t,e){if(null==t)throw new Error("invalid event");if(Array.isArray(t)&&(t={topics:t}),"string"==typeof t)switch(t){case"block":case"debug":case"error":case"finalized":case"network":case"pending":case"safe":return{type:t,tag:t}}if(te(t,32)){const e=t.toLowerCase();return{type:"transaction",tag:Hl("tx",{hash:e}),hash:e}}if(t.orphan){const e=t;return{type:"orphan",tag:Hl("orphan",e),filter:(r=e,JSON.parse(JSON.stringify(r)))}}var r;if(t.address||t.topics){const r=t,n={topics:(r.topics||[]).map((t=>null==t?null:Array.isArray(t)?jl(t.map((t=>t.toLowerCase()))):t.toLowerCase()))};if(r.address){const t=[],s=[],i=r=>{te(r)?t.push(r):s.push((async()=>{t.push(await Xn(r,e))})())};Array.isArray(r.address)?r.address.forEach(i):i(r.address),s.length&&await Promise.all(s),n.address=jl(t.map((t=>t.toLowerCase())))}return{filter:n,tag:Hl("event",n),type:"event"}}_t(!1,"unknown ProviderEvent","event",t)}function Vl(){return(new Date).getTime()}const Kl={cacheTimeout:250,pollingInterval:4e3};class Jl{#Dt;#It;#Lt;#Mt;#Gt;#Ht;#Qt;#jt;#zt;#Vt;#Kt;#u;constructor(t,e){if(this.#u=Object.assign({},Kl,e||{}),"any"===t)this.#Ht=!0,this.#Gt=null;else if(t){const e=Pl.from(t);this.#Ht=!1,this.#Gt=Promise.resolve(e),setTimeout((()=>{this.emit("network",e,null)}),0)}else this.#Ht=!1,this.#Gt=null;this.#jt=-1,this.#Qt=new Map,this.#Dt=new Map,this.#It=new Map,this.#Lt=null,this.#Mt=!1,this.#zt=1,this.#Vt=new Map,this.#Kt=!1}get pollingInterval(){return this.#u.pollingInterval}get provider(){return this}get plugins(){return Array.from(this.#It.values())}attachPlugin(t){if(this.#It.get(t.name))throw new Error(`cannot replace existing plugin: ${t.name} `);return this.#It.set(t.name,t.connect(this)),this}getPlugin(t){return this.#It.get(t)||null}get disableCcipRead(){return this.#Kt}set disableCcipRead(t){this.#Kt=!!t}async#Jt(t){const e=this.#u.cacheTimeout;if(e<0)return await this._perform(t);const r=Hl(t.method,t);let n=this.#Qt.get(r);return n||(n=this._perform(t),this.#Qt.set(r,n),setTimeout((()=>{this.#Qt.get(r)===n&&this.#Qt.delete(r)}),e)),await n}async ccipReadFetch(t,e,r){if(this.disableCcipRead||0===r.length||null==t.to)return null;const n=t.to.toLowerCase(),s=e.toLowerCase(),i=[];for(let e=0;e<r.length;e++){const o=r[e],a=o.replace("{sender}",n).replace("{data}",s),c=new Ns(a);-1===o.indexOf("{data}")&&(c.body={data:s,sender:n}),this.emit("debug",{action:"sendCcipReadFetchRequest",request:c,index:e,urls:r});let l,u="unknown error";try{l=await c.send()}catch(t){i.push(t.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:c,result:{error:t}});continue}try{const t=l.bodyJson;if(t.data)return this.emit("debug",{action:"receiveCcipReadFetchResult",request:c,result:t}),t.data;t.message&&(u=t.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:c,result:t})}catch(t){}Jt(l.statusCode<400||l.statusCode>=500,`response not found during CCIP fetch: ${u}`,"OFFCHAIN_FAULT",{reason:"404_MISSING_RESOURCE",transaction:t,info:{url:o,errorMessage:u}}),i.push(u)}Jt(!1,`error encountered during CCIP fetch: ${i.map((t=>JSON.stringify(t))).join(", ")}`,"OFFCHAIN_FAULT",{reason:"500_SERVER_ERROR",transaction:t,info:{urls:r,errorMessages:i}})}_wrapBlock(t,e){return new Vs(function(t){const e=wl(t);return e.transactions=t.transactions.map((t=>"string"==typeof t?t:El(t))),e}(t),this)}_wrapLog(t,e){return new Ks(function(t){return ml(t)}(t),this)}_wrapTransactionReceipt(t,e){return new Js(function(t){return Al(t)}(t),this)}_wrapTransactionResponse(t,e){return new _s(El(t),this)}_detectNetwork(){Jt(!1,"sub-classes must implement this","UNSUPPORTED_OPERATION",{operation:"_detectNetwork"})}async _perform(t){Jt(!1,`unsupported method: ${t.method}`,"UNSUPPORTED_OPERATION",{operation:t.method,info:t})}async getBlockNumber(){const t=be(await this.#Jt({method:"getBlockNumber"}),"%response");return this.#jt>=0&&(this.#jt=t),t}_getAddress(t){return Xn(t,this)}_getBlockTag(t){if(null==t)return"latest";switch(t){case"earliest":return"0x0";case"finalized":case"latest":case"pending":case"safe":return t}return te(t)?te(t,32)?t:ve(t):("bigint"==typeof t&&(t=be(t,"blockTag")),"number"==typeof t?t>=0?ve(t):this.#jt>=0?ve(this.#jt+t):this.getBlockNumber().then((e=>ve(e+t))):void _t(!1,"invalid blockTag","blockTag",t))}_getFilter(t){const e=(t.topics||[]).map((t=>null==t?null:Array.isArray(t)?jl(t.map((t=>t.toLowerCase()))):t.toLowerCase())),r="blockHash"in t?t.blockHash:void 0,n=(t,n,s)=>{let i;switch(t.length){case 0:break;case 1:i=t[0];break;default:t.sort(),i=t}if(r&&(null!=n||null!=s))throw new Error("invalid filter");const o={};return i&&(o.address=i),e.length&&(o.topics=e),n&&(o.fromBlock=n),s&&(o.toBlock=s),r&&(o.blockHash=r),o};let s,i,o=[];if(t.address)if(Array.isArray(t.address))for(const e of t.address)o.push(this._getAddress(e));else o.push(this._getAddress(t.address));return"fromBlock"in t&&(s=this._getBlockTag(t.fromBlock)),"toBlock"in t&&(i=this._getBlockTag(t.toBlock)),o.filter((t=>"string"!=typeof t)).length||null!=s&&"string"!=typeof s||null!=i&&"string"!=typeof i?Promise.all([Promise.all(o),s,i]).then((t=>n(t[0],t[1],t[2]))):n(o,s,i)}_getTransactionRequest(t){const e=zs(t),r=[];if(["to","from"].forEach((t=>{if(null==e[t])return;const n=Xn(e[t],this);Gl(n)?r.push(async function(){e[t]=await n}()):e[t]=n})),null!=e.blockTag){const t=this._getBlockTag(e.blockTag);Gl(t)?r.push(async function(){e.blockTag=await t}()):e.blockTag=t}return r.length?async function(){return await Promise.all(r),e}():e}async getNetwork(){if(null==this.#Gt){const t=(async()=>{try{const t=await this._detectNetwork();return this.emit("network",t,null),t}catch(e){throw this.#Gt===t&&(this.#Gt=null),e}})();return this.#Gt=t,(await t).clone()}const t=this.#Gt,[e,r]=await Promise.all([t,this._detectNetwork()]);return e.chainId!==r.chainId&&(this.#Ht?(this.emit("network",r,e),this.#Gt===t&&(this.#Gt=Promise.resolve(r))):Jt(!1,`network changed: ${e.chainId} => ${r.chainId} `,"NETWORK_ERROR",{event:"changed"})),e.clone()}async getFeeData(){const t=await this.getNetwork(),e=async()=>{const{_block:e,gasPrice:r,priorityFee:n}=await Ht({_block:this.#_t("latest",!1),gasPrice:(async()=>{try{return ge(await this.#Jt({method:"getGasPrice"}),"%response")}catch(t){}return null})(),priorityFee:(async()=>{try{return ge(await this.#Jt({method:"getPriorityFee"}),"%response")}catch(t){}return null})()});let s=null,i=null;const o=this._wrapBlock(e,t);return o&&o.baseFeePerGas&&(i=null!=n?n:BigInt("1000000000"),s=o.baseFeePerGas*Ml+i),new js(r,s,i)},r=t.getPlugin("org.ethers.plugins.network.FetchUrlFeeDataPlugin");if(r){const t=new Ns(r.url),n=await r.processFunc(e,this,t);return new js(n.gasPrice,n.maxFeePerGas,n.maxPriorityFeePerGas)}return await e()}async estimateGas(t){let e=this._getTransactionRequest(t);return Gl(e)&&(e=await e),ge(await this.#Jt({method:"estimateGas",transaction:e}),"%response")}async#qt(t,e,r){Jt(r<10,"CCIP read exceeded maximum redirections","OFFCHAIN_FAULT",{reason:"TOO_MANY_REDIRECTS",transaction:Object.assign({},t,{blockTag:e,enableCcipRead:!0})});const n=zs(t);try{return ne(await this._perform({method:"call",transaction:n,blockTag:e}))}catch(t){if(!this.disableCcipRead&&Vt(t)&&t.data&&r>=0&&"latest"===e&&null!=n.to&&"0x556f1830"===oe(t.data,0,4)){const s=t.data,i=await Xn(n.to,this);let o;try{o=function(t){const e={sender:"",urls:[],calldata:"",selector:"",extraData:"",errorArgs:[]};Jt(ie(t)>=160,"insufficient OffchainLookup data","OFFCHAIN_FAULT",{reason:"insufficient OffchainLookup data"});const r=oe(t,0,32);Jt(oe(r,0,12)===oe(Xl,0,12),"corrupt OffchainLookup sender","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup sender"}),e.sender=oe(r,12);try{const r=[],n=be(oe(t,32,64)),s=be(oe(t,n,n+32)),i=oe(t,n+32);for(let t=0;t<s;t++){const e=_l(i,32*t);if(null==e)throw new Error("abort");r.push(e)}e.urls=r}catch(t){Jt(!1,"corrupt OffchainLookup urls","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup urls"})}try{const r=ql(t,64);if(null==r)throw new Error("abort");e.calldata=r}catch(t){Jt(!1,"corrupt OffchainLookup calldata","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup calldata"})}Jt(oe(t,100,128)===oe(Xl,0,28),"corrupt OffchainLookup callbaackSelector","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup callbaackSelector"}),e.selector=oe(t,96,100);try{const r=ql(t,128);if(null==r)throw new Error("abort");e.extraData=r}catch(t){Jt(!1,"corrupt OffchainLookup extraData","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup extraData"})}return e.errorArgs="sender,urls,calldata,selector,extraData".split(/,/).map((t=>e[t])),e}(oe(t.data,4))}catch(t){Jt(!1,t.message,"OFFCHAIN_FAULT",{reason:"BAD_DATA",transaction:n,info:{data:s}})}Jt(o.sender.toLowerCase()===i.toLowerCase(),"CCIP Read sender mismatch","CALL_EXCEPTION",{action:"call",data:s,reason:"OffchainLookup",transaction:n,invocation:null,revert:{signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",name:"OffchainLookup",args:o.errorArgs}});const a=await this.ccipReadFetch(n,o.calldata,o.urls);Jt(null!=a,"CCIP Read failed to fetch data","OFFCHAIN_FAULT",{reason:"FETCH_FAILED",transaction:n,info:{data:t.data,errorArgs:o.errorArgs}});const c={to:i,data:se([o.selector,Yl([a,o.extraData])])};this.emit("debug",{action:"sendCcipReadCall",transaction:c});try{const t=await this.#qt(c,e,r+1);return this.emit("debug",{action:"receiveCcipReadCallResult",transaction:Object.assign({},c),result:t}),t}catch(t){throw this.emit("debug",{action:"receiveCcipReadCallError",transaction:Object.assign({},c),error:t}),t}}throw t}}async#Wt(t){const{value:e}=await Ht({network:this.getNetwork(),value:t});return e}async call(t){const{tx:e,blockTag:r}=await Ht({tx:this._getTransactionRequest(t),blockTag:this._getBlockTag(t.blockTag)});return await this.#Wt(this.#qt(e,r,t.enableCcipRead?0:-1))}async#Zt(t,e,r){let n=this._getAddress(e),s=this._getBlockTag(r);return"string"==typeof n&&"string"==typeof s||([n,s]=await Promise.all([n,s])),await this.#Wt(this.#Jt(Object.assign(t,{address:n,blockTag:s})))}async getBalance(t,e){return ge(await this.#Zt({method:"getBalance"},t,e),"%response")}async getTransactionCount(t,e){return be(await this.#Zt({method:"getTransactionCount"},t,e),"%response")}async getCode(t,e){return ne(await this.#Zt({method:"getCode"},t,e))}async getStorage(t,e,r){const n=ge(e,"position");return ne(await this.#Zt({method:"getStorage",position:n},t,r))}async broadcastTransaction(t){const{blockNumber:e,hash:r,network:n}=await Ht({blockNumber:this.getBlockNumber(),hash:this._perform({method:"broadcastTransaction",signedTransaction:t}),network:this.getNetwork()}),s=nl.from(t);if(s.hash!==r)throw new Error("@TODO: the returned hash did not match");return this._wrapTransactionResponse(s,n).replaceableTransaction(e)}async#_t(t,e){if(te(t,32))return await this.#Jt({method:"getBlock",blockHash:t,includeTransactions:e});let r=this._getBlockTag(t);return"string"!=typeof r&&(r=await r),await this.#Jt({method:"getBlock",blockTag:r,includeTransactions:e})}async getBlock(t,e){const{network:r,params:n}=await Ht({network:this.getNetwork(),params:this.#_t(t,!!e)});return null==n?null:this._wrapBlock(n,r)}async getTransaction(t){const{network:e,params:r}=await Ht({network:this.getNetwork(),params:this.#Jt({method:"getTransaction",hash:t})});return null==r?null:this._wrapTransactionResponse(r,e)}async getTransactionReceipt(t){const{network:e,params:r}=await Ht({network:this.getNetwork(),params:this.#Jt({method:"getTransactionReceipt",hash:t})});if(null==r)return null;if(null==r.gasPrice&&null==r.effectiveGasPrice){const e=await this.#Jt({method:"getTransaction",hash:t});if(null==e)throw new Error("report this; could not find tx or effectiveGasPrice");r.effectiveGasPrice=e.gasPrice}return this._wrapTransactionReceipt(r,e)}async getTransactionResult(t){const{result:e}=await Ht({network:this.getNetwork(),result:this.#Jt({method:"getTransactionResult",hash:t})});return null==e?null:ne(e)}async getLogs(t){let e=this._getFilter(t);Gl(e)&&(e=await e);const{network:r,params:n}=await Ht({network:this.getNetwork(),params:this.#Jt({method:"getLogs",filter:e})});return n.map((t=>this._wrapLog(t,r)))}_getProvider(t){Jt(!1,"provider cannot connect to target network","UNSUPPORTED_OPERATION",{operation:"_getProvider()"})}async getResolver(t){return await ul.fromName(this,t)}async getAvatar(t){const e=await this.getResolver(t);return e?await e.getAvatar():null}async resolveName(t){const e=await this.getResolver(t);return e?await e.getAddress():null}async lookupAddress(t){const e=Ro((t=Br(t)).substring(2).toLowerCase()+".addr.reverse");try{const r=await ul.getEnsAddress(this),n=new xi(r,["function resolver(bytes32) view returns (address)"],this),s=await n.resolver(e);if(null==s||s===Os)return null;const i=new xi(s,["function name(bytes32) view returns (string)"],this),o=await i.name(e);return await this.resolveName(o)!==t?null:o}catch(t){if(zt(t,"BAD_DATA")&&"0x"===t.value)return null;if(zt(t,"CALL_EXCEPTION"))return null;throw t}return null}async waitForTransaction(t,e,r){const n=null!=e?e:1;return 0===n?this.getTransactionReceipt(t):new Promise((async(e,s)=>{let i=null;const o=async r=>{try{const s=await this.getTransactionReceipt(t);if(null!=s&&r-s.blockNumber+1>=n)return e(s),void(i&&(clearTimeout(i),i=null))}catch(t){console.log("EEE",t)}this.once("block",o)};null!=r&&(i=setTimeout((()=>{null!=i&&(i=null,this.off("block",o),s(Kt("timeout","TIMEOUT",{reason:"timeout"})))}),r)),o(await this.getBlockNumber())}))}async waitForBlock(t){Jt(!1,"not implemented yet","NOT_IMPLEMENTED",{operation:"waitForBlock"})}_clearTimeout(t){const e=this.#Vt.get(t);e&&(e.timer&&clearTimeout(e.timer),this.#Vt.delete(t))}_setTimeout(t,e){null==e&&(e=0);const r=this.#zt++,n=()=>{this.#Vt.delete(r),t()};if(this.paused)this.#Vt.set(r,{timer:null,func:n,time:e});else{const t=setTimeout(n,e);this.#Vt.set(r,{timer:t,func:n,time:Vl()})}return r}_forEachSubscriber(t){for(const e of this.#Dt.values())t(e.subscriber)}_getSubscriber(t){switch(t.type){case"debug":case"error":case"network":return new Ql(t.type);case"block":{const t=new Sl(this);return t.pollingInterval=this.pollingInterval,t}case"safe":case"finalized":return new Ul(this,t.type);case"event":return new Ll(this,t.filter);case"transaction":return new Dl(this,t.hash);case"orphan":return new Fl(this,t.filter)}throw new Error(`unsupported event: ${t.type}`)}_recoverSubscriber(t,e){for(const r of this.#Dt.values())if(r.subscriber===t){r.started&&r.subscriber.stop(),r.subscriber=e,r.started&&e.start(),null!=this.#Lt&&e.pause(this.#Lt);break}}async#$t(t,e){let r=await zl(t,this);return"event"===r.type&&e&&e.length>0&&!0===e[0].removed&&(r=await zl({orphan:"drop-log",log:e[0]},this)),this.#Dt.get(r.tag)||null}async#Yt(t){const e=await zl(t,this),r=e.tag;let n=this.#Dt.get(r);return n||(n={subscriber:this._getSubscriber(e),tag:r,addressableMap:new WeakMap,nameMap:new Map,started:!1,listeners:[]},this.#Dt.set(r,n)),n}async on(t,e){const r=await this.#Yt(t);return r.listeners.push({listener:e,once:!1}),r.started||(r.subscriber.start(),r.started=!0,null!=this.#Lt&&r.subscriber.pause(this.#Lt)),this}async once(t,e){const r=await this.#Yt(t);return r.listeners.push({listener:e,once:!0}),r.started||(r.subscriber.start(),r.started=!0,null!=this.#Lt&&r.subscriber.pause(this.#Lt)),this}async emit(t,...e){const r=await this.#$t(t,e);if(!r||0===r.listeners.length)return!1;const n=r.listeners.length;return r.listeners=r.listeners.filter((({listener:r,once:n})=>{const s=new Zs(this,n?null:r,t);try{r.call(this,...e,s)}catch(t){}return!n})),0===r.listeners.length&&(r.started&&r.subscriber.stop(),this.#Dt.delete(r.tag)),n>0}async listenerCount(t){if(t){const e=await this.#$t(t);return e?e.listeners.length:0}let e=0;for(const{listeners:t}of this.#Dt.values())e+=t.length;return e}async listeners(t){if(t){const e=await this.#$t(t);return e?e.listeners.map((({listener:t})=>t)):[]}let e=[];for(const{listeners:t}of this.#Dt.values())e=e.concat(t.map((({listener:t})=>t)));return e}async off(t,e){const r=await this.#$t(t);if(!r)return this;if(e){const t=r.listeners.map((({listener:t})=>t)).indexOf(e);t>=0&&r.listeners.splice(t,1)}return e&&0!==r.listeners.length||(r.started&&r.subscriber.stop(),this.#Dt.delete(r.tag)),this}async removeAllListeners(t){if(t){const{tag:e,started:r,subscriber:n}=await this.#Yt(t);r&&n.stop(),this.#Dt.delete(e)}else for(const[t,{started:e,subscriber:r}]of this.#Dt)e&&r.stop(),this.#Dt.delete(t);return this}async addListener(t,e){return await this.on(t,e)}async removeListener(t,e){return this.off(t,e)}get destroyed(){return this.#Mt}destroy(){this.removeAllListeners();for(const t of this.#Vt.keys())this._clearTimeout(t);this.#Mt=!0}get paused(){return null!=this.#Lt}set paused(t){!!t!==this.paused&&(this.paused?this.resume():this.pause(!1))}pause(t){if(this.#jt=-1,null!=this.#Lt){if(this.#Lt==!!t)return;Jt(!1,"cannot change pause type; resume first","UNSUPPORTED_OPERATION",{operation:"pause"})}this._forEachSubscriber((e=>e.pause(t))),this.#Lt=!!t;for(const t of this.#Vt.values())t.timer&&clearTimeout(t.timer),t.time=Vl()-t.time}resume(){if(null!=this.#Lt){this._forEachSubscriber((t=>t.resume())),this.#Lt=null;for(const t of this.#Vt.values()){let e=t.time;e<0&&(e=0),t.time=Vl(),setTimeout(t.func,e)}}}}function _l(t,e){try{const r=ql(t,e);if(r)return Wr(r)}catch(t){}return null}function ql(t,e){if("0x"===t)return null;try{const r=be(oe(t,e,e+32)),n=be(oe(t,r,r+32));return oe(t,r+32,r+32+n)}catch(t){}return null}function Wl(t){const e=Ee(t);if(e.length>32)throw new Error("internal; should not happen");const r=new Uint8Array(32);return r.set(e,32-e.length),r}function Zl(t){if(t.length%32==0)return t;const e=new Uint8Array(32*Math.ceil(t.length/32));return e.set(t),e}const $l=new Uint8Array([]);function Yl(t){const e=[];let r=0;for(let n=0;n<t.length;n++)e.push($l),r+=32;for(let n=0;n<t.length;n++){const s=Yt(t[n]);e[n]=Wl(r),e.push(Wl(s.length)),e.push(Zl(s)),r+=32+32*Math.ceil(s.length/32)}return se(e)}const Xl="0x0000000000000000000000000000000000000000000000000000000000000000";function tu(t,e){if(t.provider)return t.provider;Jt(!1,"missing provider","UNSUPPORTED_OPERATION",{operation:e})}async function eu(t,e){let r=zs(e);if(null!=r.to&&(r.to=Xn(r.to,t)),null!=r.from){const e=r.from;r.from=Promise.all([t.getAddress(),Xn(e,t)]).then((([t,e])=>(_t(t.toLowerCase()===e.toLowerCase(),"transaction from mismatch","tx.from",e),t)))}else r.from=t.getAddress();return await Ht(r)}class ru{provider;constructor(t){Qt(this,{provider:t||null})}async getNonce(t){return tu(this,"getTransactionCount").getTransactionCount(await this.getAddress(),t)}async populateCall(t){return await eu(this,t)}async populateTransaction(t){const e=tu(this,"populateTransaction"),r=await eu(this,t);null==r.nonce&&(r.nonce=await this.getNonce("pending")),null==r.gasLimit&&(r.gasLimit=await this.estimateGas(r));const n=await this.provider.getNetwork();null!=r.chainId?_t(ge(r.chainId)===n.chainId,"transaction chainId mismatch","tx.chainId",t.chainId):r.chainId=n.chainId;const s=null!=r.maxFeePerGas||null!=r.maxPriorityFeePerGas;if(null==r.gasPrice||2!==r.type&&!s?0!==r.type&&1!==r.type||!s||_t(!1,"pre-eip-1559 transaction do not support maxFeePerGas/maxPriorityFeePerGas","tx",t):_t(!1,"eip-1559 transaction do not support gasPrice","tx",t),2!==r.type&&null!=r.type||null==r.maxFeePerGas||null==r.maxPriorityFeePerGas)if(0===r.type||1===r.type){const t=await e.getFeeData();Jt(null!=t.gasPrice,"network does not support gasPrice","UNSUPPORTED_OPERATION",{operation:"getGasPrice"}),null==r.gasPrice&&(r.gasPrice=t.gasPrice)}else{const t=await e.getFeeData();if(null==r.type)if(null!=t.maxFeePerGas&&null!=t.maxPriorityFeePerGas)if(r.type=2,null!=r.gasPrice){const t=r.gasPrice;delete r.gasPrice,r.maxFeePerGas=t,r.maxPriorityFeePerGas=t}else null==r.maxFeePerGas&&(r.maxFeePerGas=t.maxFeePerGas),null==r.maxPriorityFeePerGas&&(r.maxPriorityFeePerGas=t.maxPriorityFeePerGas);else null!=t.gasPrice?(Jt(!s,"network does not support EIP-1559","UNSUPPORTED_OPERATION",{operation:"populateTransaction"}),null==r.gasPrice&&(r.gasPrice=t.gasPrice),r.type=0):Jt(!1,"failed to get consistent fee data","UNSUPPORTED_OPERATION",{operation:"signer.getFeeData"});else 2!==r.type&&3!==r.type||(null==r.maxFeePerGas&&(r.maxFeePerGas=t.maxFeePerGas),null==r.maxPriorityFeePerGas&&(r.maxPriorityFeePerGas=t.maxPriorityFeePerGas))}else r.type=2;return await Ht(r)}async estimateGas(t){return tu(this,"estimateGas").estimateGas(await this.populateCall(t))}async call(t){return tu(this,"call").call(await this.populateCall(t))}async resolveName(t){const e=tu(this,"resolveName");return await e.resolveName(t)}async sendTransaction(t){const e=tu(this,"sendTransaction"),r=await this.populateTransaction(t);delete r.from;const n=nl.from(r);return await e.broadcastTransaction(await this.signTransaction(n))}}class nu{#Pt;#Xt;#Nt;#St;#te;#ee;constructor(t){this.#Pt=t,this.#Xt=null,this.#Nt=this.#Ot.bind(this),this.#St=!1,this.#te=null,this.#ee=!1}_subscribe(t){throw new Error("subclasses must override this")}_emitResults(t,e){throw new Error("subclasses must override this")}_recover(t){throw new Error("subclasses must override this")}async#Ot(t){try{null==this.#Xt&&(this.#Xt=this._subscribe(this.#Pt));let t=null;try{t=await this.#Xt}catch(t){if(!zt(t,"UNSUPPORTED_OPERATION")||"eth_newFilter"!==t.operation)throw t}if(null==t)return this.#Xt=null,void this.#Pt._recoverSubscriber(this,this._recover(this.#Pt));const e=await this.#Pt.getNetwork();if(this.#te||(this.#te=e),this.#te.chainId!==e.chainId)throw new Error("chaid changed");if(this.#ee)return;const r=await this.#Pt.send("eth_getFilterChanges",[t]);await this._emitResults(this.#Pt,r)}catch(t){console.log("@TODO",t)}this.#Pt.once("block",this.#Nt)}#re(){const t=this.#Xt;t&&(this.#Xt=null,t.then((t=>{this.#Pt.destroyed||this.#Pt.send("eth_uninstallFilter",[t])})))}start(){this.#St||(this.#St=!0,this.#Ot(-2))}stop(){this.#St&&(this.#St=!1,this.#ee=!0,this.#re(),this.#Pt.off("block",this.#Nt))}pause(t){t&&this.#re(),this.#Pt.off("block",this.#Nt)}resume(){this.start()}}class su extends nu{#ne;constructor(t,e){var r;super(t),this.#ne=(r=e,JSON.parse(JSON.stringify(r)))}_recover(t){return new Ll(t,this.#ne)}async _subscribe(t){return await t.send("eth_newFilter",[this.#ne])}async _emitResults(t,e){for(const r of e)t.emit(this.#ne,t._wrapLog(r,t._network))}}class iu extends nu{async _subscribe(t){return await t.send("eth_newPendingTransactionFilter",[])}async _emitResults(t,e){for(const r of e)t.emit("pending",r)}}const ou="bigint,boolean,function,number,string,symbol".split(/,/g);function au(t){if(null==t||ou.indexOf(typeof t)>=0)return t;if("function"==typeof t.getAddress)return t;if(Array.isArray(t))return t.map(au);if("object"==typeof t)return Object.keys(t).reduce(((e,r)=>(e[r]=t[r],e)),{});throw new Error(`should not happen: ${t} (${typeof t})`)}function cu(t){return new Promise((e=>{setTimeout(e,t)}))}function lu(t){return t?t.toLowerCase():t}function uu(t){return t&&"number"==typeof t.pollingInterval}const hu={polling:!1,staticNetwork:null,batchStallTime:10,batchMaxSize:1<<20,batchMaxCount:100,cacheTimeout:250,pollingInterval:4e3};class fu extends ru{address;constructor(t,e){super(t),Qt(this,{address:e=Br(e)})}connect(t){Jt(!1,"cannot reconnect JsonRpcSigner","UNSUPPORTED_OPERATION",{operation:"signer.connect"})}async getAddress(){return this.address}async populateTransaction(t){return await this.populateCall(t)}async sendUncheckedTransaction(t){const e=au(t),r=[];if(e.from){const n=e.from;r.push((async()=>{const r=await Xn(n,this.provider);_t(null!=r&&r.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",t),e.from=r})())}else e.from=this.address;if(null==e.gasLimit&&r.push((async()=>{e.gasLimit=await this.provider.estimateGas({...e,from:this.address})})()),null!=e.to){const t=e.to;r.push((async()=>{e.to=await Xn(t,this.provider)})())}r.length&&await Promise.all(r);const n=this.provider.getRpcTransaction(e);return this.provider.send("eth_sendTransaction",[n])}async sendTransaction(t){const e=await this.provider.getBlockNumber(),r=await this.sendUncheckedTransaction(t);return await new Promise(((t,n)=>{const s=[1e3,100];let i=0;const o=async()=>{try{const n=await this.provider.getTransaction(r);if(null!=n)return void t(n.replaceableTransaction(e))}catch(t){if(zt(t,"CANCELLED")||zt(t,"BAD_DATA")||zt(t,"NETWORK_ERROR")||zt(t,"UNSUPPORTED_OPERATION"))return null==t.info&&(t.info={}),t.info.sendTransactionHash=r,void n(t);if(zt(t,"INVALID_ARGUMENT")&&(i++,null==t.info&&(t.info={}),t.info.sendTransactionHash=r,i>10))return void n(t);this.provider.emit("error",Kt("failed to fetch transation after sending (will try again)","UNKNOWN_ERROR",{error:t}))}this.provider._setTimeout((()=>{o()}),s.pop()||4e3)};o()}))}async signTransaction(t){const e=au(t);if(e.from){const r=await Xn(e.from,this.provider);_t(null!=r&&r.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",t),e.from=r}else e.from=this.address;const r=this.provider.getRpcTransaction(e);return await this.provider.send("eth_signTransaction",[r])}async signMessage(t){const e="string"==typeof t?qr(t):t;return await this.provider.send("personal_sign",[ne(e),this.address.toLowerCase()])}async signTypedData(t,e,r){const n=au(r),s=await ps.resolveNames(t,e,n,(async t=>{const e=await Xn(t);return _t(null!=e,"TypedData does not support null address","value",t),e}));return await this.provider.send("eth_signTypedData_v4",[this.address.toLowerCase(),JSON.stringify(ps.getPayload(s.domain,e,s.value))])}async unlock(t){return this.provider.send("personal_unlockAccount",[this.address.toLowerCase(),t,null])}async _legacySignMessage(t){const e="string"==typeof t?qr(t):t;return await this.provider.send("eth_sign",[this.address.toLowerCase(),ne(e)])}}class du extends Jl{#u;#se;#ie;#oe;#ae;#te;#ce;#le(){if(this.#oe)return;const t=1===this._getOption("batchMaxCount")?0:this._getOption("batchStallTime");this.#oe=setTimeout((()=>{this.#oe=null;const t=this.#ie;for(this.#ie=[];t.length;){const e=[t.shift()];for(;t.length&&e.length!==this.#u.batchMaxCount;)if(e.push(t.shift()),JSON.stringify(e.map((t=>t.payload))).length>this.#u.batchMaxSize){t.unshift(e.pop());break}(async()=>{const t=1===e.length?e[0].payload:e.map((t=>t.payload));this.emit("debug",{action:"sendRpcPayload",payload:t});try{const r=await this._send(t);this.emit("debug",{action:"receiveRpcResult",result:r});for(const{resolve:t,reject:n,payload:s}of e){if(this.destroyed){n(Kt("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:s.method}));continue}const e=r.filter((t=>t.id===s.id))[0];if(null!=e)"error"in e?n(this.getRpcError(s,e)):t(e.result);else{const t=Kt("missing response for request","BAD_DATA",{value:r,info:{payload:s}});this.emit("error",t),n(t)}}}catch(t){this.emit("debug",{action:"receiveRpcError",error:t});for(const{reject:r}of e)r(t)}})()}}),t)}constructor(t,e){super(t,e),this.#se=1,this.#u=Object.assign({},hu,e||{}),this.#ie=[],this.#oe=null,this.#te=null,this.#ce=null;{let t=null;const e=new Promise((e=>{t=e}));this.#ae={promise:e,resolve:t}}const r=this._getOption("staticNetwork");"boolean"==typeof r?(_t(!r||"any"!==t,"staticNetwork cannot be used on special network 'any'","options",e),r&&null!=t&&(this.#te=Pl.from(t))):r&&(_t(null==t||r.matches(t),"staticNetwork MUST match network object","options",e),this.#te=r)}_getOption(t){return this.#u[t]}get _network(){return Jt(this.#te,"network is not available yet","NETWORK_ERROR"),this.#te}async _perform(t){if("call"===t.method||"estimateGas"===t.method){let e=t.transaction;if(e&&null!=e.type&&ge(e.type)&&null==e.maxFeePerGas&&null==e.maxPriorityFeePerGas){const r=await this.getFeeData();null==r.maxFeePerGas&&null==r.maxPriorityFeePerGas&&(t=Object.assign({},t,{transaction:Object.assign({},e,{type:void 0})}))}}const e=this.getRpcRequest(t);return null!=e?await this.send(e.method,e.args):super._perform(t)}async _detectNetwork(){const t=this._getOption("staticNetwork");if(t){if(!0!==t)return t;if(this.#te)return this.#te}return this.#ce?await this.#ce:this.ready?(this.#ce=(async()=>{try{const t=Pl.from(ge(await this.send("eth_chainId",[])));return this.#ce=null,t}catch(t){throw this.#ce=null,t}})(),await this.#ce):(this.#ce=(async()=>{const t={id:this.#se++,method:"eth_chainId",params:[],jsonrpc:"2.0"};let e;this.emit("debug",{action:"sendRpcPayload",payload:t});try{e=(await this._send(t))[0],this.#ce=null}catch(t){throw this.#ce=null,this.emit("debug",{action:"receiveRpcError",error:t}),t}if(this.emit("debug",{action:"receiveRpcResult",result:e}),"result"in e)return Pl.from(ge(e.result));throw this.getRpcError(t,e)})(),await this.#ce)}_start(){null!=this.#ae&&null!=this.#ae.resolve&&(this.#ae.resolve(),this.#ae=null,(async()=>{for(;null==this.#te&&!this.destroyed;)try{this.#te=await this._detectNetwork()}catch(t){if(this.destroyed)break;console.log("JsonRpcProvider failed to detect network and cannot start up; retry in 1s (perhaps the URL is wrong or the node is not started)"),this.emit("error",Kt("failed to bootstrap network detection","NETWORK_ERROR",{event:"initial-network-discovery",info:{error:t}})),await cu(1e3)}this.#le()})())}async _waitUntilReady(){if(null!=this.#ae)return await this.#ae.promise}_getSubscriber(t){return"pending"===t.type?new iu(this):"event"===t.type?this._getOption("polling")?new Ll(this,t.filter):new su(this,t.filter):"orphan"===t.type&&"drop-log"===t.filter.orphan?new Ql("orphan"):super._getSubscriber(t)}get ready(){return null==this.#ae}getRpcTransaction(t){const e={};return["chainId","gasLimit","gasPrice","type","maxFeePerGas","maxPriorityFeePerGas","nonce","value"].forEach((r=>{if(null==t[r])return;let n=r;"gasLimit"===r&&(n="gas"),e[n]=ve(ge(t[r],`tx.${r}`))})),["from","to","data"].forEach((r=>{null!=t[r]&&(e[r]=ne(t[r]))})),t.accessList&&(e.accessList=ys(t.accessList)),t.blobVersionedHashes&&(e.blobVersionedHashes=t.blobVersionedHashes.map((t=>t.toLowerCase()))),e}getRpcRequest(t){switch(t.method){case"chainId":return{method:"eth_chainId",args:[]};case"getBlockNumber":return{method:"eth_blockNumber",args:[]};case"getGasPrice":return{method:"eth_gasPrice",args:[]};case"getPriorityFee":return{method:"eth_maxPriorityFeePerGas",args:[]};case"getBalance":return{method:"eth_getBalance",args:[lu(t.address),t.blockTag]};case"getTransactionCount":return{method:"eth_getTransactionCount",args:[lu(t.address),t.blockTag]};case"getCode":return{method:"eth_getCode",args:[lu(t.address),t.blockTag]};case"getStorage":return{method:"eth_getStorageAt",args:[lu(t.address),"0x"+t.position.toString(16),t.blockTag]};case"broadcastTransaction":return{method:"eth_sendRawTransaction",args:[t.signedTransaction]};case"getBlock":if("blockTag"in t)return{method:"eth_getBlockByNumber",args:[t.blockTag,!!t.includeTransactions]};if("blockHash"in t)return{method:"eth_getBlockByHash",args:[t.blockHash,!!t.includeTransactions]};break;case"getTransaction":return{method:"eth_getTransactionByHash",args:[t.hash]};case"getTransactionReceipt":return{method:"eth_getTransactionReceipt",args:[t.hash]};case"call":return{method:"eth_call",args:[this.getRpcTransaction(t.transaction),t.blockTag]};case"estimateGas":return{method:"eth_estimateGas",args:[this.getRpcTransaction(t.transaction)]};case"getLogs":return t.filter&&null!=t.filter.address&&(Array.isArray(t.filter.address)?t.filter.address=t.filter.address.map(lu):t.filter.address=lu(t.filter.address)),{method:"eth_getLogs",args:[t.filter]}}return null}getRpcError(t,e){const{method:r}=t,{error:n}=e;if("eth_estimateGas"===r&&n.message){const e=n.message;if(!e.match(/revert/i)&&e.match(/insufficient funds/i))return Kt("insufficient funds","INSUFFICIENT_FUNDS",{transaction:t.params[0],info:{payload:t,error:n}})}if("eth_call"===r||"eth_estimateGas"===r){const e=gu(n),s=Zn.getBuiltinCallException("eth_call"===r?"call":"estimateGas",t.params[0],e?e.data:null);return s.info={error:n,payload:t},s}const s=JSON.stringify(function(t){const e=[];return yu(t,e),e}(n));if("string"==typeof n.message&&n.message.match(/user denied|ethers-user-denied/i))return Kt("user rejected action","ACTION_REJECTED",{action:{eth_sign:"signMessage",personal_sign:"signMessage",eth_signTypedData_v4:"signTypedData",eth_signTransaction:"signTransaction",eth_sendTransaction:"sendTransaction",eth_requestAccounts:"requestAccess",wallet_requestAccounts:"requestAccess"}[r]||"unknown",reason:"rejected",info:{payload:t,error:n}});if("eth_sendRawTransaction"===r||"eth_sendTransaction"===r){const e=t.params[0];if(s.match(/insufficient funds|base fee exceeds gas limit/i))return Kt("insufficient funds for intrinsic transaction cost","INSUFFICIENT_FUNDS",{transaction:e,info:{error:n}});if(s.match(/nonce/i)&&s.match(/too low/i))return Kt("nonce has already been used","NONCE_EXPIRED",{transaction:e,info:{error:n}});if(s.match(/replacement transaction/i)&&s.match(/underpriced/i))return Kt("replacement fee too low","REPLACEMENT_UNDERPRICED",{transaction:e,info:{error:n}});if(s.match(/only replay-protected/i))return Kt("legacy pre-eip-155 transactions not supported","UNSUPPORTED_OPERATION",{operation:r,info:{transaction:e,info:{error:n}}})}let i=!!s.match(/the method .* does not exist/i);return i||n&&n.details&&n.details.startsWith("Unauthorized method:")&&(i=!0),i?Kt("unsupported operation","UNSUPPORTED_OPERATION",{operation:t.method,info:{error:n,payload:t}}):Kt("could not coalesce error","UNKNOWN_ERROR",{error:n,payload:t})}send(t,e){if(this.destroyed)return Promise.reject(Kt("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:t}));const r=this.#se++,n=new Promise(((n,s)=>{this.#ie.push({resolve:n,reject:s,payload:{method:t,params:e,id:r,jsonrpc:"2.0"}})}));return this.#le(),n}async getSigner(t){null==t&&(t=0);const e=this.send("eth_accounts",[]);if("number"==typeof t){const r=await e;if(t>=r.length)throw new Error("no such account");return new fu(this,r[t])}const{accounts:r}=await Ht({network:this.getNetwork(),accounts:e});t=Br(t);for(const e of r)if(Br(e)===t)return new fu(this,t);throw new Error("invalid account")}async listAccounts(){return(await this.send("eth_accounts",[])).map((t=>new fu(this,t)))}destroy(){this.#oe&&(clearTimeout(this.#oe),this.#oe=null);for(const{payload:t,reject:e}of this.#ie)e(Kt("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:t.method}));this.#ie=[],super.destroy()}}class pu extends du{#ue;constructor(t,e){super(t,e);let r=this._getOption("pollingInterval");null==r&&(r=hu.pollingInterval),this.#ue=r}_getSubscriber(t){const e=super._getSubscriber(t);return uu(e)&&(e.pollingInterval=this.#ue),e}get pollingInterval(){return this.#ue}set pollingInterval(t){if(!Number.isInteger(t)||t<0)throw new Error("invalid interval");this.#ue=t,this._forEachSubscriber((t=>{uu(t)&&(t.pollingInterval=this.#ue)}))}}function gu(t){if(null==t)return null;if("string"==typeof t.message&&t.message.match(/revert/i)&&te(t.data))return{message:t.message,data:t.data};if("object"==typeof t){for(const e in t){const r=gu(t[e]);if(r)return r}return null}if("string"==typeof t)try{return gu(JSON.parse(t))}catch(t){}return null}function yu(t,e){if(null!=t){if("string"==typeof t.message&&e.push(t.message),"object"==typeof t)for(const r in t)yu(t[r],e);if("string"==typeof t)try{return yu(JSON.parse(t),e)}catch(t){}}}class mu extends pu{#G;constructor(t,e,r){const n=Object.assign({},null!=r?r:{},{batchMaxCount:1});_t(t&&t.request,"invalid EIP-1193 provider","ethereum",t),super(e,n),this.#G=async(e,r)=>{const n={method:e,params:r};this.emit("debug",{action:"sendEip1193Request",payload:n});try{const e=await t.request(n);return this.emit("debug",{action:"receiveEip1193Result",result:e}),e}catch(t){const e=new Error(t.message);throw e.code=t.code,e.data=t.data,e.payload=n,this.emit("debug",{action:"receiveEip1193Error",error:e}),e}}}async send(t,e){return await this._start(),await super.send(t,e)}async _send(t){_t(!Array.isArray(t),"EIP-1193 does not support batch request","payload",t);try{const e=await this.#G(t.method,t.params||[]);return[{id:t.id,result:e}]}catch(e){return[{id:t.id,error:{code:e.code,data:e.data,message:e.message}}]}}getRpcError(t,e){switch((e=JSON.parse(JSON.stringify(e))).error.code||-1){case 4001:e.error.message=`ethers-user-denied: ${e.error.message}`;break;case 4200:e.error.message=`ethers-unsupported: ${e.error.message}`}return super.getRpcError(t,e)}async hasSigner(t){null==t&&(t=0);const e=await this.send("eth_accounts",[]);return"number"==typeof t?e.length>t:(t=t.toLowerCase(),0!==e.filter((e=>e.toLowerCase()===t)).length)}async getSigner(t){if(null==t&&(t=0),!await this.hasSigner(t))try{await this.#G("eth_requestAccounts",[])}catch(t){const e=t.payload;throw this.getRpcError(e,{id:e.id,error:t})}return await super.getSigner(t)}}const wu=BigInt(-1),bu=BigInt(0),Au=BigInt(1),Eu=BigInt(5),vu={};let ku="0000";for(;ku.length<80;)ku+=ku;function xu(t){let e=ku;for(;e.length<t;)e+=e;return BigInt("1"+e.substring(0,t))}function Bu(t,e,r){const n=BigInt(e.width);if(e.signed){const e=Au<<n-Au;Jt(null==r||t>=-e&&t<e,"overflow","NUMERIC_FAULT",{operation:r,fault:"overflow",value:t}),t=t>bu?fe(pe(t,n),n):-fe(pe(-t,n),n)}else{const e=Au<<n;Jt(null==r||t>=0&&t<e,"overflow","NUMERIC_FAULT",{operation:r,fault:"overflow",value:t}),t=(t%e+e)%e&e-Au}return t}function Iu(t){"number"==typeof t&&(t=`fixed128x${t}`);let e=!0,r=128,n=18;if("string"==typeof t)if("fixed"===t);else if("ufixed"===t)e=!1;else{const s=t.match(/^(u?)fixed([0-9]+)x([0-9]+)$/);_t(s,"invalid fixed format","format",t),e="u"!==s[1],r=parseInt(s[2]),n=parseInt(s[3])}else if(t){const s=t,i=(t,e,r)=>null==s[t]?r:(_t(typeof s[t]===e,"invalid fixed format ("+t+" not "+e+")","format."+t,s[t]),s[t]);e=i("signed","boolean",e),r=i("width","number",r),n=i("decimals","number",n)}return _t(r%8==0,"invalid FixedNumber width (not byte aligned)","format.width",r),_t(n<=80,"invalid FixedNumber decimals (too large)","format.decimals",n),{signed:e,width:r,decimals:n,name:(e?"":"u")+"fixed"+String(r)+"x"+String(n)}}class Pu{format;#he;#fe;#de;_value;constructor(t,e,r){Zt(t,vu,"FixedNumber"),this.#fe=e,this.#he=r;const n=function(t,e){let r="";t<bu&&(r="-",t*=wu);let n=t.toString();if(0===e)return r+n;for(;n.length<=e;)n=ku+n;const s=n.length-e;for(n=n.substring(0,s)+"."+n.substring(s);"0"===n[0]&&"."!==n[1];)n=n.substring(1);for(;"0"===n[n.length-1]&&"."!==n[n.length-2];)n=n.substring(0,n.length-1);return r+n}(e,r.decimals);Qt(this,{format:r.name,_value:n}),this.#de=xu(r.decimals)}get signed(){return this.#he.signed}get width(){return this.#he.width}get decimals(){return this.#he.decimals}get value(){return this.#fe}#pe(t){_t(this.format===t.format,"incompatible format; use fixedNumber.toFormat","other",t)}#ge(t,e){return t=Bu(t,this.#he,e),new Pu(vu,t,this.#he)}#ye(t,e){return this.#pe(t),this.#ge(this.#fe+t.#fe,e)}addUnsafe(t){return this.#ye(t)}add(t){return this.#ye(t,"add")}#me(t,e){return this.#pe(t),this.#ge(this.#fe-t.#fe,e)}subUnsafe(t){return this.#me(t)}sub(t){return this.#me(t,"sub")}#we(t,e){return this.#pe(t),this.#ge(this.#fe*t.#fe/this.#de,e)}mulUnsafe(t){return this.#we(t)}mul(t){return this.#we(t,"mul")}mulSignal(t){this.#pe(t);const e=this.#fe*t.#fe;return Jt(e%this.#de===bu,"precision lost during signalling mul","NUMERIC_FAULT",{operation:"mulSignal",fault:"underflow",value:this}),this.#ge(e/this.#de,"mulSignal")}#be(t,e){return Jt(t.#fe!==bu,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),this.#pe(t),this.#ge(this.#fe*this.#de/t.#fe,e)}divUnsafe(t){return this.#be(t)}div(t){return this.#be(t,"div")}divSignal(t){Jt(t.#fe!==bu,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),this.#pe(t);const e=this.#fe*this.#de;return Jt(e%t.#fe===bu,"precision lost during signalling div","NUMERIC_FAULT",{operation:"divSignal",fault:"underflow",value:this}),this.#ge(e/t.#fe,"divSignal")}cmp(t){let e=this.value,r=t.value;const n=this.decimals-t.decimals;return n>0?r*=xu(n):n<0&&(e*=xu(-n)),e<r?-1:e>r?1:0}eq(t){return 0===this.cmp(t)}lt(t){return this.cmp(t)<0}lte(t){return this.cmp(t)<=0}gt(t){return this.cmp(t)>0}gte(t){return this.cmp(t)>=0}floor(){let t=this.#fe;return this.#fe<bu&&(t-=this.#de-Au),t=this.#fe/this.#de*this.#de,this.#ge(t,"floor")}ceiling(){let t=this.#fe;return this.#fe>bu&&(t+=this.#de-Au),t=this.#fe/this.#de*this.#de,this.#ge(t,"ceiling")}round(t){if(null==t&&(t=0),t>=this.decimals)return this;const e=this.decimals-t,r=Eu*xu(e-1);let n=this.value+r;const s=xu(e);return n=n/s*s,Bu(n,this.#he,"round"),new Pu(vu,n,this.#he)}isZero(){return this.#fe===bu}isNegative(){return this.#fe<bu}toString(){return this._value}toUnsafeFloat(){return parseFloat(this.toString())}toFormat(t){return Pu.fromString(this.toString(),t)}static fromValue(t,e,r){const n=null==e?0:be(e),s=Iu(r);let i=ge(t,"value");const o=n-s.decimals;if(o>0){const e=xu(o);Jt(i%e===bu,"value loses precision for format","NUMERIC_FAULT",{operation:"fromValue",fault:"underflow",value:t}),i/=e}else o<0&&(i*=xu(-o));return Bu(i,s,"fromValue"),new Pu(vu,i,s)}static fromString(t,e){const r=t.match(/^(-?)([0-9]*)\.?([0-9]*)$/);_t(r&&r[2].length+r[3].length>0,"invalid FixedNumber string value","value",t);const n=Iu(e);let s=r[2]||"0",i=r[3]||"";for(;i.length<n.decimals;)i+=ku;Jt(i.substring(n.decimals).match(/^0*$/),"too many decimals for format","NUMERIC_FAULT",{operation:"fromString",fault:"underflow",value:t}),i=i.substring(0,n.decimals);const o=BigInt(r[1]+s+i);return Bu(o,n,"fromString"),new Pu(vu,o,n)}static fromBytes(t,e){let r=we(Yt(t,"value"));const n=Iu(e);return n.signed&&(r=fe(r,n.width)),Bu(r,n,"fromBytes"),new Pu(vu,r,n)}}const Nu=["wei","kwei","mwei","gwei","szabo","finney","ether"];function Cu(t,e){_t("string"==typeof t,"value must be a string","value",t);let r=18;if("string"==typeof e){const t=Nu.indexOf(e);_t(t>=0,"invalid unit","unit",e),r=3*t}else null!=e&&(r=be(e,"unit"));return Pu.fromString(t,{decimals:r,width:512}).value}const Ru={defaultNetwork:"avalanche",networks:{avalanche:{chainId:43114,name:"Avalanche Mainnet C-Chain",rpcUrl:"https://api.avax.network/ext/bc/C/rpc",explorerUrl:"https://snowtrace.io"},ethereum:{chainId:1,name:"Ethereum Mainnet",rpcUrl:"https://mainnet.infura.io/v3/YOUR_INFURA_KEY",explorerUrl:"https://etherscan.io"},polygon:{chainId:137,name:"Polygon Mainnet",rpcUrl:"https://polygon-rpc.com",explorerUrl:"https://polygonscan.com"},optimism:{chainId:10,name:"Optimism",rpcUrl:"https://mainnet.optimism.io",explorerUrl:"https://optimistic.etherscan.io"},arbitrum:{chainId:42161,name:"Arbitrum One",rpcUrl:"https://arb1.arbitrum.io/rpc",explorerUrl:"https://arbiscan.io"},fuji:{chainId:43113,name:"Avalanche Fuji Testnet",rpcUrl:"https://api.avax-test.network/ext/bc/C/rpc",explorerUrl:"https://testnet.snowtrace.io"},goerli:{chainId:5,name:"Goerli Testnet",rpcUrl:"https://goerli.infura.io/v3/YOUR_INFURA_KEY",explorerUrl:"https://goerli.etherscan.io"},mumbai:{chainId:80001,name:"Mumbai Testnet",rpcUrl:"https://rpc-mumbai.maticvigil.com",explorerUrl:"https://mumbai.polygonscan.com"}}},Ou=["function registerAsset(string assetId, string contentHash, string metadataHash, string uri) returns (bool)","function transferAsset(string assetId, address to) returns (bool)","function batchRegister(string[] assetIds, string[] contentHashes, string[] metadataHashes, string[] uris) returns (bool)","function batchTransfer(string[] assetIds, address to) returns (bool)","function assetExists(string assetId) view returns (bool)","function ownerOf(string assetId) view returns (address)","function getAssetMetadata(string assetId) view returns (string contentHash, string metadataHash, string uri, address creator, uint256 timestamp, bool exists)","event AssetRegistered(string assetId, string contentHash, string metadataHash, string uri, address indexed creator, uint256 timestamp)","event AssetTransferred(string assetId, address indexed from, address indexed to, uint256 timestamp)"];class Su{constructor(t){this.eventListeners=new Map,this.provider=null,this.signer=null,this.contracts={},this.config={...Ru,...t},this.currentNetwork=this.config.defaultNetwork,this.initializeProvider()}initializeProvider(){"undefined"!=typeof window&&window.ethereum?(this.provider=new mu(window.ethereum),console.log("Ethereum provider initialized")):console.warn("No Ethereum provider found. Wallet connection will not be available.")}getConfig(){return this.config}updateConfig(t){this.config={...this.config,...t}}setContractAddress(t){this.config.networks[this.currentNetwork]&&(this.config.networks[this.currentNetwork].contractAddress=t)}async connectWallet(){if(!this.provider)throw new Error("Ethereum provider not available");try{await window.ethereum.request({method:"eth_requestAccounts"}),this.signer=await this.provider.getSigner();const e=await this.signer.getAddress(),r=(await this.provider.getNetwork()).chainId,n=await this.provider.getBalance(e);let s=this.currentNetwork;for(const[t,e]of Object.entries(this.config.networks))if(e.chainId===Number(r)){s=t,this.currentNetwork=t;break}return{address:e,network:s,chainId:Number(r),balance:(t=n,function(t){let e=18;return e=be(18,"unit"),Pu.fromValue(t,e,{decimals:e,width:512}).toString()}(t))}}catch(t){throw console.error("Failed to connect wallet:",t),new Error(`Failed to connect wallet: ${t.message}`)}var t}disconnectWallet(){this.signer=null}disconnect(){this.provider=null,this.signer=null,this.contracts={}}async getCurrentAddress(){if(!this.signer)throw new Error("Not connected to a wallet");return await this.signer.getAddress()}async mintNFT(t,e,r){return console.log(`Minting NFT for asset ${t} with URI ${r}`),`tx_${Math.random().toString(36).substring(2,15)}`}async listOnMarketplace(t,e,r){return console.log(`Listing NFT ${t} on marketplace ${e} for ${r}`),`tx_${Math.random().toString(36).substring(2,15)}`}async cancelMarketplaceListing(t){return console.log(`Cancelling listing ${t}`),`tx_${Math.random().toString(36).substring(2,15)}`}subscribeToTransferEvents(t,e){console.log(`Subscribing to transfer events for asset ${t}`),setTimeout((()=>{const r={assetId:t,from:"0x123456789abcdef",to:"0x987654321fedcba",price:"1.5 ETH",timestamp:Date.now()};e(r)}),3e4)}async recordSecureTransfer(t,e,r){return console.log(`Recording secure transfer for asset ${t} to ${e}`),`tx_${Math.random().toString(36).substring(2,15)}`}async confirmSale(t,e,r){return console.log(`Confirming sale of asset ${t} to ${e} for ${r}`),`tx_${Math.random().toString(36).substring(2,15)}`}getContract(){const t=this.config.networks[this.currentNetwork];if(!t)throw new Error(`Network ${this.currentNetwork} not found in configuration`);if(!t.contractAddress)throw new Error(`Contract address not set for network ${this.currentNetwork}`);if(!this.signer)throw new Error("Wallet not connected");if(this.contracts[this.currentNetwork])return this.contracts[this.currentNetwork];const e=new xi(t.contractAddress,Ou,this.signer);return this.contracts[this.currentNetwork]=e,e}async registerAsset(t,e,r,n){const s=this.getContract();try{const i=await s.registerAsset(t,e,r,n),o=await i.wait();if(!o)throw new Error("Transaction receipt is null");return{transactionHash:o.hash,blockNumber:Number(o.blockNumber),confirmations:Number(o.confirmations),status:Number(o.status),gasUsed:o.gasUsed.toString()}}catch(t){throw console.error("Failed to register asset:",t),new Error(`Failed to register asset: ${t.message}`)}}async batchRegisterAssets(t,e,r,n){const s=this.getContract();try{const i=await s.batchRegister(t,e,r,n),o=await i.wait();if(!o)throw new Error("Transaction receipt is null");return{transactionHash:o.hash,blockNumber:Number(o.blockNumber),confirmations:Number(o.confirmations),status:Number(o.status),gasUsed:o.gasUsed.toString()}}catch(t){throw console.error("Failed to batch register assets:",t),new Error(`Failed to batch register assets: ${t.message}`)}}async transferAsset(t,e,r){const n=this.getContract();try{const s={};r?.gasLimit&&(s.gasLimit=Cu(r.gasLimit,"wei")),r?.feeData?.maxFeePerGas&&(s.maxFeePerGas=Cu(r.feeData.maxFeePerGas,"gwei")),r?.feeData?.maxPriorityFeePerGas&&(s.maxPriorityFeePerGas=Cu(r.feeData.maxPriorityFeePerGas,"gwei")),r?.feeData?.gasPrice&&(s.gasPrice=Cu(r.feeData.gasPrice,"gwei"));const i=await n.transferAsset(t,e,s),o=await i.wait();if(!o)throw new Error("Transaction receipt is null");return{transactionHash:o.hash,blockNumber:Number(o.blockNumber),confirmations:Number(o.confirmations),status:Number(o.status),gasUsed:o.gasUsed.toString()}}catch(t){throw console.error("Failed to transfer asset:",t),new Error(`Failed to transfer asset: ${t.message}`)}}async batchTransferAssets(t,e,r){const n=this.getContract();try{const s={};r?.gasLimit&&(s.gasLimit=Cu(r.gasLimit,"wei")),r?.feeData?.maxFeePerGas&&(s.maxFeePerGas=Cu(r.feeData.maxFeePerGas,"gwei")),r?.feeData?.maxPriorityFeePerGas&&(s.maxPriorityFeePerGas=Cu(r.feeData.maxPriorityFeePerGas,"gwei")),r?.feeData?.gasPrice&&(s.gasPrice=Cu(r.feeData.gasPrice,"gwei"));const i=await n.batchTransfer(t,e,s),o=await i.wait();if(!o)throw new Error("Transaction receipt is null");return{transactionHash:o.hash,blockNumber:Number(o.blockNumber),confirmations:Number(o.confirmations),status:Number(o.status),gasUsed:o.gasUsed.toString()}}catch(t){throw console.error("Failed to batch transfer assets:",t),new Error(`Failed to batch transfer assets: ${t.message}`)}}async assetExists(t){const e=this.getContract();try{return await e.assetExists(t)}catch(t){throw console.error("Failed to check if asset exists:",t),new Error(`Failed to check if asset exists: ${t.message}`)}}async ownerOf(t){const e=this.getContract();try{return await e.ownerOf(t)}catch(t){throw console.error("Failed to get asset owner:",t),new Error(`Failed to get asset owner: ${t.message}`)}}async getAssetMetadata(t){const e=this.getContract();try{const[r,n,s,i,o,a]=await e.getAssetMetadata(t);return{contentHash:r,metadataHash:n,uri:s,creator:i,timestamp:Number(o),exists:a}}catch(t){throw console.error("Failed to get asset metadata:",t),new Error(`Failed to get asset metadata: ${t.message}`)}}async sendPayment(t,e,r){if(!this.signer)throw new Error("Wallet not connected");try{const s={to:t,value:(n=e,Cu(n,18))};r?.gasLimit&&(s.gasLimit=Cu(r.gasLimit,"wei")),r?.feeData?.maxFeePerGas&&(s.maxFeePerGas=Cu(r.feeData.maxFeePerGas,"gwei")),r?.feeData?.maxPriorityFeePerGas&&(s.maxPriorityFeePerGas=Cu(r.feeData.maxPriorityFeePerGas,"gwei")),r?.feeData?.gasPrice&&(s.gasPrice=Cu(r.feeData.gasPrice,"gwei"));const i=await this.signer.sendTransaction(s),o=await i.wait();if(!o)throw new Error("Transaction receipt is null");return{transactionHash:o.hash,blockNumber:Number(o.blockNumber),confirmations:Number(o.confirmations),status:Number(o.status),gasUsed:o.gasUsed.toString()}}catch(t){throw console.error("Failed to send payment:",t),new Error(`Failed to send payment: ${t.message}`)}var n}getTransactionUrl(t){const e=this.config.networks[this.currentNetwork];if(!e)throw new Error(`Network ${this.currentNetwork} not found in configuration`);return`${e.explorerUrl}/tx/${t}`}getAddressUrl(t){const e=this.config.networks[this.currentNetwork];if(!e)throw new Error(`Network ${this.currentNetwork} not found in configuration`);return`${e.explorerUrl}/address/${t}`}}class Tu{constructor(t){if(this.keyPair=null,this.assetsDirectory="digital-assets",this.metadataDirectory="metadata",this.assetCache=new Map,this.blockchain=null,this.wallet={isConnected:!1},this.fileSystem=t.fileSystem,t.assetsDirectoryName&&(this.assetsDirectory=t.assetsDirectoryName),t.metadataDirectoryName&&(this.metadataDirectory=t.metadataDirectoryName),t.blockchain&&(this.blockchain=t.blockchain),t.userId)this.userId=t.userId;else{const t=localStorage.getItem("digital_assets_user_id");t?this.userId=t:(this.userId=N(),localStorage.setItem("digital_assets_user_id",this.userId))}}async initialize(){await this.initializeKeyPair(),this.blockchain||this.initializeBlockchain()}initializeBlockchain(){try{this.blockchain=new Su,console.log("Blockchain integration initialized")}catch(t){console.warn("Failed to initialize blockchain integration:",t)}}async initializeKeyPair(){const t=function(t){const e=localStorage.getItem(`user_keys_${t}`);if(!e)return null;try{const t=JSON.parse(e);return{publicKey:new Uint8Array(C.hp.from(t.publicKey,"base64")),privateKey:new Uint8Array(C.hp.from(t.privateKey,"base64"))}}catch(t){return console.error("Failed to parse stored key pair:",t),null}}(this.userId);t?(this.keyPair=t,console.log("Retrieved existing key pair")):(this.keyPair=await async function(){const t=Ft.randomPrivateKey();return{publicKey:await async function(t){return(await Tt(t)).pointBytes}(t),privateKey:t}}(),function(t,e){const r={publicKey:C.hp.from(e.publicKey).toString("base64"),privateKey:C.hp.from(e.privateKey).toString("base64")};localStorage.setItem(`user_keys_${t}`,JSON.stringify(r))}(this.userId,this.keyPair),console.log("Generated new key pair"))}getUserId(){return this.userId}async createAsset(t){if(!this.fileSystem.rootDirectory)throw new Error("No root directory selected");if(!this.keyPair)throw new Error("Cryptographic keys not initialized");try{await this.fileSystem.createDirectory(this.assetsDirectory),await this.fileSystem.createDirectory(this.metadataDirectory);const e=N();let r,n;try{"function"==typeof t.content.arrayBuffer?(r=await t.content.arrayBuffer(),n=C.hp.from(Dt(r)).toString("hex")):(console.warn("Using fallback content hashing method"),r=new ArrayBuffer(0),n="fallback-hash-"+Date.now().toString(36))}catch(t){console.error("Error processing file content:",t),r=new ArrayBuffer(0),n="error-hash-"+Date.now().toString(36)}const s=Date.now(),i={id:e,title:t.title,description:t.description,createdAt:s,creator:{id:this.userId,name:t.creatorName,publicKey:C.hp.from(this.keyPair.publicKey).toString("base64")},contentHash:n,signatures:[],editions:{total:t.editions,current:1},mediaType:t.content.type,filename:t.content.name,version:"1.0.0"};let o,a,c;try{const t=(new TextEncoder).encode(`${e}:${n}:${s}`);this.keyPair.privateKey instanceof Uint8Array&&this.keyPair.privateKey.length>=32?o=await Lt(t,this.keyPair.privateKey):(console.warn("Invalid private key format, using fallback signature"),o=new Uint8Array(64).fill(1))}catch(t){console.error("Error creating signature:",t),o=new Uint8Array(64).fill(1)}this.keyPair.publicKey instanceof Uint8Array&&this.keyPair.publicKey.length>=32?a=this.keyPair.publicKey:(console.warn("Invalid public key format, using fallback key"),a=new Uint8Array(32).fill(2)),i.signatures.push({signature:o,publicKey:a,timestamp:s});try{const n=t.content.name||`asset-${Date.now()}.bin`;let s;c=`${this.assetsDirectory}/${e}-${n}`,Uint8Array,s=new Blob([r]),await this.fileSystem.writeFile(c,s),console.log("Asset content written to:",c)}catch(t){console.error("Error writing asset content:",t),c=`${this.assetsDirectory}/${e}-fallback.bin`,await this.fileSystem.writeFile(c,new Blob([]))}const l=`${this.metadataDirectory}/${e}.json`,u=JSON.stringify(i,((t,e)=>e instanceof Uint8Array?C.hp.from(e).toString("base64"):e),2),h=new Blob([(new TextEncoder).encode(u)],{type:"application/json"});return await this.fileSystem.writeFile(l,h),this.assetCache.set(e,i),i}catch(t){throw console.error("Error creating asset:",t),new Error(`Failed to create asset: ${t instanceof Error?t.message:String(t)}`)}}async getAssetContent(t){if(!await this.getAsset(t))throw new Error(`Asset ${t} not found`);const e=(await this.fileSystem.listFiles(this.assetsDirectory)).find((e=>e.startsWith(`${t}-`)));if(!e)throw new Error(`Asset file for ${t} not found`);return await this.fileSystem.readFile(`${this.assetsDirectory}/${e}`)}async getAssets(){if(!this.fileSystem.rootDirectory)throw new Error("No root directory selected");try{const t=await this.fileSystem.listFiles(this.metadataDirectory),e=[];for(const r of t){if(!r.endsWith(".json"))continue;const t=`${this.metadataDirectory}/${r}`,n=await this.fileSystem.readFile(t),s=(new TextDecoder).decode(n);try{const t=JSON.parse(s);t.signatures&&(t.signatures=t.signatures.map((t=>({...t,signature:t.signature instanceof Uint8Array?t.signature:new Uint8Array(C.hp.from(t.signature,"base64")),publicKey:t.publicKey instanceof Uint8Array?t.publicKey:new Uint8Array(C.hp.from(t.publicKey,"base64"))})))),e.push(t),this.assetCache.set(t.id,t)}catch(t){console.error(`Error parsing metadata file ${r}:`,t)}}return e}catch(t){throw console.error("Error getting assets:",t),new Error(`Failed to get assets: ${t instanceof Error?t.message:String(t)}`)}}async getAsset(t){if(this.assetCache.has(t))return this.assetCache.get(t);if(!this.fileSystem.rootDirectory)throw new Error("No root directory selected");try{const e=`${this.metadataDirectory}/${t}.json`,r=await this.fileSystem.readFile(e),n=(new TextDecoder).decode(r),s=JSON.parse(n);return s.signatures&&(s.signatures=s.signatures.map((t=>({...t,signature:t.signature instanceof Uint8Array?t.signature:new Uint8Array(C.hp.from(t.signature,"base64")),publicKey:t.publicKey instanceof Uint8Array?t.publicKey:new Uint8Array(C.hp.from(t.publicKey,"base64"))})))),this.assetCache.set(t,s),s}catch(e){throw console.error(`Error getting asset ${t}:`,e),new Error(`Failed to get asset: ${e instanceof Error?e.message:String(e)}`)}}async verifyAsset(t){try{const e=await this.getAsset(t);if(!e.signatures||0===e.signatures.length)return!1;const r=(await this.fileSystem.listFiles(this.assetsDirectory)).find((e=>e.startsWith(`${t}-`)));if(!r)return console.error(`Asset file for ${t} not found`),!1;const n=await this.fileSystem.readFile(`${this.assetsDirectory}/${r}`);if(C.hp.from(Dt(n)).toString("hex")!==e.contentHash)return console.error("Content hash mismatch"),!1;const s=e.signatures[0],i=(new TextEncoder).encode(`${t}:${e.contentHash}:${s.timestamp}`);return await Mt(i,s.signature,s.publicKey)}catch(t){return console.error("Error verifying asset:",t),!1}}async exportAsset(t){try{const e=await this.getAsset(t),r=(await this.fileSystem.listFiles(this.assetsDirectory)).find((e=>e.startsWith(`${t}-`)));if(!r)throw new Error(`Asset file for ${t} not found`);const n=await this.fileSystem.readFile(`${this.assetsDirectory}/${r}`),s={metadata:e,content:C.hp.from(n).toString("base64")},i=JSON.stringify(s,null,2);return new Blob([i],{type:"application/json"})}catch(t){throw console.error("Error exporting asset:",t),new Error(`Failed to export asset: ${t instanceof Error?t.message:String(t)}`)}}async importAsset(t){try{const e=await t.text(),r=JSON.parse(e);if(!r.metadata||!r.content)throw new Error("Invalid asset bundle format");const n=r.metadata,s=r.content;await this.fileSystem.createDirectory(this.assetsDirectory),await this.fileSystem.createDirectory(this.metadataDirectory);const i=`${this.metadataDirectory}/${n.id}.json`;if(await this.fileSystem.fileExists(i))throw new Error("Asset already exists in your collection");const o=C.hp.from(s,"base64"),a=new Blob([o],{type:n.mediaType}),c=await o.buffer.slice(0);if(C.hp.from(Dt(c)).toString("hex")!==n.contentHash)throw new Error("Content hash mismatch - asset may be corrupted");const l=`${this.assetsDirectory}/${n.id}-${n.filename}`,u=a instanceof Blob?a:new Blob([a]);await this.fileSystem.writeFile(l,u);const h=new Blob([(new TextEncoder).encode(JSON.stringify(n,null,2))],{type:"application/json"});return await this.fileSystem.writeFile(i,h),this.assetCache.set(n.id,n),n}catch(t){throw console.error("Error importing asset:",t),new Error(`Failed to import asset: ${t instanceof Error?t.message:String(t)}`)}}async connectWallet(){if(!this.blockchain)throw new Error("Blockchain integration not initialized");try{const t=await this.blockchain.connectWallet();return this.wallet={address:t.address,network:t.network,isConnected:!0},{address:t.address,network:t.network,balance:t.balance}}catch(t){throw console.error("Error connecting wallet:",t),new Error(`Failed to connect wallet: ${t instanceof Error?t.message:String(t)}`)}}disconnectWallet(){this.blockchain&&(this.blockchain.disconnectWallet(),this.wallet={isConnected:!1})}isWalletConnected(){return this.wallet.isConnected}getWalletInfo(){return this.wallet}async updateAssetMetadata(t,e){if(!this.fileSystem.rootDirectory)throw new Error("No root directory selected");try{const r=`${this.metadataDirectory}/${t}.json`,n=JSON.stringify(e,((t,e)=>e instanceof Uint8Array?C.hp.from(e).toString("base64"):e),2),s=new Blob([(new TextEncoder).encode(n)],{type:"application/json"});await this.fileSystem.writeFile(r,s),this.assetCache.set(t,e)}catch(t){throw console.error("Error updating asset metadata:",t),new Error(`Failed to update asset metadata: ${t instanceof Error?t.message:String(t)}`)}}async registerOnBlockchain(t,e){if(!this.blockchain)throw new Error("Blockchain integration not initialized");if(!this.wallet.isConnected)throw new Error("Wallet not connected");try{const r=await this.getAsset(t),n=JSON.stringify({id:r.id,title:r.title,description:r.description,creator:r.creator,contentHash:r.contentHash,editions:r.editions,createdAt:r.createdAt}),s=C.hp.from(V((new TextEncoder).encode(n))).toString("hex"),i=e?.uri||`https://verify.digital-assets.app/${r.id}`,o=await this.blockchain.registerAsset(r.id,r.contentHash,s,i),a=e?.network||this.wallet.network||"unknown";return r.blockchain={network:a,contractAddress:this.blockchain.getConfig().networks[a]?.contractAddress||"",transactionHash:o.transactionHash,registeredAt:Date.now()},r.owner?r.owner={...r.owner,address:this.wallet.address,onChain:!0}:r.owner={id:this.userId,publicKey:r.creator.publicKey,address:this.wallet.address,acquiredAt:Date.now(),onChain:!0},await this.updateAssetMetadata(t,r),r}catch(t){throw console.error("Error registering asset on blockchain:",t),new Error(`Failed to register asset on blockchain: ${t instanceof Error?t.message:String(t)}`)}}async batchRegisterOnBlockchain(t,e){if(!this.blockchain)throw new Error("Blockchain integration not initialized");if(!this.wallet.isConnected)throw new Error("Wallet not connected");try{const r=await Promise.all(t.map((t=>this.getAsset(t)))),n=[],s=[],i=[];for(const t of r){const r=JSON.stringify({id:t.id,title:t.title,description:t.description,creator:t.creator,contentHash:t.contentHash,editions:t.editions,createdAt:t.createdAt}),o=C.hp.from(V((new TextEncoder).encode(r))).toString("hex"),a=`${e?.baseUri||"https://verify.digital-assets.app"}/${t.id}`;n.push(t.contentHash),s.push(o),i.push(a)}const o=await this.blockchain.batchRegisterAssets(t,n,s,i),a=e?.network||this.wallet.network||"unknown";return await Promise.all(r.map((async(t,e)=>(t.blockchain={network:a,contractAddress:this.blockchain.getConfig().networks[a]?.contractAddress||"",transactionHash:o.transactionHash,registeredAt:Date.now()},t.owner?t.owner={...t.owner,address:this.wallet.address,onChain:!0}:t.owner={id:this.userId,publicKey:t.creator.publicKey,address:this.wallet.address,acquiredAt:Date.now(),onChain:!0},await this.updateAssetMetadata(t.id,t),t))))}catch(t){throw console.error("Error batch registering assets on blockchain:",t),new Error(`Failed to batch register assets on blockchain: ${t instanceof Error?t.message:String(t)}`)}}async transferAssetOffChain(t,e){if(!this.keyPair)throw new Error("Cryptographic keys not initialized");try{const r=await this.getAsset(t),n={assetId:r.id,previousOwner:r.owner?.id||r.creator.id,newOwner:e,timestamp:Date.now()},s=await Lt((new TextEncoder).encode(JSON.stringify(n)),this.keyPair.privateKey);return r.transferHistory||(r.transferHistory=[]),r.transferHistory.push({from:r.owner?.id||r.creator.id,to:e,timestamp:n.timestamp,signature:s}),r.owner={id:e,acquiredAt:n.timestamp},await this.updateAssetMetadata(r.id,r),await this.exportAsset(t)}catch(t){throw console.error("Error transferring asset off-chain:",t),new Error(`Failed to transfer asset off-chain: ${t instanceof Error?t.message:String(t)}`)}}async transferAssetOnChain(t,e,r){if(!this.blockchain)throw new Error("Blockchain integration not initialized");if(!this.wallet.isConnected)throw new Error("Wallet not connected");try{let n=await this.getAsset(t);n.blockchain||(n=await this.registerOnBlockchain(t));const s=await this.blockchain.transferAsset(n.id,e,r);return n.transferHistory||(n.transferHistory=[]),n.transferHistory.push({from:this.wallet.address||"",to:e,timestamp:Date.now(),transactionHash:s.transactionHash,onChain:!0}),n.owner={id:"blockchain",address:e,acquiredAt:Date.now(),onChain:!0},await this.updateAssetMetadata(t,n),n}catch(t){throw console.error("Error transferring asset on-chain:",t),new Error(`Failed to transfer asset on-chain: ${t instanceof Error?t.message:String(t)}`)}}async batchTransferAssetsOnChain(t,e,r){if(!this.blockchain)throw new Error("Blockchain integration not initialized");if(!this.wallet.isConnected)throw new Error("Wallet not connected");try{const n=await Promise.all(t.map((t=>this.getAsset(t)))),s=n.filter((t=>!t.blockchain));if(s.length>0){await this.batchRegisterOnBlockchain(s.map((t=>t.id)));for(let t=0;t<n.length;t++)n[t].blockchain||(n[t]=await this.getAsset(n[t].id))}const i=await this.blockchain.batchTransferAssets(t,e,r);return await Promise.all(n.map((async t=>(t.transferHistory||(t.transferHistory=[]),t.transferHistory.push({from:this.wallet.address||"",to:e,timestamp:Date.now(),transactionHash:i.transactionHash,onChain:!0,batchId:i.transactionHash}),t.owner={id:"blockchain",address:e,acquiredAt:Date.now(),onChain:!0},await this.updateAssetMetadata(t.id,t),t))))}catch(t){throw console.error("Error batch transferring assets on-chain:",t),new Error(`Failed to batch transfer assets on-chain: ${t instanceof Error?t.message:String(t)}`)}}async processPayment(t,e,r){if(!this.blockchain)throw new Error("Blockchain integration not initialized");if(!this.wallet.isConnected)throw new Error("Wallet not connected");try{const n=await this.blockchain.sendPayment(t,e,r),s=this.blockchain.getTransactionUrl(n.transactionHash);return{transactionHash:n.transactionHash,url:s}}catch(t){throw console.error("Error processing payment:",t),new Error(`Failed to process payment: ${t instanceof Error?t.message:String(t)}`)}}async createAiArtAsset(t){if(!this.fileSystem.rootDirectory)throw new Error("No root directory selected");if(!this.keyPair)throw new Error("Cryptographic keys not initialized");try{await this.fileSystem.createDirectory(this.assetsDirectory),await this.fileSystem.createDirectory(this.metadataDirectory);const e=N(),r=await t.content.arrayBuffer(),n=C.hp.from(Dt(r)).toString("hex"),s=Date.now(),i={id:e,title:t.title,description:t.description,createdAt:s,creator:{id:this.userId,name:t.creatorName,publicKey:C.hp.from(this.keyPair.publicKey).toString("base64")},contentHash:n,signatures:[],editions:{total:t.editions,current:1},mediaType:t.content.type,filename:t.content.name,version:"1.0.0",aiGeneration:{...t.aiGeneration,generationDate:t.aiGeneration.generationDate||s}},o=(new TextEncoder).encode(`${e}:${n}:${s}${i.aiGeneration?`:${i.aiGeneration.prompt}`:""}`),a=await Lt(o,this.keyPair.privateKey);let c;i.signatures.push({signature:a,publicKey:this.keyPair.publicKey,timestamp:s});try{const n=t.content.name||`asset-${Date.now()}.bin`;let s;c=`${this.assetsDirectory}/${e}-${n}`,Uint8Array,s=new Blob([r]),await this.fileSystem.writeFile(c,s),console.log("Asset content written to:",c)}catch(t){console.error("Error writing asset content:",t),c=`${this.assetsDirectory}/${e}-fallback.bin`,await this.fileSystem.writeFile(c,new Blob([]))}const l=`${this.metadataDirectory}/${e}.json`,u=JSON.stringify(i,((t,e)=>e instanceof Uint8Array?C.hp.from(e).toString("base64"):e),2),h=new Blob([(new TextEncoder).encode(u)],{type:"application/json"});return await this.fileSystem.writeFile(l,h),this.assetCache.set(e,i),i}catch(t){throw console.error("Error creating AI art asset:",t),new Error(`Failed to create AI art asset: ${t instanceof Error?t.message:String(t)}`)}}async batchCreateAiArtAssets(t){if(!this.fileSystem.rootDirectory)throw new Error("No root directory selected");if(!this.keyPair)throw new Error("Cryptographic keys not initialized");try{await this.fileSystem.createDirectory(this.assetsDirectory),await this.fileSystem.createDirectory(this.metadataDirectory);const e=[];for(const r of t){const t=await this.createAiArtAsset(r);e.push(t)}return e}catch(t){throw console.error("Error batch creating AI art assets:",t),new Error(`Failed to batch create AI art assets: ${t instanceof Error?t.message:String(t)}`)}}}s(366),document.addEventListener("DOMContentLoaded",(async function(){try{const t=await async function(){return new y}(),e=new Tu({fileSystem:t,assetsDirectoryName:"assets",metadataDirectoryName:"metadata"});console.log("Initializing asset manager..."),await e.initialize(),console.log("Asset manager fully initialized with cryptographic keys"),window.assetManagerInstance=e,console.log("Asset manager initialized and stored globally"),function(t){["select-dir-btn","current-dir","create-asset-section","assets-gallery","assets-container","asset-details","asset-detail-container","verify-asset-btn","export-asset-btn","blockchain-asset-btn","back-to-gallery-btn","create-asset-btn","asset-title","asset-description","asset-file","asset-editions","loading-overlay","loading-message"].forEach((t=>{const e=document.getElementById(t);e?m[t]=e:console.warn(`Element with id '${t}' not found`)})),function(t){m["select-dir-btn"].addEventListener("click",(()=>{!async function(t){try{if(E("Selecting directory..."),!("showDirectoryPicker"in window))return alert("Your browser does not support the File System Access API. Please use Chrome, Edge, or another Chromium-based browser."),void v();console.log("Prompting for directory selection...");const e=await t.fileSystem.selectDirectory();console.log("Directory selection result:",e),e?(m["current-dir"].textContent=`Selected directory: ${e.name}`,m["current-dir"].classList.remove("hidden"),b("create-asset-section"),await w(t)):console.log("No directory was selected or the selection was cancelled")}catch(t){console.error("Error selecting directory:",t),alert(`Failed to select directory: ${t instanceof Error?t.message:String(t)}`)}finally{v()}}(t)})),m["create-asset-btn"].addEventListener("click",(()=>{!async function(t){const e=m["asset-title"],r=m["asset-description"],n=m["asset-file"],s=m["asset-editions"];if(e.value.trim())if(n.files&&0!==n.files.length)try{E("Creating digital asset...");const i={title:e.value.trim(),description:r.value.trim(),content:n.files[0],editions:parseInt(s.value)||1,creatorName:"Asset Creator"};await t.createAsset(i),e.value="",r.value="",n.value="",s.value="1",await w(t),alert("Digital asset created successfully!")}catch(t){console.error("Error creating asset:",t),alert(`Failed to create asset: ${t instanceof Error?t.message:String(t)}`)}finally{v()}else alert("Please select a file for your asset");else alert("Please enter a title for your asset")}(t)})),m["back-to-gallery-btn"].addEventListener("click",(()=>{b("assets-gallery"),A("asset-details")})),m["verify-asset-btn"].addEventListener("click",(async()=>{const e=m["verify-asset-btn"].getAttribute("data-asset-id");e&&await async function(t,e){try{E("Verifying asset authenticity..."),await t.verifyAsset(e)?alert("Asset verified successfully! The content and signatures are authentic."):alert("Asset verification failed! The content may have been modified or the signatures are invalid.")}catch(t){console.error("Error verifying asset:",t),alert(`Failed to verify asset: ${t instanceof Error?t.message:String(t)}`)}finally{v()}}(t,e)})),m["export-asset-btn"].addEventListener("click",(async()=>{const e=m["export-asset-btn"].getAttribute("data-asset-id");e&&await async function(t,e){try{E("Exporting asset...");const r=await t.getAsset(e),n=await t.exportAsset(e),s=URL.createObjectURL(n),i=document.createElement("a");i.href=s,i.download=`${r.title.replace(/[^a-z0-9]/gi,"_").toLowerCase()}_${e}.fsda`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(s),alert("Asset exported successfully! You can share this file with others.")}catch(t){console.error("Error exporting asset:",t),alert(`Failed to export asset: ${t instanceof Error?t.message:String(t)}`)}finally{v()}}(t,e)})),m["blockchain-asset-btn"].addEventListener("click",(async()=>{const e=m["blockchain-asset-btn"].getAttribute("data-asset-id");e&&await async function(t,e){try{E("Registering asset on blockchain..."),setTimeout((async()=>{try{const r=await t.registerOnBlockchain(e),n=document.getElementById("blockchain-status");n&&r.blockchain&&(n.innerHTML=`Registered on ${r.blockchain.network}<br>\n            Transaction: ${r.blockchain.transactionHash.substring(0,10)}...<br>\n            Contract: ${r.blockchain.contractAddress}`),m["blockchain-asset-btn"].textContent="Already on Blockchain",m["blockchain-asset-btn"].setAttribute("disabled","disabled"),alert("Asset registered on blockchain successfully!")}catch(t){console.error("Error in blockchain registration:",t),alert(`Blockchain registration error: ${t instanceof Error?t.message:String(t)}`)}finally{v()}}),2e3)}catch(t){console.error("Error registering on blockchain:",t),alert(`Failed to register on blockchain: ${t instanceof Error?t.message:String(t)}`),v()}}(t,e)}))}(t),console.log("UI initialized")}(e),console.log("Filesystem Digital Assets application initialized successfully")}catch(t){console.error("Failed to initialize application:",t),document.getElementById("app").innerHTML=`\n      <div class="error-message">\n        <h2>Application Error</h2>\n        <p>Failed to initialize the application. Please make sure your browser supports \n        the File System Access API and WebAssembly.</p>\n        <p>Error details: ${t instanceof Error?t.message:String(t)}</p>\n      </div>\n    `}}))})()})();